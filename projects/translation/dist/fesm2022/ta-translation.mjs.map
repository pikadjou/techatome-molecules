{"version":3,"file":"ta-translation.mjs","sources":["../../src/lib/services/translation-registry.service.ts","../../src/lib/abstract/abstractTranslationModule.ts","../../src/lib/services/translation.service.ts","../../src/lib/services/dto/feature.ts","../../src/lib/services/dto/translation.ts","../../src/lib/services/queries.ts","../../src/lib/services/translation-source.config.ts","../../src/lib/services/lazy-translation.service.ts","../../src/lib/services/translation.loader.ts","../../src/lib/provider.ts","../../src/public-api.ts","../../src/ta-translation.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\";\n\nimport { Observable, Subject } from \"rxjs\";\n\nexport interface ITranslation {\n  id: string;\n  getTranslation(lang: string): Observable<object | null>;\n}\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class TaTranslationRegistryService {\n  registered: ITranslation[] = [];\n  newRegistrationSubscription$ = new Subject();\n\n  constructor() {}\n\n  public register(register: ITranslation) {\n    this.registered.push(register);\n    this.newRegistrationSubscription$.next(null);\n  }\n\n  public getTranslations(lang: string) {\n    return this.registered.map((r) => r.getTranslation(lang));\n  }\n}\n","import { inject } from \"@angular/core\";\n\nimport { BehaviorSubject } from \"rxjs\";\n\nimport {\n  ITranslation,\n  TaTranslationRegistryService,\n} from \"../services/translation-registry.service\";\n\n/**\n * @deprecated\n */\nexport abstract class TaAbstractTranslationModule implements ITranslation {\n  protected _registry = inject(TaTranslationRegistryService);\n\n  public id: string;\n  protected translation: BehaviorSubject<{ [index: string]: any }> =\n    new BehaviorSubject({});\n\n  private _lang: { [index: string]: object };\n\n  constructor(\n    id: string,\n    lang: { en: object; fr: object; nl: object; es: object }\n  ) {\n    this.id = id;\n    this._lang = lang;\n    this._registry.register(this);\n  }\n\n  getTranslation(lang: string) {\n    this._addTranslation(this._lang[lang]);\n    return this.translation;\n  }\n\n  protected _addTranslation(obj: object): void {\n    const translation: { [index: string]: any } = {};\n    if (!translation[this.id]) {\n      translation[this.id] = {};\n    }\n    translation[this.id] = obj;\n\n    this.translation.next(translation);\n  }\n}\n","import { Inject, Injectable, Optional, inject } from \"@angular/core\";\n\nimport { TranslateService } from \"@ngx-translate/core\";\nimport { debounceTime, mergeMap } from \"rxjs\";\nimport { SessionStorage } from \"storage-manager-js\";\n\nimport { TaTranslationRegistryService } from \"./translation-registry.service\";\n\nexport const TRANSLATION_CONFIG = \"config_translation\";\nexport interface ITranslationConfig {\n  default: string;\n  supportedLanguages: string[];\n}\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class TaTranslationService {\n  public translateService = inject(TranslateService);\n  private _registry = inject(TaTranslationRegistryService);\n\n  constructor(\n    @Optional()\n    @Inject(TRANSLATION_CONFIG)\n    private _config: ITranslationConfig = {\n      default: \"fr\",\n      supportedLanguages: [\"fr\"],\n    }\n  ) {\n    // this language will be used as a fallback when a translation isn't found in the current language\n    this.translateService.setDefaultLang(this._config.default);\n\n    // the lang to use, if the lang isn't available, it will use the current loader to get them\n    let lang: string =\n      SessionStorage.get(\"lang\") ??\n      this.translateService.getBrowserLang() ??\n      this._config.default;\n\n    if (\n      !lang ||\n      !this._config.supportedLanguages.find((langId) => langId === lang)\n    ) {\n      lang = this._config.default;\n    }\n    this.translateService.use(lang);\n    this._registry.newRegistrationSubscription$\n      .pipe(\n        debounceTime(100),\n        mergeMap(() =>\n          this.translateService.reloadLang(this.translateService.currentLang)\n        )\n        // tap(data => console.log('reload lang', data))\n      )\n      .subscribe({\n        next: (translations) =>\n          this.translateService.onTranslationChange.emit({\n            lang: this.translateService.currentLang,\n            translations,\n          }),\n      });\n\n    this.translateService.onLangChange.subscribe(({ lang }) => {\n      if (!SessionStorage.has(\"lang\")) {\n        SessionStorage.set(\"lang\", lang);\n        return;\n      }\n\n      if (lang === SessionStorage.get(\"lang\")) {\n        return;\n      }\n\n      SessionStorage.set(\"lang\", lang);\n      location.reload();\n    });\n  }\n\n  public init() {}\n\n  public getLanguage(): string {\n    return this.translateService.currentLang;\n  }\n\n  public get(key: string | string[], interpolateParams?: Object) {\n    return this.translateService.get(key, interpolateParams);\n  }\n\n  public use(lang: string) {\n    return this.translateService.use(lang);\n  }\n}\n","import { BaseStrapi, GraphSchema, baseStrapiProps } from \"@ta/server\";\n\nexport interface Feature extends BaseStrapi {\n  key: string;\n}\nconst props: (keyof Feature)[] = [\"key\"];\n\nexport const featureProps = new GraphSchema<Feature>(\n  props.concat(baseStrapiProps)\n);\n","import { BaseStrapi, GraphSchema, baseStrapiProps } from \"@ta/server\";\n\nimport { Feature } from \"./feature\";\n\nexport interface Translation extends BaseStrapi {\n  key: string;\n  feature?: Feature;\n  value: string;\n}\nconst props: (keyof Translation)[] = [\"key\", \"feature\", \"value\"];\n\nexport const translationProps = new GraphSchema<Translation>(\n  props.concat(baseStrapiProps)\n);\n","import { Apollo_gql, GraphQueryPayload } from \"@ta/server\";\n\nimport { featureProps } from \"./dto/feature\";\nimport { translationProps } from \"./dto/translation\";\n\nexport function GET_TRANSLATIONS(\n  locale: string,\n  feature: string\n): GraphQueryPayload {\n  const filters = { feature: { key: { eq: feature } } };\n  return {\n    query: Apollo_gql`\n      query Translations($locale: I18NLocaleCode!, $filters: TranslationFiltersInput!) {\n        translations(locale: $locale, filters: $filters, pagination: { pageSize: 50000 }) {\n          ${translationProps.get(\"key\")}\n          ${translationProps.get(\"value\")}\n          ${translationProps.get(\"feature\")} {\n            ${featureProps.get(\"key\")}\n          }\n        }\n      }\n    `,\n    variables: {\n      locale: locale,\n      filters: filters,\n    },\n  };\n}\n","import { InjectionToken } from \"@angular/core\";\n\nexport enum TranslationSourceType {\n  GRAPHQL = \"graphql\",\n  FILE = \"file\",\n}\n\nexport interface ITranslationSourceConfig {\n  type: TranslationSourceType;\n  /**\n   * Base path for file-based translations\n   * Example: '/assets/i18n/' will look for files like '/assets/i18n/en.json'\n   */\n  filePath?: string;\n}\n\nexport const TRANSLATION_SOURCE_CONFIG =\n  new InjectionToken<ITranslationSourceConfig>(\"TRANSLATION_SOURCE_CONFIG\", {\n    providedIn: \"root\",\n    factory: () => ({\n      type: TranslationSourceType.GRAPHQL,\n    }),\n  });\n","import { HttpClient } from \"@angular/common/http\";\nimport { inject } from \"@angular/core\";\n\nimport { Observable, map } from \"rxjs\";\n\nimport { TaBaseStrapiService } from \"@ta/server\";\n\nimport { Translation } from \"./dto/translation\";\nimport { GET_TRANSLATIONS } from \"./queries\";\nimport {\n  ITranslation,\n  TaTranslationRegistryService,\n} from \"./translation-registry.service\";\nimport {\n  TRANSLATION_SOURCE_CONFIG,\n  TranslationSourceType,\n} from \"./translation-source.config\";\n\nexport abstract class TaLazyTranslationService\n  extends TaBaseStrapiService\n  implements ITranslation\n{\n  get id() {\n    return this._id;\n  }\n  private readonly _registry = inject(TaTranslationRegistryService);\n  private readonly _sourceConfig = inject(TRANSLATION_SOURCE_CONFIG);\n  private readonly _http = inject(HttpClient);\n\n  private _id = \"\";\n  private _isApp = false;\n\n  constructor(id: string, isApp = false) {\n    super();\n\n    this._id = id;\n    this._isApp = isApp;\n    this._registry.register(this);\n  }\n\n  static getInstance() {\n    return inject(this);\n  }\n\n  public getTranslation(lang: string): Observable<object | null> {\n    const source$ =\n      this._sourceConfig.type === TranslationSourceType.FILE\n        ? this._getTranslationsFromFile(lang)\n        : this._getTranslationsFromGraphQL(lang);\n\n    return source$.pipe(\n      map((translations) =>\n        translations.reduce<{ [index: string]: string }>((acc, translation) => {\n          acc[(this._isApp ? \"\" : this._id + \".\") + translation.key.trim()] =\n            translation.value;\n          return acc;\n        }, {})\n      ),\n      map((translations) =>\n        Object.entries(translations).reduce((acc, [key, value]) => {\n          const keys = key.split(\".\");\n          keys.reduce<{ [index: string]: any }>((current, k, index) => {\n            if (index === keys.length - 1) {\n              current[k] = value;\n            } else {\n              current[k] = current[k] || {};\n            }\n            return current[k];\n          }, acc);\n\n          return acc;\n        }, {})\n      )\n    );\n  }\n\n  private _getTranslationsFromFile(lang: string): Observable<Translation[]> {\n    return this._http\n      .get<{ [key: string]: string }>(\n        `${this._sourceConfig.filePath}${this._id}/${lang}.json`\n      )\n      .pipe(\n        map((jsonData) =>\n          Object.entries(jsonData).map(([key, value]) => ({\n            key,\n            value,\n          }))\n        )\n      );\n  }\n\n  private _getTranslationsFromGraphQL(lang: string) {\n    return this._strapiService.fetchQueryList$<Translation>(\n      GET_TRANSLATIONS(lang, this._id),\n      \"translations\"\n    );\n  }\n}\n","import { inject } from \"@angular/core\";\n\nimport { TranslateLoader } from \"@ngx-translate/core\";\nimport { Observable, forkJoin, map } from \"rxjs\";\n\nimport { TaTranslationRegistryService } from \"./translation-registry.service\";\n\nexport class TaTranslationLoader implements TranslateLoader {\n  private registry = inject(TaTranslationRegistryService);\n  constructor() {}\n\n  getTranslation(lang: string): Observable<object> {\n    return forkJoin([...this.registry.getTranslations(lang)]).pipe(\n      map((translations) =>\n        translations.reduce<object>((acc, translation) => {\n          if (!translation) {\n            return acc;\n          }\n          return this._merge(acc, translation);\n        }, {})\n      )\n    );\n  }\n\n  private _merge(current: object, additionalTranslation: object): object {\n    return this._mergeDeep(current, additionalTranslation);\n  }\n\n  /**\n   * Simple object check.\n   * @param item Object\n   */\n  private _isObject(item: object | undefined): boolean {\n    return !!(item && typeof item === \"object\" && !Array.isArray(item));\n  }\n\n  /**\n   * Deep merge two objects.\n   * @param target Object\n   * @param ...sources objects\n   */\n  private _mergeDeep(\n    target: { [key: string]: any },\n    ...sources: { [key: string]: any }[]\n  ): { [key: string]: any } {\n    if (!sources.length) {\n      return target;\n    }\n    const source = sources.shift();\n    if (this._isObject(target) && this._isObject(source)) {\n      for (const key in source) {\n        if (this._isObject(source[key])) {\n          if (!target[key]) {\n            Object.assign(target, { [key]: {} });\n          }\n          this._mergeDeep(target[key], source[key]);\n        } else {\n          Object.assign(target, { [key]: source[key] });\n        }\n      }\n    }\n\n    return this._mergeDeep(target, ...sources);\n  }\n}\n","import { APP_INITIALIZER, LOCALE_ID, Provider } from \"@angular/core\";\n\nimport { TranslateLoader, provideTranslateService } from \"@ngx-translate/core\";\n\nimport { TaTranslationLoader } from \"./services/translation.loader\";\nimport {\n  TRANSLATION_SOURCE_CONFIG,\n  ITranslationSourceConfig,\n  TranslationSourceType,\n} from \"./services/translation-source.config\";\nimport {\n  TRANSLATION_CONFIG,\n  TaTranslationService,\n} from \"./services/translation.service\";\n\nexport function HttpLoaderFactory() {\n  return new TaTranslationLoader();\n}\nexport function initTranslation(service: TaTranslationService) {\n  const fn = () => service.init();\n  return fn;\n}\n\nexport interface IProvideTranslationConfig {\n  default: string;\n  supportedLanguages: string[];\n  source?: ITranslationSourceConfig;\n}\n\nexport const provideTranslation = (\n  data: IProvideTranslationConfig\n): Provider => [\n  provideTranslateService({\n    loader: {\n      provide: TranslateLoader,\n      useClass: TaTranslationLoader,\n    },\n  }),\n  {\n    provide: LOCALE_ID,\n    deps: [TaTranslationService],\n    useFactory: (TranslationService: TaTranslationService) =>\n      TranslationService.getLanguage(),\n  },\n  {\n    provide: APP_INITIALIZER,\n    useFactory: initTranslation,\n    deps: [TaTranslationService],\n    multi: true,\n  },\n  {\n    provide: TRANSLATION_CONFIG,\n    useValue: {\n      default: data.default,\n      supportedLanguages: data.supportedLanguages,\n    },\n  },\n  {\n    provide: TRANSLATION_SOURCE_CONFIG,\n    useValue: data.source ?? {\n      type: TranslationSourceType.GRAPHQL,\n    },\n  },\n];\n","/*\n * Public API Surface of translation\n */\nexport { TranslateDirective, TranslatePipe } from \"@ngx-translate/core\";\n\nexport * from \"./lib/abstract/abstractTranslationModule\";\nexport * from \"./lib/services/translation.service\";\nexport * from \"./lib/services/translation-registry.service\";\n\nexport * from \"./lib/services/lazy-translation.service\";\nexport * from \"./lib/services/translation-source.config\";\n\nexport * from \"./lib/provider\";\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["props"],"mappings":"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"}