import { AsyncPipe, NgIf } from '@angular/common';
import { Component, inject } from '@angular/core';
import { of } from 'rxjs';
import { DropdownComponent } from '@ta/form-input';
import { InputDropdown } from '@ta/form-model';
import { TranslatePipe } from '@ta/translation';
import { ButtonComponent, TrigramComponent } from '@ta/ui';
import { JoinPipe, StopPropagationDirective } from '@ta/utils';
import { TaBaseComponent } from '@ta/utils';
import { CAM_AUTH_TOKEN } from '../../services/auth.service';
import { CamPermissionsService } from '../../services/permissions.service';
import * as i0 from "@angular/core";
import * as i1 from "@ta/translation";
export class MenuUserComponent extends TaBaseComponent {
    get roles() {
        return this._permissionsService.roles;
    }
    get getFirstLetter() {
        return this.authService.firstLetter;
    }
    constructor(translateService) {
        super();
        this.translateService = translateService;
        this._permissionsService = inject(CamPermissionsService);
        this.authService = inject(CAM_AUTH_TOKEN);
        this.language = new InputDropdown({
            label: '',
            options: of([
                { id: 'fr', name: 'Français' },
                { id: 'nl', name: 'Nederlands' },
                { id: 'en', name: 'English' },
                { id: 'es', name: 'Español' },
            ]),
        });
        this.language.value = this.translateService.getLanguage();
        this._registerSubscription(this.language.changeValue$.subscribe(value => this.translateService.use(value)));
    }
    login() {
        this.authService.login();
    }
    logout() {
        this.authService.logout();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: MenuUserComponent, deps: [{ token: i1.CamTranslationService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.13", type: MenuUserComponent, isStandalone: true, selector: "ta-user-menu", usesInheritance: true, ngImport: i0, template: "<div class=\"overlay\">\n  <div class=\"row user-info\">\n    <div class=\"col-5 align-items-center\">\n      {{ 'user.language' | translate }}\n    </div>\n    <div class=\"col-7\">\n      <ta-input-dropdown [input]=\"this.language\" appStopPropagation [standalone]=\"true\"></ta-input-dropdown>\n    </div>\n  </div>\n\n  @if (this.authService.isAuthenticated$ | async) {\n    <div class=\"row user-info\">\n      <div class=\"col-2\">\n        <ta-trigram [value]=\"this.getFirstLetter\"></ta-trigram>\n      </div>\n      <div class=\"col\">\n        <div class=\"title\">{{ (this.authService.user$ | async)?.name }}</div>\n        @if (this.roles.length > 0) {\n          <div class=\"subtitle\">\n            {{ this.roles | join }}\n          </div>\n        }\n      </div>\n    </div>\n\n    <div class=\"row user-info\">\n      <ta-button type=\"secondary\" (action)=\"this.logout()\">\n        {{ 'user.logout' | translate }}\n      </ta-button>\n    </div>\n  }\n</div>\n", styles: [".connect{font-size:var(--ta-font-body-xs-default-size);line-height:var(--ta-font-body-xs-default-line);font-weight:var(--ta-font-body-xs-default-weight)}.user{background-color:var(--ta-neutral-100);color:var(--ta-text-primary);padding:var(--ta-space-space);border-radius:60px}.user .expand{text-align:center;line-height:0}.overlay{padding:var(--ta-space-space);width:350px}.overlay .user-info{border-bottom:1px solid var(--ta-border-primary);padding-bottom:var(--ta-space-xs);margin:0;margin-bottom:var(--ta-space-xs)}.overlay .user-info:last-of-type{border-bottom:none;padding:0;margin:0}.overlay .title{font-size:var(--ta-font-body-md-default-size);line-height:var(--ta-font-body-md-default-line);font-weight:var(--ta-font-body-md-default-weight)}.overlay .subtitle{font-size:var(--ta-font-body-xs-default-size);line-height:var(--ta-font-body-xs-default-line);font-weight:var(--ta-font-body-xs-default-weight)}\n"], dependencies: [{ kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "directive", type: StopPropagationDirective, selector: "[appStopPropagation]", inputs: ["stopPropagationActivation"] }, { kind: "component", type: TrigramComponent, selector: "ta-trigram", inputs: ["value", "size"] }, { kind: "component", type: ButtonComponent, selector: "ta-button", inputs: ["state", "type", "size", "icon", "options", "stopPropagationActivation"], outputs: ["action"] }, { kind: "pipe", type: TranslatePipe, name: "translate" }, { kind: "pipe", type: JoinPipe, name: "join" }, { kind: "component", type: DropdownComponent, selector: "ta-input-dropdown", inputs: ["space"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: MenuUserComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ta-user-menu', standalone: true, imports: [
                        NgIf,
                        AsyncPipe,
                        StopPropagationDirective,
                        TrigramComponent,
                        ButtonComponent,
                        TranslatePipe,
                        JoinPipe,
                        DropdownComponent,
                    ], template: "<div class=\"overlay\">\n  <div class=\"row user-info\">\n    <div class=\"col-5 align-items-center\">\n      {{ 'user.language' | translate }}\n    </div>\n    <div class=\"col-7\">\n      <ta-input-dropdown [input]=\"this.language\" appStopPropagation [standalone]=\"true\"></ta-input-dropdown>\n    </div>\n  </div>\n\n  @if (this.authService.isAuthenticated$ | async) {\n    <div class=\"row user-info\">\n      <div class=\"col-2\">\n        <ta-trigram [value]=\"this.getFirstLetter\"></ta-trigram>\n      </div>\n      <div class=\"col\">\n        <div class=\"title\">{{ (this.authService.user$ | async)?.name }}</div>\n        @if (this.roles.length > 0) {\n          <div class=\"subtitle\">\n            {{ this.roles | join }}\n          </div>\n        }\n      </div>\n    </div>\n\n    <div class=\"row user-info\">\n      <ta-button type=\"secondary\" (action)=\"this.logout()\">\n        {{ 'user.logout' | translate }}\n      </ta-button>\n    </div>\n  }\n</div>\n", styles: [".connect{font-size:var(--ta-font-body-xs-default-size);line-height:var(--ta-font-body-xs-default-line);font-weight:var(--ta-font-body-xs-default-weight)}.user{background-color:var(--ta-neutral-100);color:var(--ta-text-primary);padding:var(--ta-space-space);border-radius:60px}.user .expand{text-align:center;line-height:0}.overlay{padding:var(--ta-space-space);width:350px}.overlay .user-info{border-bottom:1px solid var(--ta-border-primary);padding-bottom:var(--ta-space-xs);margin:0;margin-bottom:var(--ta-space-xs)}.overlay .user-info:last-of-type{border-bottom:none;padding:0;margin:0}.overlay .title{font-size:var(--ta-font-body-md-default-size);line-height:var(--ta-font-body-md-default-line);font-weight:var(--ta-font-body-md-default-weight)}.overlay .subtitle{font-size:var(--ta-font-body-xs-default-size);line-height:var(--ta-font-body-xs-default-line);font-weight:var(--ta-font-body-xs-default-weight)}\n"] }]
        }], ctorParameters: () => [{ type: i1.CamTranslationService }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS11c2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvbW9kdWxlcy91c2VyL2NvbXBvbmVudHMvbWVudS9tZW51LXVzZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9tb2R1bGVzL3VzZXIvY29tcG9uZW50cy9tZW51L21lbnUtdXNlci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxTQUFTLEVBQWEsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTdELE9BQU8sRUFBRSxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFMUIsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDbkQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQy9DLE9BQU8sRUFBeUIsYUFBYSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDdkUsT0FBTyxFQUFFLGVBQWUsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUMzRCxPQUFPLEVBQUUsUUFBUSxFQUFFLHdCQUF3QixFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQy9ELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFFNUMsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQzdELE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLG9DQUFvQyxDQUFDOzs7QUFrQjNFLE1BQU0sT0FBTyxpQkFBa0IsU0FBUSxlQUFlO0lBR3BELElBQUksS0FBSztRQUNQLE9BQU8sSUFBSSxDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQztJQUN4QyxDQUFDO0lBRUQsSUFBSSxjQUFjO1FBQ2hCLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUM7SUFDdEMsQ0FBQztJQWFELFlBQW1CLGdCQUF1QztRQUN4RCxLQUFLLEVBQUUsQ0FBQztRQURTLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBdUI7UUFyQjFDLHdCQUFtQixHQUFHLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBVTdELGdCQUFXLEdBQUcsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ3JDLGFBQVEsR0FBRyxJQUFJLGFBQWEsQ0FBUztZQUMxQyxLQUFLLEVBQUUsRUFBRTtZQUNULE9BQU8sRUFBRSxFQUFFLENBQUM7Z0JBQ1YsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUU7Z0JBQzlCLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFO2dCQUNoQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRTtnQkFDN0IsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUU7YUFDOUIsQ0FBQztTQUNILENBQUMsQ0FBQztRQUtELElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUUxRCxJQUFJLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDOUcsQ0FBQztJQUVNLEtBQUs7UUFDVixJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQzNCLENBQUM7SUFFTSxNQUFNO1FBQ1gsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUM1QixDQUFDOytHQXBDVSxpQkFBaUI7bUdBQWpCLGlCQUFpQiwrRkMvQjlCLHk5QkFnQ0EsdThCRFZJLFNBQVMsOENBQ1Qsd0JBQXdCLHdHQUN4QixnQkFBZ0Isa0ZBQ2hCLGVBQWUseUpBQ2YsYUFBYSw2Q0FDYixRQUFRLDZDQUNSLGlCQUFpQjs7NEZBR1IsaUJBQWlCO2tCQWhCN0IsU0FBUzsrQkFDRSxjQUFjLGNBR1osSUFBSSxXQUNQO3dCQUNQLElBQUk7d0JBQ0osU0FBUzt3QkFDVCx3QkFBd0I7d0JBQ3hCLGdCQUFnQjt3QkFDaEIsZUFBZTt3QkFDZixhQUFhO3dCQUNiLFFBQVE7d0JBQ1IsaUJBQWlCO3FCQUNsQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzeW5jUGlwZSwgTmdJZiB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBDb21wb25lbnQsIE9uRGVzdHJveSwgaW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IG9mIH0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7IERyb3Bkb3duQ29tcG9uZW50IH0gZnJvbSAnQHRhL2Zvcm0taW5wdXQnO1xuaW1wb3J0IHsgSW5wdXREcm9wZG93biB9IGZyb20gJ0B0YS9mb3JtLW1vZGVsJztcbmltcG9ydCB7IENhbVRyYW5zbGF0aW9uU2VydmljZSwgVHJhbnNsYXRlUGlwZSB9IGZyb20gJ0B0YS90cmFuc2xhdGlvbic7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIFRyaWdyYW1Db21wb25lbnQgfSBmcm9tICdAdGEvdWknO1xuaW1wb3J0IHsgSm9pblBpcGUsIFN0b3BQcm9wYWdhdGlvbkRpcmVjdGl2ZSB9IGZyb20gJ0B0YS91dGlscyc7XG5pbXBvcnQgeyBUYUJhc2VDb21wb25lbnQgfSBmcm9tICdAdGEvdXRpbHMnO1xuXG5pbXBvcnQgeyBDQU1fQVVUSF9UT0tFTiB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2F1dGguc2VydmljZSc7XG5pbXBvcnQgeyBDYW1QZXJtaXNzaW9uc1NlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9wZXJtaXNzaW9ucy5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGEtdXNlci1tZW51JyxcbiAgdGVtcGxhdGVVcmw6ICcuL21lbnUtdXNlci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL21lbnUtdXNlci5jb21wb25lbnQuc2NzcyddLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgTmdJZixcbiAgICBBc3luY1BpcGUsXG4gICAgU3RvcFByb3BhZ2F0aW9uRGlyZWN0aXZlLFxuICAgIFRyaWdyYW1Db21wb25lbnQsXG4gICAgQnV0dG9uQ29tcG9uZW50LFxuICAgIFRyYW5zbGF0ZVBpcGUsXG4gICAgSm9pblBpcGUsXG4gICAgRHJvcGRvd25Db21wb25lbnQsXG4gIF0sXG59KVxuZXhwb3J0IGNsYXNzIE1lbnVVc2VyQ29tcG9uZW50IGV4dGVuZHMgVGFCYXNlQ29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95IHtcbiAgcHVibGljIHJlYWRvbmx5IF9wZXJtaXNzaW9uc1NlcnZpY2UgPSBpbmplY3QoQ2FtUGVybWlzc2lvbnNTZXJ2aWNlKTtcblxuICBnZXQgcm9sZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Blcm1pc3Npb25zU2VydmljZS5yb2xlcztcbiAgfVxuXG4gIGdldCBnZXRGaXJzdExldHRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5hdXRoU2VydmljZS5maXJzdExldHRlcjtcbiAgfVxuXG4gIHB1YmxpYyBhdXRoU2VydmljZSA9IGluamVjdChDQU1fQVVUSF9UT0tFTik7XG4gIHB1YmxpYyBsYW5ndWFnZSA9IG5ldyBJbnB1dERyb3Bkb3duPHN0cmluZz4oe1xuICAgIGxhYmVsOiAnJyxcbiAgICBvcHRpb25zOiBvZihbXG4gICAgICB7IGlkOiAnZnInLCBuYW1lOiAnRnJhbsOnYWlzJyB9LFxuICAgICAgeyBpZDogJ25sJywgbmFtZTogJ05lZGVybGFuZHMnIH0sXG4gICAgICB7IGlkOiAnZW4nLCBuYW1lOiAnRW5nbGlzaCcgfSxcbiAgICAgIHsgaWQ6ICdlcycsIG5hbWU6ICdFc3Bhw7FvbCcgfSxcbiAgICBdKSxcbiAgfSk7XG5cbiAgY29uc3RydWN0b3IocHVibGljIHRyYW5zbGF0ZVNlcnZpY2U6IENhbVRyYW5zbGF0aW9uU2VydmljZSkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLmxhbmd1YWdlLnZhbHVlID0gdGhpcy50cmFuc2xhdGVTZXJ2aWNlLmdldExhbmd1YWdlKCk7XG5cbiAgICB0aGlzLl9yZWdpc3RlclN1YnNjcmlwdGlvbih0aGlzLmxhbmd1YWdlLmNoYW5nZVZhbHVlJC5zdWJzY3JpYmUodmFsdWUgPT4gdGhpcy50cmFuc2xhdGVTZXJ2aWNlLnVzZSh2YWx1ZSkpKTtcbiAgfVxuXG4gIHB1YmxpYyBsb2dpbigpIHtcbiAgICB0aGlzLmF1dGhTZXJ2aWNlLmxvZ2luKCk7XG4gIH1cblxuICBwdWJsaWMgbG9nb3V0KCkge1xuICAgIHRoaXMuYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJvdmVybGF5XCI+XG4gIDxkaXYgY2xhc3M9XCJyb3cgdXNlci1pbmZvXCI+XG4gICAgPGRpdiBjbGFzcz1cImNvbC01IGFsaWduLWl0ZW1zLWNlbnRlclwiPlxuICAgICAge3sgJ3VzZXIubGFuZ3VhZ2UnIHwgdHJhbnNsYXRlIH19XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cImNvbC03XCI+XG4gICAgICA8dGEtaW5wdXQtZHJvcGRvd24gW2lucHV0XT1cInRoaXMubGFuZ3VhZ2VcIiBhcHBTdG9wUHJvcGFnYXRpb24gW3N0YW5kYWxvbmVdPVwidHJ1ZVwiPjwvdGEtaW5wdXQtZHJvcGRvd24+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuXG4gIEBpZiAodGhpcy5hdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQkIHwgYXN5bmMpIHtcbiAgICA8ZGl2IGNsYXNzPVwicm93IHVzZXItaW5mb1wiPlxuICAgICAgPGRpdiBjbGFzcz1cImNvbC0yXCI+XG4gICAgICAgIDx0YS10cmlncmFtIFt2YWx1ZV09XCJ0aGlzLmdldEZpcnN0TGV0dGVyXCI+PC90YS10cmlncmFtPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiY29sXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0aXRsZVwiPnt7ICh0aGlzLmF1dGhTZXJ2aWNlLnVzZXIkIHwgYXN5bmMpPy5uYW1lIH19PC9kaXY+XG4gICAgICAgIEBpZiAodGhpcy5yb2xlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInN1YnRpdGxlXCI+XG4gICAgICAgICAgICB7eyB0aGlzLnJvbGVzIHwgam9pbiB9fVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICB9XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJyb3cgdXNlci1pbmZvXCI+XG4gICAgICA8dGEtYnV0dG9uIHR5cGU9XCJzZWNvbmRhcnlcIiAoYWN0aW9uKT1cInRoaXMubG9nb3V0KClcIj5cbiAgICAgICAge3sgJ3VzZXIubG9nb3V0JyB8IHRyYW5zbGF0ZSB9fVxuICAgICAgPC90YS1idXR0b24+XG4gICAgPC9kaXY+XG4gIH1cbjwvZGl2PlxuIl19