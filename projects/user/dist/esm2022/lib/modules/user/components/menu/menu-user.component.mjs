import { AsyncPipe, NgIf } from '@angular/common';
import { Component, inject } from '@angular/core';
import { ButtonComponent, TrigramComponent } from 'projects/ui/dist';
import { of } from 'rxjs';
import { DropdownComponent } from '@ta/form-input';
import { InputDropdown } from '@ta/form-model';
import { TranslatePipe } from '@ta/translation';
import { JoinPipe, StopPropagationDirective } from '@ta/utils';
import { TaBaseComponent } from '@ta/utils';
import { CAM_AUTH_TOKEN } from '../../services/auth.service';
import { CamPermissionsService } from '../../services/permissions.service';
import * as i0 from "@angular/core";
import * as i1 from "@ta/translation";
export class MenuUserComponent extends TaBaseComponent {
    get roles() {
        return this._permissionsService.roles;
    }
    get getFirstLetter() {
        return this.authService.firstLetter;
    }
    constructor(translateService) {
        super();
        this.translateService = translateService;
        this._permissionsService = inject(CamPermissionsService);
        this.authService = inject(CAM_AUTH_TOKEN);
        this.language = new InputDropdown({
            label: '',
            options: of([
                { id: 'fr', name: 'Français' },
                { id: 'nl', name: 'Nederlands' },
                { id: 'en', name: 'English' },
                { id: 'es', name: 'Español' },
            ]),
        });
        this.language.value = this.translateService.getLanguage();
        this._registerSubscription(this.language.changeValue$.subscribe(value => this.translateService.use(value)));
    }
    login() {
        this.authService.login();
    }
    logout() {
        this.authService.logout();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: MenuUserComponent, deps: [{ token: i1.CamTranslationService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.13", type: MenuUserComponent, isStandalone: true, selector: "ta-user-menu", usesInheritance: true, ngImport: i0, template: "<div class=\"overlay\">\n  <div class=\"row user-info\">\n    <div class=\"col-5 align-items-center\">\n      {{ 'user.language' | translate }}\n    </div>\n    <div class=\"col-7\">\n      <ta-input-dropdown [input]=\"this.language\" appStopPropagation [standalone]=\"true\"></ta-input-dropdown>\n    </div>\n  </div>\n\n  @if (this.authService.isAuthenticated$ | async) {\n    <div class=\"row user-info\">\n      <div class=\"col-2\">\n        <ta-trigram [value]=\"this.getFirstLetter\"></ta-trigram>\n      </div>\n      <div class=\"col\">\n        <div class=\"title\">{{ (this.authService.user$ | async)?.name }}</div>\n        @if (this.roles.length > 0) {\n          <div class=\"subtitle\">\n            {{ this.roles | join }}\n          </div>\n        }\n      </div>\n    </div>\n\n    <div class=\"row user-info\">\n      <ta-button type=\"secondary\" (action)=\"this.logout()\">\n        {{ 'user.logout' | translate }}\n      </ta-button>\n    </div>\n  }\n</div>\n", styles: [".connect{font-size:var(--ta-font-body-xs-default-size);line-height:var(--ta-font-body-xs-default-line);font-weight:var(--ta-font-body-xs-default-weight)}.user{background-color:var(--ta-neutral-100);color:var(--ta-text-primary);padding:var(--ta-space-space);border-radius:60px}.user .expand{text-align:center;line-height:0}.overlay{padding:var(--ta-space-space);width:350px}.overlay .user-info{border-bottom:1px solid var(--ta-border-primary);padding-bottom:var(--ta-space-xs);margin:0;margin-bottom:var(--ta-space-xs)}.overlay .user-info:last-of-type{border-bottom:none;padding:0;margin:0}.overlay .title{font-size:var(--ta-font-body-md-default-size);line-height:var(--ta-font-body-md-default-line);font-weight:var(--ta-font-body-md-default-weight)}.overlay .subtitle{font-size:var(--ta-font-body-xs-default-size);line-height:var(--ta-font-body-xs-default-line);font-weight:var(--ta-font-body-xs-default-weight)}\n"], dependencies: [{ kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "directive", type: StopPropagationDirective, selector: "[appStopPropagation]", inputs: ["stopPropagationActivation"] }, { kind: "component", type: TrigramComponent, selector: "ta-trigram", inputs: ["value", "size"] }, { kind: "component", type: ButtonComponent, selector: "ta-button", inputs: ["state", "type", "size", "icon", "options", "stopPropagationActivation"], outputs: ["action"] }, { kind: "pipe", type: TranslatePipe, name: "translate" }, { kind: "pipe", type: JoinPipe, name: "join" }, { kind: "component", type: DropdownComponent, selector: "ta-input-dropdown", inputs: ["space"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: MenuUserComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ta-user-menu', standalone: true, imports: [
                        NgIf,
                        AsyncPipe,
                        StopPropagationDirective,
                        TrigramComponent,
                        ButtonComponent,
                        TranslatePipe,
                        JoinPipe,
                        DropdownComponent,
                    ], template: "<div class=\"overlay\">\n  <div class=\"row user-info\">\n    <div class=\"col-5 align-items-center\">\n      {{ 'user.language' | translate }}\n    </div>\n    <div class=\"col-7\">\n      <ta-input-dropdown [input]=\"this.language\" appStopPropagation [standalone]=\"true\"></ta-input-dropdown>\n    </div>\n  </div>\n\n  @if (this.authService.isAuthenticated$ | async) {\n    <div class=\"row user-info\">\n      <div class=\"col-2\">\n        <ta-trigram [value]=\"this.getFirstLetter\"></ta-trigram>\n      </div>\n      <div class=\"col\">\n        <div class=\"title\">{{ (this.authService.user$ | async)?.name }}</div>\n        @if (this.roles.length > 0) {\n          <div class=\"subtitle\">\n            {{ this.roles | join }}\n          </div>\n        }\n      </div>\n    </div>\n\n    <div class=\"row user-info\">\n      <ta-button type=\"secondary\" (action)=\"this.logout()\">\n        {{ 'user.logout' | translate }}\n      </ta-button>\n    </div>\n  }\n</div>\n", styles: [".connect{font-size:var(--ta-font-body-xs-default-size);line-height:var(--ta-font-body-xs-default-line);font-weight:var(--ta-font-body-xs-default-weight)}.user{background-color:var(--ta-neutral-100);color:var(--ta-text-primary);padding:var(--ta-space-space);border-radius:60px}.user .expand{text-align:center;line-height:0}.overlay{padding:var(--ta-space-space);width:350px}.overlay .user-info{border-bottom:1px solid var(--ta-border-primary);padding-bottom:var(--ta-space-xs);margin:0;margin-bottom:var(--ta-space-xs)}.overlay .user-info:last-of-type{border-bottom:none;padding:0;margin:0}.overlay .title{font-size:var(--ta-font-body-md-default-size);line-height:var(--ta-font-body-md-default-line);font-weight:var(--ta-font-body-md-default-weight)}.overlay .subtitle{font-size:var(--ta-font-body-xs-default-size);line-height:var(--ta-font-body-xs-default-line);font-weight:var(--ta-font-body-xs-default-weight)}\n"] }]
        }], ctorParameters: () => [{ type: i1.CamTranslationService }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS11c2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvbW9kdWxlcy91c2VyL2NvbXBvbmVudHMvbWVudS9tZW51LXVzZXIuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9tb2R1bGVzL3VzZXIvY29tcG9uZW50cy9tZW51L21lbnUtdXNlci5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxTQUFTLEVBQWEsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTdELE9BQU8sRUFBRSxlQUFlLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNyRSxPQUFPLEVBQUUsRUFBRSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRTFCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ25ELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMvQyxPQUFPLEVBQXlCLGFBQWEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3ZFLE9BQU8sRUFBRSxRQUFRLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDL0QsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUU1QyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDN0QsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7OztBQWtCM0UsTUFBTSxPQUFPLGlCQUFrQixTQUFRLGVBQWU7SUFHcEQsSUFBSSxLQUFLO1FBQ1AsT0FBTyxJQUFJLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDO0lBQ3hDLENBQUM7SUFFRCxJQUFJLGNBQWM7UUFDaEIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQztJQUN0QyxDQUFDO0lBYUQsWUFBbUIsZ0JBQXVDO1FBQ3hELEtBQUssRUFBRSxDQUFDO1FBRFMscUJBQWdCLEdBQWhCLGdCQUFnQixDQUF1QjtRQXJCMUMsd0JBQW1CLEdBQUcsTUFBTSxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFVN0QsZ0JBQVcsR0FBRyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDckMsYUFBUSxHQUFHLElBQUksYUFBYSxDQUFTO1lBQzFDLEtBQUssRUFBRSxFQUFFO1lBQ1QsT0FBTyxFQUFFLEVBQUUsQ0FBQztnQkFDVixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRTtnQkFDOUIsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxZQUFZLEVBQUU7Z0JBQ2hDLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFO2dCQUM3QixFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRTthQUM5QixDQUFDO1NBQ0gsQ0FBQyxDQUFDO1FBS0QsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFdBQVcsRUFBRSxDQUFDO1FBRTFELElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM5RyxDQUFDO0lBRU0sS0FBSztRQUNWLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDM0IsQ0FBQztJQUVNLE1BQU07UUFDWCxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQzVCLENBQUM7K0dBcENVLGlCQUFpQjttR0FBakIsaUJBQWlCLCtGQy9COUIseTlCQWdDQSx1OEJEVkksU0FBUyw4Q0FDVCx3QkFBd0Isd0dBQ3hCLGdCQUFnQixrRkFDaEIsZUFBZSx5SkFDZixhQUFhLDZDQUNiLFFBQVEsNkNBQ1IsaUJBQWlCOzs0RkFHUixpQkFBaUI7a0JBaEI3QixTQUFTOytCQUNFLGNBQWMsY0FHWixJQUFJLFdBQ1A7d0JBQ1AsSUFBSTt3QkFDSixTQUFTO3dCQUNULHdCQUF3Qjt3QkFDeEIsZ0JBQWdCO3dCQUNoQixlQUFlO3dCQUNmLGFBQWE7d0JBQ2IsUUFBUTt3QkFDUixpQkFBaUI7cUJBQ2xCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXN5bmNQaXBlLCBOZ0lmIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IENvbXBvbmVudCwgT25EZXN0cm95LCBpbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBUcmlncmFtQ29tcG9uZW50IH0gZnJvbSAncHJvamVjdHMvdWkvZGlzdCc7XG5pbXBvcnQgeyBvZiB9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQgeyBEcm9wZG93bkNvbXBvbmVudCB9IGZyb20gJ0B0YS9mb3JtLWlucHV0JztcbmltcG9ydCB7IElucHV0RHJvcGRvd24gfSBmcm9tICdAdGEvZm9ybS1tb2RlbCc7XG5pbXBvcnQgeyBDYW1UcmFuc2xhdGlvblNlcnZpY2UsIFRyYW5zbGF0ZVBpcGUgfSBmcm9tICdAdGEvdHJhbnNsYXRpb24nO1xuaW1wb3J0IHsgSm9pblBpcGUsIFN0b3BQcm9wYWdhdGlvbkRpcmVjdGl2ZSB9IGZyb20gJ0B0YS91dGlscyc7XG5pbXBvcnQgeyBUYUJhc2VDb21wb25lbnQgfSBmcm9tICdAdGEvdXRpbHMnO1xuXG5pbXBvcnQgeyBDQU1fQVVUSF9UT0tFTiB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2F1dGguc2VydmljZSc7XG5pbXBvcnQgeyBDYW1QZXJtaXNzaW9uc1NlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9wZXJtaXNzaW9ucy5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGEtdXNlci1tZW51JyxcbiAgdGVtcGxhdGVVcmw6ICcuL21lbnUtdXNlci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL21lbnUtdXNlci5jb21wb25lbnQuc2NzcyddLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgTmdJZixcbiAgICBBc3luY1BpcGUsXG4gICAgU3RvcFByb3BhZ2F0aW9uRGlyZWN0aXZlLFxuICAgIFRyaWdyYW1Db21wb25lbnQsXG4gICAgQnV0dG9uQ29tcG9uZW50LFxuICAgIFRyYW5zbGF0ZVBpcGUsXG4gICAgSm9pblBpcGUsXG4gICAgRHJvcGRvd25Db21wb25lbnQsXG4gIF0sXG59KVxuZXhwb3J0IGNsYXNzIE1lbnVVc2VyQ29tcG9uZW50IGV4dGVuZHMgVGFCYXNlQ29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95IHtcbiAgcHVibGljIHJlYWRvbmx5IF9wZXJtaXNzaW9uc1NlcnZpY2UgPSBpbmplY3QoQ2FtUGVybWlzc2lvbnNTZXJ2aWNlKTtcblxuICBnZXQgcm9sZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3Blcm1pc3Npb25zU2VydmljZS5yb2xlcztcbiAgfVxuXG4gIGdldCBnZXRGaXJzdExldHRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5hdXRoU2VydmljZS5maXJzdExldHRlcjtcbiAgfVxuXG4gIHB1YmxpYyBhdXRoU2VydmljZSA9IGluamVjdChDQU1fQVVUSF9UT0tFTik7XG4gIHB1YmxpYyBsYW5ndWFnZSA9IG5ldyBJbnB1dERyb3Bkb3duPHN0cmluZz4oe1xuICAgIGxhYmVsOiAnJyxcbiAgICBvcHRpb25zOiBvZihbXG4gICAgICB7IGlkOiAnZnInLCBuYW1lOiAnRnJhbsOnYWlzJyB9LFxuICAgICAgeyBpZDogJ25sJywgbmFtZTogJ05lZGVybGFuZHMnIH0sXG4gICAgICB7IGlkOiAnZW4nLCBuYW1lOiAnRW5nbGlzaCcgfSxcbiAgICAgIHsgaWQ6ICdlcycsIG5hbWU6ICdFc3Bhw7FvbCcgfSxcbiAgICBdKSxcbiAgfSk7XG5cbiAgY29uc3RydWN0b3IocHVibGljIHRyYW5zbGF0ZVNlcnZpY2U6IENhbVRyYW5zbGF0aW9uU2VydmljZSkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLmxhbmd1YWdlLnZhbHVlID0gdGhpcy50cmFuc2xhdGVTZXJ2aWNlLmdldExhbmd1YWdlKCk7XG5cbiAgICB0aGlzLl9yZWdpc3RlclN1YnNjcmlwdGlvbih0aGlzLmxhbmd1YWdlLmNoYW5nZVZhbHVlJC5zdWJzY3JpYmUodmFsdWUgPT4gdGhpcy50cmFuc2xhdGVTZXJ2aWNlLnVzZSh2YWx1ZSkpKTtcbiAgfVxuXG4gIHB1YmxpYyBsb2dpbigpIHtcbiAgICB0aGlzLmF1dGhTZXJ2aWNlLmxvZ2luKCk7XG4gIH1cblxuICBwdWJsaWMgbG9nb3V0KCkge1xuICAgIHRoaXMuYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJvdmVybGF5XCI+XG4gIDxkaXYgY2xhc3M9XCJyb3cgdXNlci1pbmZvXCI+XG4gICAgPGRpdiBjbGFzcz1cImNvbC01IGFsaWduLWl0ZW1zLWNlbnRlclwiPlxuICAgICAge3sgJ3VzZXIubGFuZ3VhZ2UnIHwgdHJhbnNsYXRlIH19XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cImNvbC03XCI+XG4gICAgICA8dGEtaW5wdXQtZHJvcGRvd24gW2lucHV0XT1cInRoaXMubGFuZ3VhZ2VcIiBhcHBTdG9wUHJvcGFnYXRpb24gW3N0YW5kYWxvbmVdPVwidHJ1ZVwiPjwvdGEtaW5wdXQtZHJvcGRvd24+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuXG4gIEBpZiAodGhpcy5hdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQkIHwgYXN5bmMpIHtcbiAgICA8ZGl2IGNsYXNzPVwicm93IHVzZXItaW5mb1wiPlxuICAgICAgPGRpdiBjbGFzcz1cImNvbC0yXCI+XG4gICAgICAgIDx0YS10cmlncmFtIFt2YWx1ZV09XCJ0aGlzLmdldEZpcnN0TGV0dGVyXCI+PC90YS10cmlncmFtPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiY29sXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0aXRsZVwiPnt7ICh0aGlzLmF1dGhTZXJ2aWNlLnVzZXIkIHwgYXN5bmMpPy5uYW1lIH19PC9kaXY+XG4gICAgICAgIEBpZiAodGhpcy5yb2xlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInN1YnRpdGxlXCI+XG4gICAgICAgICAgICB7eyB0aGlzLnJvbGVzIHwgam9pbiB9fVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICB9XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJyb3cgdXNlci1pbmZvXCI+XG4gICAgICA8dGEtYnV0dG9uIHR5cGU9XCJzZWNvbmRhcnlcIiAoYWN0aW9uKT1cInRoaXMubG9nb3V0KClcIj5cbiAgICAgICAge3sgJ3VzZXIubG9nb3V0JyB8IHRyYW5zbGF0ZSB9fVxuICAgICAgPC90YS1idXR0b24+XG4gICAgPC9kaXY+XG4gIH1cbjwvZGl2PlxuIl19