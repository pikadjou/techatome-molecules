import { AsyncPipe, NgFor, NgIf } from '@angular/common';
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { TranslatePipe } from '@ta/translation';
import { EmptyComponent, ErrorComponent, LinkComponent, ListContainerComponent, ListElementComponent, ListExtraInformationComponent, ListTitleComponent, LoaderComponent, TitleComponent, UiProfileDisplayComponent, } from '@ta/ui';
import { TaBaseComponent, fullName, sendMail } from '@ta/utils';
import * as i0 from "@angular/core";
import * as i1 from "../../services/users.service";
export class UserMyProfileComponent extends TaBaseComponent {
    get currentUser$() {
        return this._userService.currentUser.get$();
    }
    constructor(_userService) {
        super();
        this._userService = _userService;
        this.canModify = true;
        this.modifyAction = new EventEmitter();
        this.mailTo = sendMail;
        this.ctas = [
            {
                icon: 'modify',
                label: 'user.modify',
                callback: () => this._modifyProfile(),
            },
        ];
        this._fetch();
    }
    getFullName(firstName, lastName) {
        return fullName({ firstName: firstName, name: lastName });
    }
    getUserLogo(user) {
        return {
            userInfo: {
                profilePictureUrl: user.picture,
                naming: {
                    name: user.lastName,
                    firstName: user.firstName,
                    trigram: user.trigram,
                },
            },
        };
    }
    _fetch() {
        this.requestState.asked();
        this._userService.fetchCurrentUser$().subscribe({
            complete: () => this.requestState.completed(),
            error: (error) => {
                this.requestState.onError(error.status, error.statusText);
            },
        });
    }
    _modifyProfile() {
        this.modifyAction.emit();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: UserMyProfileComponent, deps: [{ token: i1.TaUsersService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.13", type: UserMyProfileComponent, isStandalone: true, selector: "ta-user-my-profile", inputs: { canModify: "canModify" }, outputs: { modifyAction: "modifyAction" }, usesInheritance: true, ngImport: i0, template: "<ta-loader [isLoading]=\"this.requestState.isLoading()\" *ngLet=\"this.currentUser$ | async as currentUser\">\n  <ta-error [message]=\"this.requestState.getErrorMessage()\" [code]=\"this.requestState.getErrorStatus()\">\n    <ta-empty [isEmpty]=\"!currentUser\">\n      @if (currentUser) {\n        <ta-ui-profile-display\n          [label]=\"this.getFullName(currentUser.firstName, currentUser.lastName)\"\n          [ctas]=\"this.canModify ? this.ctas : null\"\n          [userLogo]=\"this.getUserLogo(currentUser)\"\n        >\n          <div class=\"pt-space-xxl\">\n            <div class=\"pt-space-xs align-center\">\n              <ta-title class=\"m-a\" [level]=\"3\">\n                <ta-link (action)=\"this.mailTo(currentUser.userName)\">{{ currentUser.userName }}</ta-link>\n              </ta-title>\n            </div>\n            <div class=\"pt-space-xs align-center\">\n              <ta-title class=\"m-a\" [level]=\"3\">\n                {{ currentUser.phoneNumber }}\n              </ta-title>\n            </div>\n            @if (currentUser.tenantInformations.length === 1) {\n              <div class=\"align-center\">\n                <ta-title class=\"m-a\" [level]=\"3\">\n                  {{ 'user.clientnumber' | translate }}\n                  {{ currentUser.tenantInformations[0].customerId }}\n                </ta-title>\n              </div>\n            }\n            @if (currentUser.tenantInformations.length > 1) {\n              <div>\n                <div class=\"pt-space-xxl align-center\">\n                  <ta-title class=\"m-a\" [level]=\"3\">\n                    {{ 'user.tenantlisttitle' | translate }}\n                  </ta-title>\n                </div>\n                <div class=\"list\">\n                  <div class=\"tenant-list\">\n                    <ta-list-container>\n                      @for (tenantInformation of currentUser.tenantInformations; track tenantInformation) {\n                        <ta-list-element [withSeparator]=\"false\">\n                          <ta-list-title>\n                            <div>{{ tenantInformation.tenantName }}</div>\n                          </ta-list-title>\n                          <ta-list-extra-information>\n                            @if (tenantInformation.customerId) {\n                              <div class=\"align-center\">\n                                <div class=\"mr-space-sm\">\n                                  {{ tenantInformation.customerId }}\n                                </div>\n                                <!-- <ta-text-to-clipboard [value]=\"tenantInformation.customerId.toString()\" ></ta-text-to-clipboard> -->\n                              </div>\n                            }\n                          </ta-list-extra-information>\n                        </ta-list-element>\n                      }\n                    </ta-list-container>\n                  </div>\n                </div>\n              </div>\n            }\n          </div>\n        </ta-ui-profile-display>\n      }\n    </ta-empty>\n  </ta-error>\n</ta-loader>\n", styles: [".text{font-size:var(--ta-font-key-key-default-size);line-height:var(--ta-font-key-key-default-line);font-weight:var(--ta-font-key-key-default-weight);display:flex;justify-content:center;line-height:32px}.list{display:flex;justify-content:center}.list .tenant-list{min-width:240px}\n"], dependencies: [{ kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "component", type: TitleComponent, selector: "ta-title", inputs: ["level", "isTheme", "isBold"] }, { kind: "component", type: ListContainerComponent, selector: "ta-list-container" }, { kind: "component", type: ListElementComponent, selector: "ta-list-element", inputs: ["withSeparator", "flexColumn"], outputs: ["action"] }, { kind: "component", type: ListTitleComponent, selector: "ta-list-title" }, { kind: "component", type: ListExtraInformationComponent, selector: "ta-list-extra-information" }, { kind: "component", type: LoaderComponent, selector: "ta-loader", inputs: ["isLoading", "skeleton"] }, { kind: "component", type: ErrorComponent, selector: "ta-error", inputs: ["message", "code"] }, { kind: "component", type: EmptyComponent, selector: "ta-empty", inputs: ["isEmpty", "isLight", "showMessage", "text", "type", "icon", "iconSize"] }, { kind: "component", type: UiProfileDisplayComponent, selector: "ta-ui-profile-display", inputs: ["label", "userLogo", "ctas", "sideIcon"] }, { kind: "component", type: LinkComponent, selector: "ta-link", inputs: ["state", "underline", "bold", "size", "icon"], outputs: ["action"] }, { kind: "pipe", type: TranslatePipe, name: "translate" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: UserMyProfileComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ta-user-my-profile', standalone: true, imports: [
                        NgIf,
                        NgFor,
                        AsyncPipe,
                        TitleComponent,
                        ListContainerComponent,
                        ListElementComponent,
                        ListTitleComponent,
                        ListExtraInformationComponent,
                        LoaderComponent,
                        ErrorComponent,
                        EmptyComponent,
                        UiProfileDisplayComponent,
                        LinkComponent,
                        TranslatePipe,
                    ], template: "<ta-loader [isLoading]=\"this.requestState.isLoading()\" *ngLet=\"this.currentUser$ | async as currentUser\">\n  <ta-error [message]=\"this.requestState.getErrorMessage()\" [code]=\"this.requestState.getErrorStatus()\">\n    <ta-empty [isEmpty]=\"!currentUser\">\n      @if (currentUser) {\n        <ta-ui-profile-display\n          [label]=\"this.getFullName(currentUser.firstName, currentUser.lastName)\"\n          [ctas]=\"this.canModify ? this.ctas : null\"\n          [userLogo]=\"this.getUserLogo(currentUser)\"\n        >\n          <div class=\"pt-space-xxl\">\n            <div class=\"pt-space-xs align-center\">\n              <ta-title class=\"m-a\" [level]=\"3\">\n                <ta-link (action)=\"this.mailTo(currentUser.userName)\">{{ currentUser.userName }}</ta-link>\n              </ta-title>\n            </div>\n            <div class=\"pt-space-xs align-center\">\n              <ta-title class=\"m-a\" [level]=\"3\">\n                {{ currentUser.phoneNumber }}\n              </ta-title>\n            </div>\n            @if (currentUser.tenantInformations.length === 1) {\n              <div class=\"align-center\">\n                <ta-title class=\"m-a\" [level]=\"3\">\n                  {{ 'user.clientnumber' | translate }}\n                  {{ currentUser.tenantInformations[0].customerId }}\n                </ta-title>\n              </div>\n            }\n            @if (currentUser.tenantInformations.length > 1) {\n              <div>\n                <div class=\"pt-space-xxl align-center\">\n                  <ta-title class=\"m-a\" [level]=\"3\">\n                    {{ 'user.tenantlisttitle' | translate }}\n                  </ta-title>\n                </div>\n                <div class=\"list\">\n                  <div class=\"tenant-list\">\n                    <ta-list-container>\n                      @for (tenantInformation of currentUser.tenantInformations; track tenantInformation) {\n                        <ta-list-element [withSeparator]=\"false\">\n                          <ta-list-title>\n                            <div>{{ tenantInformation.tenantName }}</div>\n                          </ta-list-title>\n                          <ta-list-extra-information>\n                            @if (tenantInformation.customerId) {\n                              <div class=\"align-center\">\n                                <div class=\"mr-space-sm\">\n                                  {{ tenantInformation.customerId }}\n                                </div>\n                                <!-- <ta-text-to-clipboard [value]=\"tenantInformation.customerId.toString()\" ></ta-text-to-clipboard> -->\n                              </div>\n                            }\n                          </ta-list-extra-information>\n                        </ta-list-element>\n                      }\n                    </ta-list-container>\n                  </div>\n                </div>\n              </div>\n            }\n          </div>\n        </ta-ui-profile-display>\n      }\n    </ta-empty>\n  </ta-error>\n</ta-loader>\n", styles: [".text{font-size:var(--ta-font-key-key-default-size);line-height:var(--ta-font-key-key-default-line);font-weight:var(--ta-font-key-key-default-weight);display:flex;justify-content:center;line-height:32px}.list{display:flex;justify-content:center}.list .tenant-list{min-width:240px}\n"] }]
        }], ctorParameters: () => [{ type: i1.TaUsersService }], propDecorators: { canModify: [{
                type: Input
            }], modifyAction: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci1teS1wcm9maWxlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvbW9kdWxlcy91c2VyL2NvbXBvbmVudHMvbXktcHJvZmlsZS91c2VyLW15LXByb2ZpbGUuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9tb2R1bGVzL3VzZXIvY29tcG9uZW50cy9teS1wcm9maWxlL3VzZXItbXktcHJvZmlsZS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUV6RCxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXZFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNoRCxPQUFPLEVBQ0wsY0FBYyxFQUNkLGNBQWMsRUFDZCxhQUFhLEVBQ2Isc0JBQXNCLEVBQ3RCLG9CQUFvQixFQUNwQiw2QkFBNkIsRUFDN0Isa0JBQWtCLEVBQ2xCLGVBQWUsRUFDZixjQUFjLEVBQ2QseUJBQXlCLEdBQzFCLE1BQU0sUUFBUSxDQUFDO0FBQ2hCLE9BQU8sRUFBRSxlQUFlLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxNQUFNLFdBQVcsQ0FBQzs7O0FBMkJoRSxNQUFNLE9BQU8sc0JBQXVCLFNBQVEsZUFBZTtJQWdCekQsSUFBSSxZQUFZO1FBQ2QsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUM5QyxDQUFDO0lBQ0QsWUFBb0IsWUFBNEI7UUFDOUMsS0FBSyxFQUFFLENBQUM7UUFEVSxpQkFBWSxHQUFaLFlBQVksQ0FBZ0I7UUFqQmhELGNBQVMsR0FBWSxJQUFJLENBQUM7UUFHMUIsaUJBQVksR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRWxCLFdBQU0sR0FBRyxRQUFRLENBQUM7UUFFM0IsU0FBSSxHQUFHO1lBQ1o7Z0JBQ0UsSUFBSSxFQUFFLFFBQVE7Z0JBQ2QsS0FBSyxFQUFFLGFBQWE7Z0JBQ3BCLFFBQVEsRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFO2FBQ3RDO1NBQ0YsQ0FBQztRQU1BLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNoQixDQUFDO0lBRU0sV0FBVyxDQUFDLFNBQWlCLEVBQUUsUUFBZ0I7UUFDcEQsT0FBTyxRQUFRLENBQUMsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDO0lBQzVELENBQUM7SUFFTSxXQUFXLENBQUMsSUFBVTtRQUMzQixPQUFPO1lBQ0wsUUFBUSxFQUFFO2dCQUNSLGlCQUFpQixFQUFFLElBQUksQ0FBQyxPQUFPO2dCQUMvQixNQUFNLEVBQUU7b0JBQ04sSUFBSSxFQUFFLElBQUksQ0FBQyxRQUFRO29CQUNuQixTQUFTLEVBQUUsSUFBSSxDQUFDLFNBQVM7b0JBQ3pCLE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTztpQkFDdEI7YUFDRjtTQUNGLENBQUM7SUFDSixDQUFDO0lBRU8sTUFBTTtRQUNaLElBQUksQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDMUIsSUFBSSxDQUFDLFlBQVksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLFNBQVMsQ0FBQztZQUM5QyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLEVBQUU7WUFDN0MsS0FBSyxFQUFFLENBQUMsS0FBd0IsRUFBRSxFQUFFO2dCQUNsQyxJQUFJLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUM1RCxDQUFDO1NBQ0YsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVPLGNBQWM7UUFDcEIsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUMzQixDQUFDOytHQXJEVSxzQkFBc0I7bUdBQXRCLHNCQUFzQixvTEM1Q25DLGlpR0FrRUEsK1VEcENJLFNBQVMsOENBQ1QsY0FBYyw2RkFDZCxzQkFBc0IsOERBQ3RCLG9CQUFvQiwwSEFDcEIsa0JBQWtCLDBEQUNsQiw2QkFBNkIsc0VBQzdCLGVBQWUseUZBQ2YsY0FBYyxrRkFDZCxjQUFjLHdJQUNkLHlCQUF5QixxSEFDekIsYUFBYSw0SEFDYixhQUFhOzs0RkFHSixzQkFBc0I7a0JBdEJsQyxTQUFTOytCQUNFLG9CQUFvQixjQUdsQixJQUFJLFdBQ1A7d0JBQ1AsSUFBSTt3QkFDSixLQUFLO3dCQUNMLFNBQVM7d0JBQ1QsY0FBYzt3QkFDZCxzQkFBc0I7d0JBQ3RCLG9CQUFvQjt3QkFDcEIsa0JBQWtCO3dCQUNsQiw2QkFBNkI7d0JBQzdCLGVBQWU7d0JBQ2YsY0FBYzt3QkFDZCxjQUFjO3dCQUNkLHlCQUF5Qjt3QkFDekIsYUFBYTt3QkFDYixhQUFhO3FCQUNkO21GQUlELFNBQVM7c0JBRFIsS0FBSztnQkFJTixZQUFZO3NCQURYLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBc3luY1BpcGUsIE5nRm9yLCBOZ0lmIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IEh0dHBFcnJvclJlc3BvbnNlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgVHJhbnNsYXRlUGlwZSB9IGZyb20gJ0B0YS90cmFuc2xhdGlvbic7XG5pbXBvcnQge1xuICBFbXB0eUNvbXBvbmVudCxcbiAgRXJyb3JDb21wb25lbnQsXG4gIExpbmtDb21wb25lbnQsXG4gIExpc3RDb250YWluZXJDb21wb25lbnQsXG4gIExpc3RFbGVtZW50Q29tcG9uZW50LFxuICBMaXN0RXh0cmFJbmZvcm1hdGlvbkNvbXBvbmVudCxcbiAgTGlzdFRpdGxlQ29tcG9uZW50LFxuICBMb2FkZXJDb21wb25lbnQsXG4gIFRpdGxlQ29tcG9uZW50LFxuICBVaVByb2ZpbGVEaXNwbGF5Q29tcG9uZW50LFxufSBmcm9tICdAdGEvdWknO1xuaW1wb3J0IHsgVGFCYXNlQ29tcG9uZW50LCBmdWxsTmFtZSwgc2VuZE1haWwgfSBmcm9tICdAdGEvdXRpbHMnO1xuXG5pbXBvcnQgeyBUYVVzZXJzU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3VzZXJzLnNlcnZpY2UnO1xuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3VzZXJzL2R0by91c2VyJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGEtdXNlci1teS1wcm9maWxlJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3VzZXItbXktcHJvZmlsZS5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3VzZXItbXktcHJvZmlsZS5jb21wb25lbnQuc2NzcyddLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgTmdJZixcbiAgICBOZ0ZvcixcbiAgICBBc3luY1BpcGUsXG4gICAgVGl0bGVDb21wb25lbnQsXG4gICAgTGlzdENvbnRhaW5lckNvbXBvbmVudCxcbiAgICBMaXN0RWxlbWVudENvbXBvbmVudCxcbiAgICBMaXN0VGl0bGVDb21wb25lbnQsXG4gICAgTGlzdEV4dHJhSW5mb3JtYXRpb25Db21wb25lbnQsXG4gICAgTG9hZGVyQ29tcG9uZW50LFxuICAgIEVycm9yQ29tcG9uZW50LFxuICAgIEVtcHR5Q29tcG9uZW50LFxuICAgIFVpUHJvZmlsZURpc3BsYXlDb21wb25lbnQsXG4gICAgTGlua0NvbXBvbmVudCxcbiAgICBUcmFuc2xhdGVQaXBlLFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBVc2VyTXlQcm9maWxlQ29tcG9uZW50IGV4dGVuZHMgVGFCYXNlQ29tcG9uZW50IHtcbiAgQElucHV0KClcbiAgY2FuTW9kaWZ5OiBib29sZWFuID0gdHJ1ZTtcblxuICBAT3V0cHV0KClcbiAgbW9kaWZ5QWN0aW9uID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIHB1YmxpYyByZWFkb25seSBtYWlsVG8gPSBzZW5kTWFpbDtcblxuICBwdWJsaWMgY3RhcyA9IFtcbiAgICB7XG4gICAgICBpY29uOiAnbW9kaWZ5JyxcbiAgICAgIGxhYmVsOiAndXNlci5tb2RpZnknLFxuICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMuX21vZGlmeVByb2ZpbGUoKSxcbiAgICB9LFxuICBdO1xuICBnZXQgY3VycmVudFVzZXIkKCkge1xuICAgIHJldHVybiB0aGlzLl91c2VyU2VydmljZS5jdXJyZW50VXNlci5nZXQkKCk7XG4gIH1cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBfdXNlclNlcnZpY2U6IFRhVXNlcnNTZXJ2aWNlKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9mZXRjaCgpO1xuICB9XG5cbiAgcHVibGljIGdldEZ1bGxOYW1lKGZpcnN0TmFtZTogc3RyaW5nLCBsYXN0TmFtZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGZ1bGxOYW1lKHsgZmlyc3ROYW1lOiBmaXJzdE5hbWUsIG5hbWU6IGxhc3ROYW1lIH0pO1xuICB9XG5cbiAgcHVibGljIGdldFVzZXJMb2dvKHVzZXI6IFVzZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdXNlckluZm86IHtcbiAgICAgICAgcHJvZmlsZVBpY3R1cmVVcmw6IHVzZXIucGljdHVyZSxcbiAgICAgICAgbmFtaW5nOiB7XG4gICAgICAgICAgbmFtZTogdXNlci5sYXN0TmFtZSxcbiAgICAgICAgICBmaXJzdE5hbWU6IHVzZXIuZmlyc3ROYW1lLFxuICAgICAgICAgIHRyaWdyYW06IHVzZXIudHJpZ3JhbSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgX2ZldGNoKCkge1xuICAgIHRoaXMucmVxdWVzdFN0YXRlLmFza2VkKCk7XG4gICAgdGhpcy5fdXNlclNlcnZpY2UuZmV0Y2hDdXJyZW50VXNlciQoKS5zdWJzY3JpYmUoe1xuICAgICAgY29tcGxldGU6ICgpID0+IHRoaXMucmVxdWVzdFN0YXRlLmNvbXBsZXRlZCgpLFxuICAgICAgZXJyb3I6IChlcnJvcjogSHR0cEVycm9yUmVzcG9uc2UpID0+IHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0U3RhdGUub25FcnJvcihlcnJvci5zdGF0dXMsIGVycm9yLnN0YXR1c1RleHQpO1xuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX21vZGlmeVByb2ZpbGUoKSB7XG4gICAgdGhpcy5tb2RpZnlBY3Rpb24uZW1pdCgpO1xuICB9XG59XG4iLCI8dGEtbG9hZGVyIFtpc0xvYWRpbmddPVwidGhpcy5yZXF1ZXN0U3RhdGUuaXNMb2FkaW5nKClcIiAqbmdMZXQ9XCJ0aGlzLmN1cnJlbnRVc2VyJCB8IGFzeW5jIGFzIGN1cnJlbnRVc2VyXCI+XG4gIDx0YS1lcnJvciBbbWVzc2FnZV09XCJ0aGlzLnJlcXVlc3RTdGF0ZS5nZXRFcnJvck1lc3NhZ2UoKVwiIFtjb2RlXT1cInRoaXMucmVxdWVzdFN0YXRlLmdldEVycm9yU3RhdHVzKClcIj5cbiAgICA8dGEtZW1wdHkgW2lzRW1wdHldPVwiIWN1cnJlbnRVc2VyXCI+XG4gICAgICBAaWYgKGN1cnJlbnRVc2VyKSB7XG4gICAgICAgIDx0YS11aS1wcm9maWxlLWRpc3BsYXlcbiAgICAgICAgICBbbGFiZWxdPVwidGhpcy5nZXRGdWxsTmFtZShjdXJyZW50VXNlci5maXJzdE5hbWUsIGN1cnJlbnRVc2VyLmxhc3ROYW1lKVwiXG4gICAgICAgICAgW2N0YXNdPVwidGhpcy5jYW5Nb2RpZnkgPyB0aGlzLmN0YXMgOiBudWxsXCJcbiAgICAgICAgICBbdXNlckxvZ29dPVwidGhpcy5nZXRVc2VyTG9nbyhjdXJyZW50VXNlcilcIlxuICAgICAgICA+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInB0LXNwYWNlLXh4bFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInB0LXNwYWNlLXhzIGFsaWduLWNlbnRlclwiPlxuICAgICAgICAgICAgICA8dGEtdGl0bGUgY2xhc3M9XCJtLWFcIiBbbGV2ZWxdPVwiM1wiPlxuICAgICAgICAgICAgICAgIDx0YS1saW5rIChhY3Rpb24pPVwidGhpcy5tYWlsVG8oY3VycmVudFVzZXIudXNlck5hbWUpXCI+e3sgY3VycmVudFVzZXIudXNlck5hbWUgfX08L3RhLWxpbms+XG4gICAgICAgICAgICAgIDwvdGEtdGl0bGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwdC1zcGFjZS14cyBhbGlnbi1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgPHRhLXRpdGxlIGNsYXNzPVwibS1hXCIgW2xldmVsXT1cIjNcIj5cbiAgICAgICAgICAgICAgICB7eyBjdXJyZW50VXNlci5waG9uZU51bWJlciB9fVxuICAgICAgICAgICAgICA8L3RhLXRpdGxlPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICBAaWYgKGN1cnJlbnRVc2VyLnRlbmFudEluZm9ybWF0aW9ucy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFsaWduLWNlbnRlclwiPlxuICAgICAgICAgICAgICAgIDx0YS10aXRsZSBjbGFzcz1cIm0tYVwiIFtsZXZlbF09XCIzXCI+XG4gICAgICAgICAgICAgICAgICB7eyAndXNlci5jbGllbnRudW1iZXInIHwgdHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgICAgICB7eyBjdXJyZW50VXNlci50ZW5hbnRJbmZvcm1hdGlvbnNbMF0uY3VzdG9tZXJJZCB9fVxuICAgICAgICAgICAgICAgIDwvdGEtdGl0bGU+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQGlmIChjdXJyZW50VXNlci50ZW5hbnRJbmZvcm1hdGlvbnMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwdC1zcGFjZS14eGwgYWxpZ24tY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICA8dGEtdGl0bGUgY2xhc3M9XCJtLWFcIiBbbGV2ZWxdPVwiM1wiPlxuICAgICAgICAgICAgICAgICAgICB7eyAndXNlci50ZW5hbnRsaXN0dGl0bGUnIHwgdHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgICAgICA8L3RhLXRpdGxlPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaXN0XCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGVuYW50LWxpc3RcIj5cbiAgICAgICAgICAgICAgICAgICAgPHRhLWxpc3QtY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgIEBmb3IgKHRlbmFudEluZm9ybWF0aW9uIG9mIGN1cnJlbnRVc2VyLnRlbmFudEluZm9ybWF0aW9uczsgdHJhY2sgdGVuYW50SW5mb3JtYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0YS1saXN0LWVsZW1lbnQgW3dpdGhTZXBhcmF0b3JdPVwiZmFsc2VcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhLWxpc3QtdGl0bGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj57eyB0ZW5hbnRJbmZvcm1hdGlvbi50ZW5hbnROYW1lIH19PC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGEtbGlzdC10aXRsZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhLWxpc3QtZXh0cmEtaW5mb3JtYXRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQGlmICh0ZW5hbnRJbmZvcm1hdGlvbi5jdXN0b21lcklkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYWxpZ24tY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtci1zcGFjZS1zbVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7IHRlbmFudEluZm9ybWF0aW9uLmN1c3RvbWVySWQgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gPHRhLXRleHQtdG8tY2xpcGJvYXJkIFt2YWx1ZV09XCJ0ZW5hbnRJbmZvcm1hdGlvbi5jdXN0b21lcklkLnRvU3RyaW5nKClcIiA+PC90YS10ZXh0LXRvLWNsaXBib2FyZD4gLS0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGEtbGlzdC1leHRyYS1pbmZvcm1hdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGEtbGlzdC1lbGVtZW50PlxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgPC90YS1saXN0LWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC90YS11aS1wcm9maWxlLWRpc3BsYXk+XG4gICAgICB9XG4gICAgPC90YS1lbXB0eT5cbiAgPC90YS1lcnJvcj5cbjwvdGEtbG9hZGVyPlxuIl19