import { AsyncPipe, NgFor } from '@angular/common';
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { tap } from 'rxjs';
import { EmptyComponent, ErrorComponent, LoaderComponent } from '@ta/ui';
import { TaBaseComponent } from '@ta/utils';
import { InvoicePaymentStatusChangedComponent } from '../items/item/template/invoice-payment-status-changed/invoice-payment-status-changed.component';
import { NewInvoiceComponent } from '../items/item/template/new-invoice/new-invoice.component';
import { NewQuotationVersionComponent } from '../items/item/template/new-quotation-version/new-quotation-version.component';
import { ProjectStatusChangedComponent } from '../items/item/template/project-status-changed/project-status-changed.component';
import { TaskAssignedComponent } from '../items/item/template/task-assigned/task-assigned.component';
import { TaskDueTodayComponent } from '../items/item/template/task-due-today/task-due-today.component';
import { TaskNewActivityComponent } from '../items/item/template/task-new-activity/task-new-activity.component';
import { ToDoAssignedComponent } from '../items/item/template/to-do-assigned/to-do-assigned.component';
import { ToDoDueTodayComponent } from '../items/item/template/to-do-due-today/to-do-due-today.component';
import { UserTaggedInConversationComponent } from '../items/item/template/user-tagged-in-conversation/user-tagged-in-conversation.component';
import * as i0 from "@angular/core";
import * as i1 from "../../services/data.service";
import * as i2 from "../../services/shared.service";
export class ContainerComponent extends TaBaseComponent {
    get notifications$() {
        return this._notificationDataService.list
            .get$(this._notificationDataService.computeKey(this.filters))
            .pipe(tap(list => this.nbChanged.emit(list.length)));
    }
    constructor(_notificationDataService, _sharedService) {
        super();
        this._notificationDataService = _notificationDataService;
        this._sharedService = _sharedService;
        this.filters = null;
        this.templates = null;
        this.services = null;
        this.routing = null;
        this.nbChanged = new EventEmitter();
    }
    ngOnInit() {
        this.requestState.asked();
        this._registerSubscription(this._notificationDataService.fetchNotifications$(this.filters).subscribe({
            complete: () => this.requestState.completed(),
            error: (error) => {
                this.requestState.onError(error.status, error.statusText);
            },
        }));
        if (this.templates) {
            this._sharedService.paymentStatusTemplate = this.templates?.paymentStatus;
            this._sharedService.projectStatusTemplate = this.templates?.projectStatus;
        }
        if (this.services) {
            this._sharedService.getProjects$ = this.services.getProjects$;
        }
        if (this.routing) {
            this._sharedService.routing = this.routing;
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: ContainerComponent, deps: [{ token: i1.TaNotificationDataService }, { token: i2.TaNotificationSharedService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.14", type: ContainerComponent, isStandalone: true, selector: "ta-notification-container", inputs: { filters: "filters", templates: "templates", services: "services", routing: "routing" }, outputs: { nbChanged: "nbChanged" }, usesInheritance: true, ngImport: i0, template: "<ta-loader [isLoading]=\"this.requestState.isLoading()\" *ngLet=\"this.notifications$ | async as notifications\">\n  <ta-error [message]=\"this.requestState.getErrorMessage()\" [code]=\"this.requestState.getErrorStatus()\">\n    <ta-empty\n      [isEmpty]=\"!notifications || notifications.length === 0\"\n      icon=\"ghost\"\n      [isLight]=\"false\"\n      text=\"notification.empty\"\n    >\n      <div class=\"notification-container\">\n        @for (notif of this.notifications; track notif) {\n          <div class=\"item-container c-pointer\">\n            @switch (notif.type) {\n              @case ('ProjectStatusChanged') {\n                <ta-notification-project-status-changed [notification]=\"notif\"></ta-notification-project-status-changed>\n              }\n              @case ('NewQuotationVersion') {\n                <ta-new-quotation-version [notification]=\"notif\"></ta-new-quotation-version>\n              }\n              @case ('NewInvoice') {\n                <ta-new-invoice [notification]=\"notif\"></ta-new-invoice>\n              }\n              @case ('InvoicePaymentStatusChanged') {\n                <ta-invoice-payment-status-changed [notification]=\"notif\"></ta-invoice-payment-status-changed>\n              }\n              @case ('TaskAssigned') {\n                <ta-task-assigned [notification]=\"notif\"></ta-task-assigned>\n              }\n              @case ('ToDoAssigned') {\n                <ta-to-do-assigned [notification]=\"notif\"></ta-to-do-assigned>\n              }\n              @case ('TaskDueToday') {\n                <ta-task-due-today [notification]=\"notif\"></ta-task-due-today>\n              }\n              @case ('ToDoDueToday') {\n                <ta-to-do-due-today [notification]=\"notif\"></ta-to-do-due-today>\n              }\n              @case ('TaskNewActivity') {\n                <ta-task-new-activity [notification]=\"notif\"></ta-task-new-activity>\n              }\n              @case ('UserTaggedInConversation') {\n                <ta-user-tagged-in-conversation [notification]=\"notif\"></ta-user-tagged-in-conversation>\n              }\n            }\n          </div>\n        }\n      </div>\n    </ta-empty>\n  </ta-error>\n</ta-loader>\n", styles: [".item-container{border-bottom:1px solid var(--ta-border-primary)}\n"], dependencies: [{ kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "component", type: EmptyComponent, selector: "ta-empty", inputs: ["isEmpty", "isLight", "showMessage", "text", "type", "icon", "iconSize"] }, { kind: "component", type: ErrorComponent, selector: "ta-error", inputs: ["message", "code"] }, { kind: "component", type: InvoicePaymentStatusChangedComponent, selector: "ta-invoice-payment-status-changed" }, { kind: "component", type: LoaderComponent, selector: "ta-loader", inputs: ["isLoading", "skeleton", "size", "text"] }, { kind: "component", type: NewInvoiceComponent, selector: "ta-new-invoice" }, { kind: "component", type: NewQuotationVersionComponent, selector: "ta-new-quotation-version" }, { kind: "component", type: ProjectStatusChangedComponent, selector: "ta-notification-project-status-changed" }, { kind: "component", type: TaskAssignedComponent, selector: "ta-task-assigned" }, { kind: "component", type: TaskDueTodayComponent, selector: "ta-task-due-today" }, { kind: "component", type: TaskNewActivityComponent, selector: "ta-task-new-activity" }, { kind: "component", type: ToDoAssignedComponent, selector: "ta-to-do-assigned" }, { kind: "component", type: ToDoDueTodayComponent, selector: "ta-to-do-due-today" }, { kind: "component", type: UserTaggedInConversationComponent, selector: "ta-user-tagged-in-conversation" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: ContainerComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ta-notification-container', standalone: true, imports: [
                        AsyncPipe,
                        EmptyComponent,
                        ErrorComponent,
                        InvoicePaymentStatusChangedComponent,
                        LoaderComponent,
                        NewInvoiceComponent,
                        NewQuotationVersionComponent,
                        NgFor,
                        ProjectStatusChangedComponent,
                        TaskAssignedComponent,
                        TaskDueTodayComponent,
                        TaskNewActivityComponent,
                        ToDoAssignedComponent,
                        ToDoDueTodayComponent,
                        UserTaggedInConversationComponent,
                    ], template: "<ta-loader [isLoading]=\"this.requestState.isLoading()\" *ngLet=\"this.notifications$ | async as notifications\">\n  <ta-error [message]=\"this.requestState.getErrorMessage()\" [code]=\"this.requestState.getErrorStatus()\">\n    <ta-empty\n      [isEmpty]=\"!notifications || notifications.length === 0\"\n      icon=\"ghost\"\n      [isLight]=\"false\"\n      text=\"notification.empty\"\n    >\n      <div class=\"notification-container\">\n        @for (notif of this.notifications; track notif) {\n          <div class=\"item-container c-pointer\">\n            @switch (notif.type) {\n              @case ('ProjectStatusChanged') {\n                <ta-notification-project-status-changed [notification]=\"notif\"></ta-notification-project-status-changed>\n              }\n              @case ('NewQuotationVersion') {\n                <ta-new-quotation-version [notification]=\"notif\"></ta-new-quotation-version>\n              }\n              @case ('NewInvoice') {\n                <ta-new-invoice [notification]=\"notif\"></ta-new-invoice>\n              }\n              @case ('InvoicePaymentStatusChanged') {\n                <ta-invoice-payment-status-changed [notification]=\"notif\"></ta-invoice-payment-status-changed>\n              }\n              @case ('TaskAssigned') {\n                <ta-task-assigned [notification]=\"notif\"></ta-task-assigned>\n              }\n              @case ('ToDoAssigned') {\n                <ta-to-do-assigned [notification]=\"notif\"></ta-to-do-assigned>\n              }\n              @case ('TaskDueToday') {\n                <ta-task-due-today [notification]=\"notif\"></ta-task-due-today>\n              }\n              @case ('ToDoDueToday') {\n                <ta-to-do-due-today [notification]=\"notif\"></ta-to-do-due-today>\n              }\n              @case ('TaskNewActivity') {\n                <ta-task-new-activity [notification]=\"notif\"></ta-task-new-activity>\n              }\n              @case ('UserTaggedInConversation') {\n                <ta-user-tagged-in-conversation [notification]=\"notif\"></ta-user-tagged-in-conversation>\n              }\n            }\n          </div>\n        }\n      </div>\n    </ta-empty>\n  </ta-error>\n</ta-loader>\n", styles: [".item-container{border-bottom:1px solid var(--ta-border-primary)}\n"] }]
        }], ctorParameters: () => [{ type: i1.TaNotificationDataService }, { type: i2.TaNotificationSharedService }], propDecorators: { filters: [{
                type: Input
            }], templates: [{
                type: Input
            }], services: [{
                type: Input
            }], routing: [{
                type: Input
            }], nbChanged: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGFpbmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9jb250YWluZXIvY29udGFpbmVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9jb250YWluZXIvY29udGFpbmVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFbkQsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFVLE1BQU0sRUFBZSxNQUFNLGVBQWUsQ0FBQztBQUU1RixPQUFPLEVBQWMsR0FBRyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRXZDLE9BQU8sRUFBRSxjQUFjLEVBQUUsY0FBYyxFQUFFLGVBQWUsRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUN6RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBSzVDLE9BQU8sRUFBRSxvQ0FBb0MsRUFBRSxNQUFNLGdHQUFnRyxDQUFDO0FBQ3RKLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBEQUEwRCxDQUFDO0FBQy9GLE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLDhFQUE4RSxDQUFDO0FBQzVILE9BQU8sRUFBRSw2QkFBNkIsRUFBRSxNQUFNLGdGQUFnRixDQUFDO0FBQy9ILE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDhEQUE4RCxDQUFDO0FBQ3JHLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGdFQUFnRSxDQUFDO0FBQ3ZHLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLHNFQUFzRSxDQUFDO0FBQ2hILE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGdFQUFnRSxDQUFDO0FBQ3ZHLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGtFQUFr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QUF3Qjt3QkFDeEIscUJBQXFCO3dCQUNyQixxQkFBcUI7d0JBQ3JCLGlDQUFpQztxQkFDbEM7d0lBSUQsT0FBTztzQkFETixLQUFLO2dCQUlOLFNBQVM7c0JBRFIsS0FBSztnQkFPTixRQUFRO3NCQURQLEtBQUs7Z0JBTU4sT0FBTztzQkFETixLQUFLO2dCQUlOLFNBQVM7c0JBRFIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzeW5jUGlwZSwgTmdGb3IgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgSHR0cEVycm9yUmVzcG9uc2UgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0LCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCB0YXAgfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgRW1wdHlDb21wb25lbnQsIEVycm9yQ29tcG9uZW50LCBMb2FkZXJDb21wb25lbnQgfSBmcm9tICdAdGEvdWknO1xuaW1wb3J0IHsgVGFCYXNlQ29tcG9uZW50IH0gZnJvbSAnQHRhL3V0aWxzJztcblxuaW1wb3J0IHsgVGFOb3RpZmljYXRpb25EYXRhU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2RhdGEuc2VydmljZSc7XG5pbXBvcnQgeyBOb3RpZmljYXRpb25GaWx0ZXIgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9xdWVyaWVzJztcbmltcG9ydCB7IFJvdXRpbmdUeXBlLCBUYU5vdGlmaWNhdGlvblNoYXJlZFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9zaGFyZWQuc2VydmljZSc7XG5pbXBvcnQgeyBJbnZvaWNlUGF5bWVudFN0YXR1c0NoYW5nZWRDb21wb25lbnQgfSBmcm9tICcuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL2ludm9pY2UtcGF5bWVudC1zdGF0dXMtY2hhbmdlZC9pbnZvaWNlLXBheW1lbnQtc3RhdHVzLWNoYW5nZWQuY29tcG9uZW50JztcbmltcG9ydCB7IE5ld0ludm9pY2VDb21wb25lbnQgfSBmcm9tICcuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL25ldy1pbnZvaWNlL25ldy1pbnZvaWNlLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBOZXdRdW90YXRpb25WZXJzaW9uQ29tcG9uZW50IH0gZnJvbSAnLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS9uZXctcXVvdGF0aW9uLXZlcnNpb24vbmV3LXF1b3RhdGlvbi12ZXJzaW9uLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBQcm9qZWN0U3RhdHVzQ2hhbmdlZENvbXBvbmVudCB9IGZyb20gJy4uL2l0ZW1zL2l0ZW0vdGVtcGxhdGUvcHJvamVjdC1zdGF0dXMtY2hhbmdlZC9wcm9qZWN0LXN0YXR1cy1jaGFuZ2VkLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBUYXNrQXNzaWduZWRDb21wb25lbnQgfSBmcm9tICcuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3Rhc2stYXNzaWduZWQvdGFzay1hc3NpZ25lZC5jb21wb25lbnQnO1xuaW1wb3J0IHsgVGFza0R1ZVRvZGF5Q29tcG9uZW50IH0gZnJvbSAnLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS90YXNrLWR1ZS10b2RheS90YXNrLWR1ZS10b2RheS5jb21wb25lbnQnO1xuaW1wb3J0IHsgVGFza05ld0FjdGl2aXR5Q29tcG9uZW50IH0gZnJvbSAnLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS90YXNrLW5ldy1hY3Rpdml0eS90YXNrLW5ldy1hY3Rpdml0eS5jb21wb25lbnQnO1xuaW1wb3J0IHsgVG9Eb0Fzc2lnbmVkQ29tcG9uZW50IH0gZnJvbSAnLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS90by1kby1hc3NpZ25lZC90by1kby1hc3NpZ25lZC5jb21wb25lbnQnO1xuaW1wb3J0IHsgVG9Eb0R1ZVRvZGF5Q29tcG9uZW50IH0gZnJvbSAnLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS90by1kby1kdWUtdG9kYXkvdG8tZG8tZHVlLXRvZGF5LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBVc2VyVGFnZ2VkSW5Db252ZXJzYXRpb25Db21wb25lbnQgfSBmcm9tICcuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3VzZXItdGFnZ2VkLWluLWNvbnZlcnNhdGlvbi91c2VyLXRhZ2dlZC1pbi1jb252ZXJzYXRpb24uY29tcG9uZW50JztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGEtbm90aWZpY2F0aW9uLWNvbnRhaW5lcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9jb250YWluZXIuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9jb250YWluZXIuY29tcG9uZW50LnNjc3MnXSxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW1xuICAgIEFzeW5jUGlwZSxcbiAgICBFbXB0eUNvbXBvbmVudCxcbiAgICBFcnJvckNvbXBvbmVudCxcbiAgICBJbnZvaWNlUGF5bWVudFN0YXR1c0NoYW5nZWRDb21wb25lbnQsXG4gICAgTG9hZGVyQ29tcG9uZW50LFxuICAgIE5ld0ludm9pY2VDb21wb25lbnQsXG4gICAgTmV3UXVvdGF0aW9uVmVyc2lvbkNvbXBvbmVudCxcbiAgICBOZ0ZvcixcbiAgICBQcm9qZWN0U3RhdHVzQ2hhbmdlZENvbXBvbmVudCxcbiAgICBUYXNrQXNzaWduZWRDb21wb25lbnQsXG4gICAgVGFza0R1ZVRvZGF5Q29tcG9uZW50LFxuICAgIFRhc2tOZXdBY3Rpdml0eUNvbXBvbmVudCxcbiAgICBUb0RvQXNzaWduZWRDb21wb25lbnQsXG4gICAgVG9Eb0R1ZVRvZGF5Q29tcG9uZW50LFxuICAgIFVzZXJUYWdnZWRJbkNvbnZlcnNhdGlvbkNvbXBvbmVudCxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgQ29udGFpbmVyQ29tcG9uZW50IGV4dGVuZHMgVGFCYXNlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KClcbiAgZmlsdGVyczogTm90aWZpY2F0aW9uRmlsdGVyID0gbnVsbDtcblxuICBASW5wdXQoKVxuICB0ZW1wbGF0ZXM6IHtcbiAgICBwYXltZW50U3RhdHVzOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICAgIHByb2plY3RTdGF0dXM6IFRlbXBsYXRlUmVmPGFueT47XG4gIH0gfCBudWxsID0gbnVsbDtcblxuICBASW5wdXQoKVxuICBzZXJ2aWNlczoge1xuICAgIGdldFByb2plY3RzJDogKGlkczogc3RyaW5nW10pID0+IE9ic2VydmFibGU8eyBpZDogc3RyaW5nOyBuYW1lOiBzdHJpbmcgfVtdPjtcbiAgfSB8IG51bGwgPSBudWxsO1xuXG4gIEBJbnB1dCgpXG4gIHJvdXRpbmc6IHsgW2luZGV4IGluIFJvdXRpbmdUeXBlXTogKGRhdGE6IGFueSkgPT4gdm9pZCB9IHwgbnVsbCA9IG51bGw7XG5cbiAgQE91dHB1dCgpXG4gIG5iQ2hhbmdlZDogRXZlbnRFbWl0dGVyPG51bWJlcj4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgZ2V0IG5vdGlmaWNhdGlvbnMkKCkge1xuICAgIHJldHVybiB0aGlzLl9ub3RpZmljYXRpb25EYXRhU2VydmljZS5saXN0XG4gICAgICAuZ2V0JCh0aGlzLl9ub3RpZmljYXRpb25EYXRhU2VydmljZS5jb21wdXRlS2V5KHRoaXMuZmlsdGVycykpXG4gICAgICAucGlwZSh0YXAobGlzdCA9PiB0aGlzLm5iQ2hhbmdlZC5lbWl0KGxpc3QubGVuZ3RoKSkpO1xuICB9XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgX25vdGlmaWNhdGlvbkRhdGFTZXJ2aWNlOiBUYU5vdGlmaWNhdGlvbkRhdGFTZXJ2aWNlLFxuICAgIHByaXZhdGUgX3NoYXJlZFNlcnZpY2U6IFRhTm90aWZpY2F0aW9uU2hhcmVkU2VydmljZVxuICApIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5yZXF1ZXN0U3RhdGUuYXNrZWQoKTtcbiAgICB0aGlzLl9yZWdpc3RlclN1YnNjcmlwdGlvbihcbiAgICAgIHRoaXMuX25vdGlmaWNhdGlvbkRhdGFTZXJ2aWNlLmZldGNoTm90aWZpY2F0aW9ucyQodGhpcy5maWx0ZXJzKS5zdWJzY3JpYmUoe1xuICAgICAgICBjb21wbGV0ZTogKCkgPT4gdGhpcy5yZXF1ZXN0U3RhdGUuY29tcGxldGVkKCksXG4gICAgICAgIGVycm9yOiAoZXJyb3I6IEh0dHBFcnJvclJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgdGhpcy5yZXF1ZXN0U3RhdGUub25FcnJvcihlcnJvci5zdGF0dXMsIGVycm9yLnN0YXR1c1RleHQpO1xuICAgICAgICB9LFxuICAgICAgfSlcbiAgICApO1xuXG4gICAgaWYgKHRoaXMudGVtcGxhdGVzKSB7XG4gICAgICB0aGlzLl9zaGFyZWRTZXJ2aWNlLnBheW1lbnRTdGF0dXNUZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVzPy5wYXltZW50U3RhdHVzO1xuICAgICAgdGhpcy5fc2hhcmVkU2VydmljZS5wcm9qZWN0U3RhdHVzVGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcz8ucHJvamVjdFN0YXR1cztcbiAgICB9XG4gICAgaWYgKHRoaXMuc2VydmljZXMpIHtcbiAgICAgIHRoaXMuX3NoYXJlZFNlcnZpY2UuZ2V0UHJvamVjdHMkID0gdGhpcy5zZXJ2aWNlcy5nZXRQcm9qZWN0cyQ7XG4gICAgfVxuICAgIGlmICh0aGlzLnJvdXRpbmcpIHtcbiAgICAgIHRoaXMuX3NoYXJlZFNlcnZpY2Uucm91dGluZyA9IHRoaXMucm91dGluZztcbiAgICB9XG4gIH1cbn1cbiIsIjx0YS1sb2FkZXIgW2lzTG9hZGluZ109XCJ0aGlzLnJlcXVlc3RTdGF0ZS5pc0xvYWRpbmcoKVwiICpuZ0xldD1cInRoaXMubm90aWZpY2F0aW9ucyQgfCBhc3luYyBhcyBub3RpZmljYXRpb25zXCI+XG4gIDx0YS1lcnJvciBbbWVzc2FnZV09XCJ0aGlzLnJlcXVlc3RTdGF0ZS5nZXRFcnJvck1lc3NhZ2UoKVwiIFtjb2RlXT1cInRoaXMucmVxdWVzdFN0YXRlLmdldEVycm9yU3RhdHVzKClcIj5cbiAgICA8dGEtZW1wdHlcbiAgICAgIFtpc0VtcHR5XT1cIiFub3RpZmljYXRpb25zIHx8IG5vdGlmaWNhdGlvbnMubGVuZ3RoID09PSAwXCJcbiAgICAgIGljb249XCJnaG9zdFwiXG4gICAgICBbaXNMaWdodF09XCJmYWxzZVwiXG4gICAgICB0ZXh0PVwibm90aWZpY2F0aW9uLmVtcHR5XCJcbiAgICA+XG4gICAgICA8ZGl2IGNsYXNzPVwibm90aWZpY2F0aW9uLWNvbnRhaW5lclwiPlxuICAgICAgICBAZm9yIChub3RpZiBvZiB0aGlzLm5vdGlmaWNhdGlvbnM7IHRyYWNrIG5vdGlmKSB7XG4gICAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW0tY29udGFpbmVyIGMtcG9pbnRlclwiPlxuICAgICAgICAgICAgQHN3aXRjaCAobm90aWYudHlwZSkge1xuICAgICAgICAgICAgICBAY2FzZSAoJ1Byb2plY3RTdGF0dXNDaGFuZ2VkJykge1xuICAgICAgICAgICAgICAgIDx0YS1ub3RpZmljYXRpb24tcHJvamVjdC1zdGF0dXMtY2hhbmdlZCBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS1ub3RpZmljYXRpb24tcHJvamVjdC1zdGF0dXMtY2hhbmdlZD5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBAY2FzZSAoJ05ld1F1b3RhdGlvblZlcnNpb24nKSB7XG4gICAgICAgICAgICAgICAgPHRhLW5ldy1xdW90YXRpb24tdmVyc2lvbiBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS1uZXctcXVvdGF0aW9uLXZlcnNpb24+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgQGNhc2UgKCdOZXdJbnZvaWNlJykge1xuICAgICAgICAgICAgICAgIDx0YS1uZXctaW52b2ljZSBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS1uZXctaW52b2ljZT5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBAY2FzZSAoJ0ludm9pY2VQYXltZW50U3RhdHVzQ2hhbmdlZCcpIHtcbiAgICAgICAgICAgICAgICA8dGEtaW52b2ljZS1wYXltZW50LXN0YXR1cy1jaGFuZ2VkIFtub3RpZmljYXRpb25dPVwibm90aWZcIj48L3RhLWludm9pY2UtcGF5bWVudC1zdGF0dXMtY2hhbmdlZD5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBAY2FzZSAoJ1Rhc2tBc3NpZ25lZCcpIHtcbiAgICAgICAgICAgICAgICA8dGEtdGFzay1hc3NpZ25lZCBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS10YXNrLWFzc2lnbmVkPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIEBjYXNlICgnVG9Eb0Fzc2lnbmVkJykge1xuICAgICAgICAgICAgICAgIDx0YS10by1kby1hc3NpZ25lZCBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS10by1kby1hc3NpZ25lZD5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBAY2FzZSAoJ1Rhc2tEdWVUb2RheScpIHtcbiAgICAgICAgICAgICAgICA8dGEtdGFzay1kdWUtdG9kYXkgW25vdGlmaWNhdGlvbl09XCJub3RpZlwiPjwvdGEtdGFzay1kdWUtdG9kYXk+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgQGNhc2UgKCdUb0RvRHVlVG9kYXknKSB7XG4gICAgICAgICAgICAgICAgPHRhLXRvLWRvLWR1ZS10b2RheSBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS10by1kby1kdWUtdG9kYXk+XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgQGNhc2UgKCdUYXNrTmV3QWN0aXZpdHknKSB7XG4gICAgICAgICAgICAgICAgPHRhLXRhc2stbmV3LWFjdGl2aXR5IFtub3RpZmljYXRpb25dPVwibm90aWZcIj48L3RhLXRhc2stbmV3LWFjdGl2aXR5PlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIEBjYXNlICgnVXNlclRhZ2dlZEluQ29udmVyc2F0aW9uJykge1xuICAgICAgICAgICAgICAgIDx0YS11c2VyLXRhZ2dlZC1pbi1jb252ZXJzYXRpb24gW25vdGlmaWNhdGlvbl09XCJub3RpZlwiPjwvdGEtdXNlci10YWdnZWQtaW4tY29udmVyc2F0aW9uPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIH1cbiAgICAgIDwvZGl2PlxuICAgIDwvdGEtZW1wdHk+XG4gIDwvdGEtZXJyb3I+XG48L3RhLWxvYWRlcj5cbiJdfQ==