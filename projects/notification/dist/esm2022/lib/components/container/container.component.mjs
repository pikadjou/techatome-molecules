import { AsyncPipe, NgFor } from "@angular/common";
import { Component, EventEmitter, Input, Output, } from "@angular/core";
import { tap } from "rxjs";
import { EmptyComponent, ErrorComponent, LoaderComponent } from "@ta/ui";
import { TaBaseComponent } from "@ta/utils";
import { InvoicePaymentStatusChangedComponent } from "../items/item/template/invoice-payment-status-changed/invoice-payment-status-changed.component";
import { NewInvoiceComponent } from "../items/item/template/new-invoice/new-invoice.component";
import { NewQuotationVersionComponent } from "../items/item/template/new-quotation-version/new-quotation-version.component";
import { ProjectStatusChangedComponent } from "../items/item/template/project-status-changed/project-status-changed.component";
import { TaskAssignedComponent } from "../items/item/template/task-assigned/task-assigned.component";
import { TaskDueTodayComponent } from "../items/item/template/task-due-today/task-due-today.component";
import { TaskNewActivityComponent } from "../items/item/template/task-new-activity/task-new-activity.component";
import { ToDoAssignedComponent } from "../items/item/template/to-do-assigned/to-do-assigned.component";
import { ToDoDueTodayComponent } from "../items/item/template/to-do-due-today/to-do-due-today.component";
import { UserTaggedInConversationComponent } from "../items/item/template/user-tagged-in-conversation/user-tagged-in-conversation.component";
import * as i0 from "@angular/core";
import * as i1 from "../../services/data.service";
import * as i2 from "../../services/shared.service";
export class ContainerComponent extends TaBaseComponent {
    get notifications$() {
        return this._notificationDataService.list
            .get$(this._notificationDataService.computeKey(this.filters))
            .pipe(tap((list) => this.nbChanged.emit(list.length)));
    }
    constructor(_notificationDataService, _sharedService) {
        super();
        this._notificationDataService = _notificationDataService;
        this._sharedService = _sharedService;
        this.filters = null;
        this.templates = null;
        this.services = null;
        this.routing = null;
        this.nbChanged = new EventEmitter();
    }
    ngOnInit() {
        this.requestState.asked();
        this._registerSubscription(this._notificationDataService
            .fetchNotifications$(this.filters)
            .subscribe({
            complete: () => this.requestState.completed(),
            error: (error) => {
                this.requestState.onError(error.status, error.statusText);
            },
        }));
        if (this.templates) {
            this._sharedService.paymentStatusTemplate = this.templates?.paymentStatus;
            this._sharedService.projectStatusTemplate = this.templates?.projectStatus;
        }
        if (this.services) {
            this._sharedService.getProjects$ = this.services.getProjects$;
        }
        if (this.routing) {
            this._sharedService.routing = this.routing;
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: ContainerComponent, deps: [{ token: i1.TaNotificationDataService }, { token: i2.TaNotificationSharedService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.14", type: ContainerComponent, isStandalone: true, selector: "ta-notification-container", inputs: { filters: "filters", templates: "templates", services: "services", routing: "routing" }, outputs: { nbChanged: "nbChanged" }, usesInheritance: true, ngImport: i0, template: "<ta-loader\n  [isLoading]=\"this.requestState.isLoading()\"\n  *ngLet=\"this.notifications$ | async as notifications\"\n>\n  <ta-error\n    [message]=\"this.requestState.getErrorMessage()\"\n    [code]=\"this.requestState.getErrorStatus()\"\n  >\n    <ta-empty\n      [isEmpty]=\"!notifications || notifications.length === 0\"\n      icon=\"ghost\"\n      [isLight]=\"false\"\n      text=\"notification.empty\"\n    >\n      <div class=\"notification-container\">\n        @for (notif of this.notifications; track notif) {\n        <div class=\"item-container c-pointer\">\n          @switch (notif.type) { @case ('ProjectStatusChanged') {\n          <ta-notification-project-status-changed\n            [notification]=\"notif\"\n          ></ta-notification-project-status-changed>\n          } @case ('NewQuotationVersion') {\n          <ta-new-quotation-version\n            [notification]=\"notif\"\n          ></ta-new-quotation-version>\n          } @case ('NewInvoice') {\n          <ta-new-invoice [notification]=\"notif\"></ta-new-invoice>\n          } @case ('InvoicePaymentStatusChanged') {\n          <ta-invoice-payment-status-changed\n            [notification]=\"notif\"\n          ></ta-invoice-payment-status-changed>\n          } @case ('TaskAssigned') {\n          <ta-task-assigned [notification]=\"notif\"></ta-task-assigned>\n          } @case ('ToDoAssigned') {\n          <ta-to-do-assigned [notification]=\"notif\"></ta-to-do-assigned>\n          } @case ('TaskDueToday') {\n          <ta-task-due-today [notification]=\"notif\"></ta-task-due-today>\n          } @case ('ToDoDueToday') {\n          <ta-to-do-due-today [notification]=\"notif\"></ta-to-do-due-today>\n          } @case ('TaskNewActivity') {\n          <ta-task-new-activity [notification]=\"notif\"></ta-task-new-activity>\n          } @case ('UserTaggedInConversation') {\n          <ta-user-tagged-in-conversation\n            [notification]=\"notif\"\n          ></ta-user-tagged-in-conversation>\n          } }\n        </div>\n        }\n      </div>\n    </ta-empty>\n  </ta-error>\n</ta-loader>\n", styles: [".item-container{border-bottom:1px solid var(--ta-border-primary)}\n"], dependencies: [{ kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "component", type: EmptyComponent, selector: "ta-empty", inputs: ["isEmpty", "isLight", "showMessage", "text", "type", "icon", "iconSize"] }, { kind: "component", type: ErrorComponent, selector: "ta-error", inputs: ["message", "code"] }, { kind: "component", type: InvoicePaymentStatusChangedComponent, selector: "ta-invoice-payment-status-changed" }, { kind: "component", type: LoaderComponent, selector: "ta-loader", inputs: ["isLoading", "skeleton", "size", "text"] }, { kind: "component", type: NewInvoiceComponent, selector: "ta-new-invoice" }, { kind: "component", type: NewQuotationVersionComponent, selector: "ta-new-quotation-version" }, { kind: "component", type: ProjectStatusChangedComponent, selector: "ta-notification-project-status-changed" }, { kind: "component", type: TaskAssignedComponent, selector: "ta-task-assigned" }, { kind: "component", type: TaskDueTodayComponent, selector: "ta-task-due-today" }, { kind: "component", type: TaskNewActivityComponent, selector: "ta-task-new-activity" }, { kind: "component", type: ToDoAssignedComponent, selector: "ta-to-do-assigned" }, { kind: "component", type: ToDoDueTodayComponent, selector: "ta-to-do-due-today" }, { kind: "component", type: UserTaggedInConversationComponent, selector: "ta-user-tagged-in-conversation" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: ContainerComponent, decorators: [{
            type: Component,
            args: [{ selector: "ta-notification-container", standalone: true, imports: [
                        AsyncPipe,
                        EmptyComponent,
                        ErrorComponent,
                        InvoicePaymentStatusChangedComponent,
                        LoaderComponent,
                        NewInvoiceComponent,
                        NewQuotationVersionComponent,
                        NgFor,
                        ProjectStatusChangedComponent,
                        TaskAssignedComponent,
                        TaskDueTodayComponent,
                        TaskNewActivityComponent,
                        ToDoAssignedComponent,
                        ToDoDueTodayComponent,
                        UserTaggedInConversationComponent,
                    ], template: "<ta-loader\n  [isLoading]=\"this.requestState.isLoading()\"\n  *ngLet=\"this.notifications$ | async as notifications\"\n>\n  <ta-error\n    [message]=\"this.requestState.getErrorMessage()\"\n    [code]=\"this.requestState.getErrorStatus()\"\n  >\n    <ta-empty\n      [isEmpty]=\"!notifications || notifications.length === 0\"\n      icon=\"ghost\"\n      [isLight]=\"false\"\n      text=\"notification.empty\"\n    >\n      <div class=\"notification-container\">\n        @for (notif of this.notifications; track notif) {\n        <div class=\"item-container c-pointer\">\n          @switch (notif.type) { @case ('ProjectStatusChanged') {\n          <ta-notification-project-status-changed\n            [notification]=\"notif\"\n          ></ta-notification-project-status-changed>\n          } @case ('NewQuotationVersion') {\n          <ta-new-quotation-version\n            [notification]=\"notif\"\n          ></ta-new-quotation-version>\n          } @case ('NewInvoice') {\n          <ta-new-invoice [notification]=\"notif\"></ta-new-invoice>\n          } @case ('InvoicePaymentStatusChanged') {\n          <ta-invoice-payment-status-changed\n            [notification]=\"notif\"\n          ></ta-invoice-payment-status-changed>\n          } @case ('TaskAssigned') {\n          <ta-task-assigned [notification]=\"notif\"></ta-task-assigned>\n          } @case ('ToDoAssigned') {\n          <ta-to-do-assigned [notification]=\"notif\"></ta-to-do-assigned>\n          } @case ('TaskDueToday') {\n          <ta-task-due-today [notification]=\"notif\"></ta-task-due-today>\n          } @case ('ToDoDueToday') {\n          <ta-to-do-due-today [notification]=\"notif\"></ta-to-do-due-today>\n          } @case ('TaskNewActivity') {\n          <ta-task-new-activity [notification]=\"notif\"></ta-task-new-activity>\n          } @case ('UserTaggedInConversation') {\n          <ta-user-tagged-in-conversation\n            [notification]=\"notif\"\n          ></ta-user-tagged-in-conversation>\n          } }\n        </div>\n        }\n      </div>\n    </ta-empty>\n  </ta-error>\n</ta-loader>\n", styles: [".item-container{border-bottom:1px solid var(--ta-border-primary)}\n"] }]
        }], ctorParameters: () => [{ type: i1.TaNotificationDataService }, { type: i2.TaNotificationSharedService }], propDecorators: { filters: [{
                type: Input
            }], templates: [{
                type: Input
            }], services: [{
                type: Input
            }], routing: [{
                type: Input
            }], nbChanged: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGFpbmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9jb250YWluZXIvY29udGFpbmVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9jb250YWluZXIvY29udGFpbmVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFbkQsT0FBTyxFQUNMLFNBQVMsRUFDVCxZQUFZLEVBQ1osS0FBSyxFQUVMLE1BQU0sR0FFUCxNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQWMsR0FBRyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRXZDLE9BQU8sRUFBRSxjQUFjLEVBQUUsY0FBYyxFQUFFLGVBQWUsRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUN6RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBUTVDLE9BQU8sRUFBRSxvQ0FBb0MsRUFBRSxNQUFNLGdHQUFnRyxDQUFDO0FBQ3RKLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBEQUEwRCxDQUFDO0FBQy9GLE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLDhFQUE4RSxDQUFDO0FBQzVILE9BQU8sRUFBRSw2QkFBNkIsRUFBRSxNQUFNLGdGQUFnRixDQUFDO0FBQy9ILE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDhEQUE4RCxDQUFDO0FBQ3JHLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGdFQUFnRSxDQUFDO0FBQ3ZHLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLHNFQUFzRSxDQUFDO0FBQ2hILE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGdFQUFnRSxDQUFDO0FBQ3ZHLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGtFQUFr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ckIsd0JBQXdCO3dCQUN4QixxQkFBcUI7d0JBQ3JCLHFCQUFxQjt3QkFDckIsaUNBQWlDO3FCQUNsQzt3SUFJRCxPQUFPO3NCQUROLEtBQUs7Z0JBSU4sU0FBUztzQkFEUixLQUFLO2dCQU9OLFFBQVE7c0JBRFAsS0FBSztnQkFNTixPQUFPO3NCQUROLEtBQUs7Z0JBSU4sU0FBUztzQkFEUixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXN5bmNQaXBlLCBOZ0ZvciB9IGZyb20gXCJAYW5ndWxhci9jb21tb25cIjtcbmltcG9ydCB7IEh0dHBFcnJvclJlc3BvbnNlIH0gZnJvbSBcIkBhbmd1bGFyL2NvbW1vbi9odHRwXCI7XG5pbXBvcnQge1xuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5wdXQsXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBUZW1wbGF0ZVJlZixcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcblxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgdGFwIH0gZnJvbSBcInJ4anNcIjtcblxuaW1wb3J0IHsgRW1wdHlDb21wb25lbnQsIEVycm9yQ29tcG9uZW50LCBMb2FkZXJDb21wb25lbnQgfSBmcm9tIFwiQHRhL3VpXCI7XG5pbXBvcnQgeyBUYUJhc2VDb21wb25lbnQgfSBmcm9tIFwiQHRhL3V0aWxzXCI7XG5cbmltcG9ydCB7IFRhTm90aWZpY2F0aW9uRGF0YVNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vc2VydmljZXMvZGF0YS5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBOb3RpZmljYXRpb25GaWx0ZXIgfSBmcm9tIFwiLi4vLi4vc2VydmljZXMvcXVlcmllc1wiO1xuaW1wb3J0IHtcbiAgUm91dGluZ1R5cGUsXG4gIFRhTm90aWZpY2F0aW9uU2hhcmVkU2VydmljZSxcbn0gZnJvbSBcIi4uLy4uL3NlcnZpY2VzL3NoYXJlZC5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBJbnZvaWNlUGF5bWVudFN0YXR1c0NoYW5nZWRDb21wb25lbnQgfSBmcm9tIFwiLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS9pbnZvaWNlLXBheW1lbnQtc3RhdHVzLWNoYW5nZWQvaW52b2ljZS1wYXltZW50LXN0YXR1cy1jaGFuZ2VkLmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgTmV3SW52b2ljZUNvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL25ldy1pbnZvaWNlL25ldy1pbnZvaWNlLmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgTmV3UXVvdGF0aW9uVmVyc2lvbkNvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL25ldy1xdW90YXRpb24tdmVyc2lvbi9uZXctcXVvdGF0aW9uLXZlcnNpb24uY29tcG9uZW50XCI7XG5pbXBvcnQgeyBQcm9qZWN0U3RhdHVzQ2hhbmdlZENvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3Byb2plY3Qtc3RhdHVzLWNoYW5nZWQvcHJvamVjdC1zdGF0dXMtY2hhbmdlZC5jb21wb25lbnRcIjtcbmltcG9ydCB7IFRhc2tBc3NpZ25lZENvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3Rhc2stYXNzaWduZWQvdGFzay1hc3NpZ25lZC5jb21wb25lbnRcIjtcbmltcG9ydCB7IFRhc2tEdWVUb2RheUNvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3Rhc2stZHVlLXRvZGF5L3Rhc2stZHVlLXRvZGF5LmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgVGFza05ld0FjdGl2aXR5Q29tcG9uZW50IH0gZnJvbSBcIi4uL2l0ZW1zL2l0ZW0vdGVtcGxhdGUvdGFzay1uZXctYWN0aXZpdHkvdGFzay1uZXctYWN0aXZpdHkuY29tcG9uZW50XCI7XG5pbXBvcnQgeyBUb0RvQXNzaWduZWRDb21wb25lbnQgfSBmcm9tIFwiLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS90by1kby1hc3NpZ25lZC90by1kby1hc3NpZ25lZC5jb21wb25lbnRcIjtcbmltcG9ydCB7IFRvRG9EdWVUb2RheUNvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3RvLWRvLWR1ZS10b2RheS90by1kby1kdWUtdG9kYXkuY29tcG9uZW50XCI7XG5pbXBvcnQgeyBVc2VyVGFnZ2VkSW5Db252ZXJzYXRpb25Db21wb25lbnQgfSBmcm9tIFwiLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS91c2VyLXRhZ2dlZC1pbi1jb252ZXJzYXRpb24vdXNlci10YWdnZWQtaW4tY29udmVyc2F0aW9uLmNvbXBvbmVudFwiO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6IFwidGEtbm90aWZpY2F0aW9uLWNvbnRhaW5lclwiLFxuICB0ZW1wbGF0ZVVybDogXCIuL2NvbnRhaW5lci5jb21wb25lbnQuaHRtbFwiLFxuICBzdHlsZVVybHM6IFtcIi4vY29udGFpbmVyLmNvbXBvbmVudC5zY3NzXCJdLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgQXN5bmNQaXBlLFxuICAgIEVtcHR5Q29tcG9uZW50LFxuICAgIEVycm9yQ29tcG9uZW50LFxuICAgIEludm9pY2VQYXltZW50U3RhdHVzQ2hhbmdlZENvbXBvbmVudCxcbiAgICBMb2FkZXJDb21wb25lbnQsXG4gICAgTmV3SW52b2ljZUNvbXBvbmVudCxcbiAgICBOZXdRdW90YXRpb25WZXJzaW9uQ29tcG9uZW50LFxuICAgIE5nRm9yLFxuICAgIFByb2plY3RTdGF0dXNDaGFuZ2VkQ29tcG9uZW50LFxuICAgIFRhc2tBc3NpZ25lZENvbXBvbmVudCxcbiAgICBUYXNrRHVlVG9kYXlDb21wb25lbnQsXG4gICAgVGFza05ld0FjdGl2aXR5Q29tcG9uZW50LFxuICAgIFRvRG9Bc3NpZ25lZENvbXBvbmVudCxcbiAgICBUb0RvRHVlVG9kYXlDb21wb25lbnQsXG4gICAgVXNlclRhZ2dlZEluQ29udmVyc2F0aW9uQ29tcG9uZW50LFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBDb250YWluZXJDb21wb25lbnQgZXh0ZW5kcyBUYUJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBASW5wdXQoKVxuICBmaWx0ZXJzOiBOb3RpZmljYXRpb25GaWx0ZXIgPSBudWxsO1xuXG4gIEBJbnB1dCgpXG4gIHRlbXBsYXRlczoge1xuICAgIHBheW1lbnRTdGF0dXM6IFRlbXBsYXRlUmVmPGFueT47XG4gICAgcHJvamVjdFN0YXR1czogVGVtcGxhdGVSZWY8YW55PjtcbiAgfSB8IG51bGwgPSBudWxsO1xuXG4gIEBJbnB1dCgpXG4gIHNlcnZpY2VzOiB7XG4gICAgZ2V0UHJvamVjdHMkOiAoaWRzOiBzdHJpbmdbXSkgPT4gT2JzZXJ2YWJsZTx7IGlkOiBzdHJpbmc7IG5hbWU6IHN0cmluZyB9W10+O1xuICB9IHwgbnVsbCA9IG51bGw7XG5cbiAgQElucHV0KClcbiAgcm91dGluZzogeyBbaW5kZXggaW4gUm91dGluZ1R5cGVdOiAoZGF0YTogYW55KSA9PiB2b2lkIH0gfCBudWxsID0gbnVsbDtcblxuICBAT3V0cHV0KClcbiAgbmJDaGFuZ2VkOiBFdmVudEVtaXR0ZXI8bnVtYmVyPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICBnZXQgbm90aWZpY2F0aW9ucyQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX25vdGlmaWNhdGlvbkRhdGFTZXJ2aWNlLmxpc3RcbiAgICAgIC5nZXQkKHRoaXMuX25vdGlmaWNhdGlvbkRhdGFTZXJ2aWNlLmNvbXB1dGVLZXkodGhpcy5maWx0ZXJzKSlcbiAgICAgIC5waXBlKHRhcCgobGlzdCkgPT4gdGhpcy5uYkNoYW5nZWQuZW1pdChsaXN0Lmxlbmd0aCkpKTtcbiAgfVxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIF9ub3RpZmljYXRpb25EYXRhU2VydmljZTogVGFOb3RpZmljYXRpb25EYXRhU2VydmljZSxcbiAgICBwcml2YXRlIF9zaGFyZWRTZXJ2aWNlOiBUYU5vdGlmaWNhdGlvblNoYXJlZFNlcnZpY2VcbiAgKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMucmVxdWVzdFN0YXRlLmFza2VkKCk7XG4gICAgdGhpcy5fcmVnaXN0ZXJTdWJzY3JpcHRpb24oXG4gICAgICB0aGlzLl9ub3RpZmljYXRpb25EYXRhU2VydmljZVxuICAgICAgICAuZmV0Y2hOb3RpZmljYXRpb25zJCh0aGlzLmZpbHRlcnMpXG4gICAgICAgIC5zdWJzY3JpYmUoe1xuICAgICAgICAgIGNvbXBsZXRlOiAoKSA9PiB0aGlzLnJlcXVlc3RTdGF0ZS5jb21wbGV0ZWQoKSxcbiAgICAgICAgICBlcnJvcjogKGVycm9yOiBIdHRwRXJyb3JSZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0U3RhdGUub25FcnJvcihlcnJvci5zdGF0dXMsIGVycm9yLnN0YXR1c1RleHQpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgKTtcblxuICAgIGlmICh0aGlzLnRlbXBsYXRlcykge1xuICAgICAgdGhpcy5fc2hhcmVkU2VydmljZS5wYXltZW50U3RhdHVzVGVtcGxhdGUgPSB0aGlzLnRlbXBsYXRlcz8ucGF5bWVudFN0YXR1cztcbiAgICAgIHRoaXMuX3NoYXJlZFNlcnZpY2UucHJvamVjdFN0YXR1c1RlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXM/LnByb2plY3RTdGF0dXM7XG4gICAgfVxuICAgIGlmICh0aGlzLnNlcnZpY2VzKSB7XG4gICAgICB0aGlzLl9zaGFyZWRTZXJ2aWNlLmdldFByb2plY3RzJCA9IHRoaXMuc2VydmljZXMuZ2V0UHJvamVjdHMkO1xuICAgIH1cbiAgICBpZiAodGhpcy5yb3V0aW5nKSB7XG4gICAgICB0aGlzLl9zaGFyZWRTZXJ2aWNlLnJvdXRpbmcgPSB0aGlzLnJvdXRpbmc7XG4gICAgfVxuICB9XG59XG4iLCI8dGEtbG9hZGVyXG4gIFtpc0xvYWRpbmddPVwidGhpcy5yZXF1ZXN0U3RhdGUuaXNMb2FkaW5nKClcIlxuICAqbmdMZXQ9XCJ0aGlzLm5vdGlmaWNhdGlvbnMkIHwgYXN5bmMgYXMgbm90aWZpY2F0aW9uc1wiXG4+XG4gIDx0YS1lcnJvclxuICAgIFttZXNzYWdlXT1cInRoaXMucmVxdWVzdFN0YXRlLmdldEVycm9yTWVzc2FnZSgpXCJcbiAgICBbY29kZV09XCJ0aGlzLnJlcXVlc3RTdGF0ZS5nZXRFcnJvclN0YXR1cygpXCJcbiAgPlxuICAgIDx0YS1lbXB0eVxuICAgICAgW2lzRW1wdHldPVwiIW5vdGlmaWNhdGlvbnMgfHwgbm90aWZpY2F0aW9ucy5sZW5ndGggPT09IDBcIlxuICAgICAgaWNvbj1cImdob3N0XCJcbiAgICAgIFtpc0xpZ2h0XT1cImZhbHNlXCJcbiAgICAgIHRleHQ9XCJub3RpZmljYXRpb24uZW1wdHlcIlxuICAgID5cbiAgICAgIDxkaXYgY2xhc3M9XCJub3RpZmljYXRpb24tY29udGFpbmVyXCI+XG4gICAgICAgIEBmb3IgKG5vdGlmIG9mIHRoaXMubm90aWZpY2F0aW9uczsgdHJhY2sgbm90aWYpIHtcbiAgICAgICAgPGRpdiBjbGFzcz1cIml0ZW0tY29udGFpbmVyIGMtcG9pbnRlclwiPlxuICAgICAgICAgIEBzd2l0Y2ggKG5vdGlmLnR5cGUpIHsgQGNhc2UgKCdQcm9qZWN0U3RhdHVzQ2hhbmdlZCcpIHtcbiAgICAgICAgICA8dGEtbm90aWZpY2F0aW9uLXByb2plY3Qtc3RhdHVzLWNoYW5nZWRcbiAgICAgICAgICAgIFtub3RpZmljYXRpb25dPVwibm90aWZcIlxuICAgICAgICAgID48L3RhLW5vdGlmaWNhdGlvbi1wcm9qZWN0LXN0YXR1cy1jaGFuZ2VkPlxuICAgICAgICAgIH0gQGNhc2UgKCdOZXdRdW90YXRpb25WZXJzaW9uJykge1xuICAgICAgICAgIDx0YS1uZXctcXVvdGF0aW9uLXZlcnNpb25cbiAgICAgICAgICAgIFtub3RpZmljYXRpb25dPVwibm90aWZcIlxuICAgICAgICAgID48L3RhLW5ldy1xdW90YXRpb24tdmVyc2lvbj5cbiAgICAgICAgICB9IEBjYXNlICgnTmV3SW52b2ljZScpIHtcbiAgICAgICAgICA8dGEtbmV3LWludm9pY2UgW25vdGlmaWNhdGlvbl09XCJub3RpZlwiPjwvdGEtbmV3LWludm9pY2U+XG4gICAgICAgICAgfSBAY2FzZSAoJ0ludm9pY2VQYXltZW50U3RhdHVzQ2hhbmdlZCcpIHtcbiAgICAgICAgICA8dGEtaW52b2ljZS1wYXltZW50LXN0YXR1cy1jaGFuZ2VkXG4gICAgICAgICAgICBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCJcbiAgICAgICAgICA+PC90YS1pbnZvaWNlLXBheW1lbnQtc3RhdHVzLWNoYW5nZWQ+XG4gICAgICAgICAgfSBAY2FzZSAoJ1Rhc2tBc3NpZ25lZCcpIHtcbiAgICAgICAgICA8dGEtdGFzay1hc3NpZ25lZCBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS10YXNrLWFzc2lnbmVkPlxuICAgICAgICAgIH0gQGNhc2UgKCdUb0RvQXNzaWduZWQnKSB7XG4gICAgICAgICAgPHRhLXRvLWRvLWFzc2lnbmVkIFtub3RpZmljYXRpb25dPVwibm90aWZcIj48L3RhLXRvLWRvLWFzc2lnbmVkPlxuICAgICAgICAgIH0gQGNhc2UgKCdUYXNrRHVlVG9kYXknKSB7XG4gICAgICAgICAgPHRhLXRhc2stZHVlLXRvZGF5IFtub3RpZmljYXRpb25dPVwibm90aWZcIj48L3RhLXRhc2stZHVlLXRvZGF5PlxuICAgICAgICAgIH0gQGNhc2UgKCdUb0RvRHVlVG9kYXknKSB7XG4gICAgICAgICAgPHRhLXRvLWRvLWR1ZS10b2RheSBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS10by1kby1kdWUtdG9kYXk+XG4gICAgICAgICAgfSBAY2FzZSAoJ1Rhc2tOZXdBY3Rpdml0eScpIHtcbiAgICAgICAgICA8dGEtdGFzay1uZXctYWN0aXZpdHkgW25vdGlmaWNhdGlvbl09XCJub3RpZlwiPjwvdGEtdGFzay1uZXctYWN0aXZpdHk+XG4gICAgICAgICAgfSBAY2FzZSAoJ1VzZXJUYWdnZWRJbkNvbnZlcnNhdGlvbicpIHtcbiAgICAgICAgICA8dGEtdXNlci10YWdnZWQtaW4tY29udmVyc2F0aW9uXG4gICAgICAgICAgICBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCJcbiAgICAgICAgICA+PC90YS11c2VyLXRhZ2dlZC1pbi1jb252ZXJzYXRpb24+XG4gICAgICAgICAgfSB9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICB9XG4gICAgICA8L2Rpdj5cbiAgICA8L3RhLWVtcHR5PlxuICA8L3RhLWVycm9yPlxuPC90YS1sb2FkZXI+XG4iXX0=