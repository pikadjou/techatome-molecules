import { AsyncPipe, NgFor } from "@angular/common";
import { Component, EventEmitter, input, Output, } from "@angular/core";
import { tap } from "rxjs";
import { EmptyComponent, ErrorComponent, LoaderComponent } from "@ta/ui";
import { TaBaseComponent } from "@ta/utils";
import { InvoicePaymentStatusChangedComponent } from "../items/item/template/invoice-payment-status-changed/invoice-payment-status-changed.component";
import { NewInvoiceComponent } from "../items/item/template/new-invoice/new-invoice.component";
import { NewQuotationVersionComponent } from "../items/item/template/new-quotation-version/new-quotation-version.component";
import { ProjectStatusChangedComponent } from "../items/item/template/project-status-changed/project-status-changed.component";
import { TaskAssignedComponent } from "../items/item/template/task-assigned/task-assigned.component";
import { TaskDueTodayComponent } from "../items/item/template/task-due-today/task-due-today.component";
import { TaskNewActivityComponent } from "../items/item/template/task-new-activity/task-new-activity.component";
import { ToDoAssignedComponent } from "../items/item/template/to-do-assigned/to-do-assigned.component";
import { ToDoDueTodayComponent } from "../items/item/template/to-do-due-today/to-do-due-today.component";
import { UserTaggedInConversationComponent } from "../items/item/template/user-tagged-in-conversation/user-tagged-in-conversation.component";
import * as i0 from "@angular/core";
import * as i1 from "../../services/data.service";
import * as i2 from "../../services/shared.service";
export class ContainerComponent extends TaBaseComponent {
    get notifications$() {
        return this._notificationDataService.list
            .get$(this._notificationDataService.computeKey(this.filters()))
            .pipe(tap((list) => this.nbChanged.emit(list.length)));
    }
    constructor(_notificationDataService, _sharedService) {
        super();
        this._notificationDataService = _notificationDataService;
        this._sharedService = _sharedService;
        this.filters = input(null);
        this.templates = input(null);
        this.services = input(null);
        this.routing = input(null);
        this.nbChanged = new EventEmitter();
    }
    ngOnInit() {
        this.requestState.asked();
        this._registerSubscription(this._notificationDataService
            .fetchNotifications$(this.filters())
            .subscribe({
            complete: () => this.requestState.completed(),
            error: (error) => {
                this.requestState.onError(error.status, error.statusText);
            },
        }));
        const templatesVal = this.templates();
        if (templatesVal) {
            this._sharedService.paymentStatusTemplate = templatesVal.paymentStatus;
            this._sharedService.projectStatusTemplate = templatesVal.projectStatus;
        }
        const servicesVal = this.services();
        if (servicesVal) {
            this._sharedService.getProjects$ = servicesVal.getProjects$;
        }
        const routingVal = this.routing();
        if (routingVal) {
            this._sharedService.routing = routingVal;
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: ContainerComponent, deps: [{ token: i1.TaNotificationDataService }, { token: i2.TaNotificationSharedService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.14", type: ContainerComponent, isStandalone: true, selector: "ta-notification-container", inputs: { filters: { classPropertyName: "filters", publicName: "filters", isSignal: true, isRequired: false, transformFunction: null }, templates: { classPropertyName: "templates", publicName: "templates", isSignal: true, isRequired: false, transformFunction: null }, services: { classPropertyName: "services", publicName: "services", isSignal: true, isRequired: false, transformFunction: null }, routing: { classPropertyName: "routing", publicName: "routing", isSignal: true, isRequired: false, transformFunction: null } }, outputs: { nbChanged: "nbChanged" }, usesInheritance: true, ngImport: i0, template: "<ta-loader\n  [isLoading]=\"this.requestState.isLoading()\"\n  *ngLet=\"this.notifications$ | async as notifications\"\n>\n  <ta-error\n    [message]=\"this.requestState.getErrorMessage()\"\n    [code]=\"this.requestState.getErrorStatus()\"\n  >\n    <ta-empty\n      [isEmpty]=\"!notifications || notifications.length === 0\"\n      icon=\"ghost\"\n      [isLight]=\"false\"\n      text=\"notification.empty\"\n    >\n      <div class=\"notification-container\">\n        @for (notif of this.notifications; track notif) {\n        <div class=\"item-container c-pointer\">\n          @switch (notif.type) { @case ('ProjectStatusChanged') {\n          <ta-notification-project-status-changed\n            [notification]=\"notif\"\n          ></ta-notification-project-status-changed>\n          } @case ('NewQuotationVersion') {\n          <ta-new-quotation-version\n            [notification]=\"notif\"\n          ></ta-new-quotation-version>\n          } @case ('NewInvoice') {\n          <ta-new-invoice [notification]=\"notif\"></ta-new-invoice>\n          } @case ('InvoicePaymentStatusChanged') {\n          <ta-invoice-payment-status-changed\n            [notification]=\"notif\"\n          ></ta-invoice-payment-status-changed>\n          } @case ('TaskAssigned') {\n          <ta-task-assigned [notification]=\"notif\"></ta-task-assigned>\n          } @case ('ToDoAssigned') {\n          <ta-to-do-assigned [notification]=\"notif\"></ta-to-do-assigned>\n          } @case ('TaskDueToday') {\n          <ta-task-due-today [notification]=\"notif\"></ta-task-due-today>\n          } @case ('ToDoDueToday') {\n          <ta-to-do-due-today [notification]=\"notif\"></ta-to-do-due-today>\n          } @case ('TaskNewActivity') {\n          <ta-task-new-activity [notification]=\"notif\"></ta-task-new-activity>\n          } @case ('UserTaggedInConversation') {\n          <ta-user-tagged-in-conversation\n            [notification]=\"notif\"\n          ></ta-user-tagged-in-conversation>\n          } }\n        </div>\n        }\n      </div>\n    </ta-empty>\n  </ta-error>\n</ta-loader>\n", styles: [".item-container{border-bottom:1px solid var(--ta-border-primary)}\n"], dependencies: [{ kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "component", type: EmptyComponent, selector: "ta-empty", inputs: ["isEmpty", "isLight", "showMessage", "text", "type", "icon", "iconSize"] }, { kind: "component", type: ErrorComponent, selector: "ta-error", inputs: ["message", "code"] }, { kind: "component", type: InvoicePaymentStatusChangedComponent, selector: "ta-invoice-payment-status-changed" }, { kind: "component", type: LoaderComponent, selector: "ta-loader", inputs: ["isLoading", "skeleton", "size", "text"] }, { kind: "component", type: NewInvoiceComponent, selector: "ta-new-invoice" }, { kind: "component", type: NewQuotationVersionComponent, selector: "ta-new-quotation-version" }, { kind: "component", type: ProjectStatusChangedComponent, selector: "ta-notification-project-status-changed" }, { kind: "component", type: TaskAssignedComponent, selector: "ta-task-assigned" }, { kind: "component", type: TaskDueTodayComponent, selector: "ta-task-due-today" }, { kind: "component", type: TaskNewActivityComponent, selector: "ta-task-new-activity" }, { kind: "component", type: ToDoAssignedComponent, selector: "ta-to-do-assigned" }, { kind: "component", type: ToDoDueTodayComponent, selector: "ta-to-do-due-today" }, { kind: "component", type: UserTaggedInConversationComponent, selector: "ta-user-tagged-in-conversation" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: ContainerComponent, decorators: [{
            type: Component,
            args: [{ selector: "ta-notification-container", standalone: true, imports: [
                        AsyncPipe,
                        EmptyComponent,
                        ErrorComponent,
                        InvoicePaymentStatusChangedComponent,
                        LoaderComponent,
                        NewInvoiceComponent,
                        NewQuotationVersionComponent,
                        NgFor,
                        ProjectStatusChangedComponent,
                        TaskAssignedComponent,
                        TaskDueTodayComponent,
                        TaskNewActivityComponent,
                        ToDoAssignedComponent,
                        ToDoDueTodayComponent,
                        UserTaggedInConversationComponent,
                    ], template: "<ta-loader\n  [isLoading]=\"this.requestState.isLoading()\"\n  *ngLet=\"this.notifications$ | async as notifications\"\n>\n  <ta-error\n    [message]=\"this.requestState.getErrorMessage()\"\n    [code]=\"this.requestState.getErrorStatus()\"\n  >\n    <ta-empty\n      [isEmpty]=\"!notifications || notifications.length === 0\"\n      icon=\"ghost\"\n      [isLight]=\"false\"\n      text=\"notification.empty\"\n    >\n      <div class=\"notification-container\">\n        @for (notif of this.notifications; track notif) {\n        <div class=\"item-container c-pointer\">\n          @switch (notif.type) { @case ('ProjectStatusChanged') {\n          <ta-notification-project-status-changed\n            [notification]=\"notif\"\n          ></ta-notification-project-status-changed>\n          } @case ('NewQuotationVersion') {\n          <ta-new-quotation-version\n            [notification]=\"notif\"\n          ></ta-new-quotation-version>\n          } @case ('NewInvoice') {\n          <ta-new-invoice [notification]=\"notif\"></ta-new-invoice>\n          } @case ('InvoicePaymentStatusChanged') {\n          <ta-invoice-payment-status-changed\n            [notification]=\"notif\"\n          ></ta-invoice-payment-status-changed>\n          } @case ('TaskAssigned') {\n          <ta-task-assigned [notification]=\"notif\"></ta-task-assigned>\n          } @case ('ToDoAssigned') {\n          <ta-to-do-assigned [notification]=\"notif\"></ta-to-do-assigned>\n          } @case ('TaskDueToday') {\n          <ta-task-due-today [notification]=\"notif\"></ta-task-due-today>\n          } @case ('ToDoDueToday') {\n          <ta-to-do-due-today [notification]=\"notif\"></ta-to-do-due-today>\n          } @case ('TaskNewActivity') {\n          <ta-task-new-activity [notification]=\"notif\"></ta-task-new-activity>\n          } @case ('UserTaggedInConversation') {\n          <ta-user-tagged-in-conversation\n            [notification]=\"notif\"\n          ></ta-user-tagged-in-conversation>\n          } }\n        </div>\n        }\n      </div>\n    </ta-empty>\n  </ta-error>\n</ta-loader>\n", styles: [".item-container{border-bottom:1px solid var(--ta-border-primary)}\n"] }]
        }], ctorParameters: () => [{ type: i1.TaNotificationDataService }, { type: i2.TaNotificationSharedService }], propDecorators: { nbChanged: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGFpbmVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9jb250YWluZXIvY29udGFpbmVyLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9jb250YWluZXIvY29udGFpbmVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFbkQsT0FBTyxFQUNMLFNBQVMsRUFDVCxZQUFZLEVBQ1osS0FBSyxFQUVMLE1BQU0sR0FFUCxNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQWMsR0FBRyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRXZDLE9BQU8sRUFBRSxjQUFjLEVBQUUsY0FBYyxFQUFFLGVBQWUsRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUN6RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBUTVDLE9BQU8sRUFBRSxvQ0FBb0MsRUFBRSxNQUFNLGdHQUFnRyxDQUFDO0FBQ3RKLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDBEQUEwRCxDQUFDO0FBQy9GLE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLDhFQUE4RSxDQUFDO0FBQzVILE9BQU8sRUFBRSw2QkFBNkIsRUFBRSxNQUFNLGdGQUFnRixDQUFDO0FBQy9ILE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLDhEQUE4RCxDQUFDO0FBQ3JHLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGdFQUFnRSxDQUFDO0FBQ3ZHLE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLHNFQUFzRSxDQUFDO0FBQ2hILE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGdFQUFnRSxDQUFDO0FBQ3ZHLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGtFQUFr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UCxTQUFTO3dCQUNULGNBQWM7d0JBQ2QsY0FBYzt3QkFDZCxvQ0FBb0M7d0JBQ3BDLGVBQWU7d0JBQ2YsbUJBQW1CO3dCQUNuQiw0QkFBNEI7d0JBQzVCLEtBQUs7d0JBQ0wsNkJBQTZCO3dCQUM3QixxQkFBcUI7d0JBQ3JCLHFCQUFxQjt3QkFDckIsd0JBQXdCO3dCQUN4QixxQkFBcUI7d0JBQ3JCLHFCQUFxQjt3QkFDckIsaUNBQWlDO3FCQUNsQzt3SUFpQkQsU0FBUztzQkFEUixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXN5bmNQaXBlLCBOZ0ZvciB9IGZyb20gXCJAYW5ndWxhci9jb21tb25cIjtcbmltcG9ydCB7IEh0dHBFcnJvclJlc3BvbnNlIH0gZnJvbSBcIkBhbmd1bGFyL2NvbW1vbi9odHRwXCI7XG5pbXBvcnQge1xuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgaW5wdXQsXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBUZW1wbGF0ZVJlZixcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcblxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgdGFwIH0gZnJvbSBcInJ4anNcIjtcblxuaW1wb3J0IHsgRW1wdHlDb21wb25lbnQsIEVycm9yQ29tcG9uZW50LCBMb2FkZXJDb21wb25lbnQgfSBmcm9tIFwiQHRhL3VpXCI7XG5pbXBvcnQgeyBUYUJhc2VDb21wb25lbnQgfSBmcm9tIFwiQHRhL3V0aWxzXCI7XG5cbmltcG9ydCB7IFRhTm90aWZpY2F0aW9uRGF0YVNlcnZpY2UgfSBmcm9tIFwiLi4vLi4vc2VydmljZXMvZGF0YS5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBOb3RpZmljYXRpb25GaWx0ZXIgfSBmcm9tIFwiLi4vLi4vc2VydmljZXMvcXVlcmllc1wiO1xuaW1wb3J0IHtcbiAgUm91dGluZ1R5cGUsXG4gIFRhTm90aWZpY2F0aW9uU2hhcmVkU2VydmljZSxcbn0gZnJvbSBcIi4uLy4uL3NlcnZpY2VzL3NoYXJlZC5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBJbnZvaWNlUGF5bWVudFN0YXR1c0NoYW5nZWRDb21wb25lbnQgfSBmcm9tIFwiLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS9pbnZvaWNlLXBheW1lbnQtc3RhdHVzLWNoYW5nZWQvaW52b2ljZS1wYXltZW50LXN0YXR1cy1jaGFuZ2VkLmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgTmV3SW52b2ljZUNvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL25ldy1pbnZvaWNlL25ldy1pbnZvaWNlLmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgTmV3UXVvdGF0aW9uVmVyc2lvbkNvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL25ldy1xdW90YXRpb24tdmVyc2lvbi9uZXctcXVvdGF0aW9uLXZlcnNpb24uY29tcG9uZW50XCI7XG5pbXBvcnQgeyBQcm9qZWN0U3RhdHVzQ2hhbmdlZENvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3Byb2plY3Qtc3RhdHVzLWNoYW5nZWQvcHJvamVjdC1zdGF0dXMtY2hhbmdlZC5jb21wb25lbnRcIjtcbmltcG9ydCB7IFRhc2tBc3NpZ25lZENvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3Rhc2stYXNzaWduZWQvdGFzay1hc3NpZ25lZC5jb21wb25lbnRcIjtcbmltcG9ydCB7IFRhc2tEdWVUb2RheUNvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3Rhc2stZHVlLXRvZGF5L3Rhc2stZHVlLXRvZGF5LmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgVGFza05ld0FjdGl2aXR5Q29tcG9uZW50IH0gZnJvbSBcIi4uL2l0ZW1zL2l0ZW0vdGVtcGxhdGUvdGFzay1uZXctYWN0aXZpdHkvdGFzay1uZXctYWN0aXZpdHkuY29tcG9uZW50XCI7XG5pbXBvcnQgeyBUb0RvQXNzaWduZWRDb21wb25lbnQgfSBmcm9tIFwiLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS90by1kby1hc3NpZ25lZC90by1kby1hc3NpZ25lZC5jb21wb25lbnRcIjtcbmltcG9ydCB7IFRvRG9EdWVUb2RheUNvbXBvbmVudCB9IGZyb20gXCIuLi9pdGVtcy9pdGVtL3RlbXBsYXRlL3RvLWRvLWR1ZS10b2RheS90by1kby1kdWUtdG9kYXkuY29tcG9uZW50XCI7XG5pbXBvcnQgeyBVc2VyVGFnZ2VkSW5Db252ZXJzYXRpb25Db21wb25lbnQgfSBmcm9tIFwiLi4vaXRlbXMvaXRlbS90ZW1wbGF0ZS91c2VyLXRhZ2dlZC1pbi1jb252ZXJzYXRpb24vdXNlci10YWdnZWQtaW4tY29udmVyc2F0aW9uLmNvbXBvbmVudFwiO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6IFwidGEtbm90aWZpY2F0aW9uLWNvbnRhaW5lclwiLFxuICB0ZW1wbGF0ZVVybDogXCIuL2NvbnRhaW5lci5jb21wb25lbnQuaHRtbFwiLFxuICBzdHlsZVVybHM6IFtcIi4vY29udGFpbmVyLmNvbXBvbmVudC5zY3NzXCJdLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgQXN5bmNQaXBlLFxuICAgIEVtcHR5Q29tcG9uZW50LFxuICAgIEVycm9yQ29tcG9uZW50LFxuICAgIEludm9pY2VQYXltZW50U3RhdHVzQ2hhbmdlZENvbXBvbmVudCxcbiAgICBMb2FkZXJDb21wb25lbnQsXG4gICAgTmV3SW52b2ljZUNvbXBvbmVudCxcbiAgICBOZXdRdW90YXRpb25WZXJzaW9uQ29tcG9uZW50LFxuICAgIE5nRm9yLFxuICAgIFByb2plY3RTdGF0dXNDaGFuZ2VkQ29tcG9uZW50LFxuICAgIFRhc2tBc3NpZ25lZENvbXBvbmVudCxcbiAgICBUYXNrRHVlVG9kYXlDb21wb25lbnQsXG4gICAgVGFza05ld0FjdGl2aXR5Q29tcG9uZW50LFxuICAgIFRvRG9Bc3NpZ25lZENvbXBvbmVudCxcbiAgICBUb0RvRHVlVG9kYXlDb21wb25lbnQsXG4gICAgVXNlclRhZ2dlZEluQ29udmVyc2F0aW9uQ29tcG9uZW50LFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBDb250YWluZXJDb21wb25lbnQgZXh0ZW5kcyBUYUJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBmaWx0ZXJzID0gaW5wdXQ8Tm90aWZpY2F0aW9uRmlsdGVyPihudWxsKTtcblxuICB0ZW1wbGF0ZXMgPSBpbnB1dDx7XG4gICAgcGF5bWVudFN0YXR1czogVGVtcGxhdGVSZWY8YW55PjtcbiAgICBwcm9qZWN0U3RhdHVzOiBUZW1wbGF0ZVJlZjxhbnk+O1xuICB9IHwgbnVsbD4obnVsbCk7XG5cbiAgc2VydmljZXMgPSBpbnB1dDx7XG4gICAgZ2V0UHJvamVjdHMkOiAoaWRzOiBzdHJpbmdbXSkgPT4gT2JzZXJ2YWJsZTx7IGlkOiBzdHJpbmc7IG5hbWU6IHN0cmluZyB9W10+O1xuICB9IHwgbnVsbD4obnVsbCk7XG5cbiAgcm91dGluZyA9IGlucHV0PHsgW2luZGV4IGluIFJvdXRpbmdUeXBlXTogKGRhdGE6IGFueSkgPT4gdm9pZCB9IHwgbnVsbD4obnVsbCk7XG5cbiAgQE91dHB1dCgpXG4gIG5iQ2hhbmdlZDogRXZlbnRFbWl0dGVyPG51bWJlcj4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgZ2V0IG5vdGlmaWNhdGlvbnMkKCkge1xuICAgIHJldHVybiB0aGlzLl9ub3RpZmljYXRpb25EYXRhU2VydmljZS5saXN0XG4gICAgICAuZ2V0JCh0aGlzLl9ub3RpZmljYXRpb25EYXRhU2VydmljZS5jb21wdXRlS2V5KHRoaXMuZmlsdGVycygpKSlcbiAgICAgIC5waXBlKHRhcCgobGlzdCkgPT4gdGhpcy5uYkNoYW5nZWQuZW1pdChsaXN0Lmxlbmd0aCkpKTtcbiAgfVxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIF9ub3RpZmljYXRpb25EYXRhU2VydmljZTogVGFOb3RpZmljYXRpb25EYXRhU2VydmljZSxcbiAgICBwcml2YXRlIF9zaGFyZWRTZXJ2aWNlOiBUYU5vdGlmaWNhdGlvblNoYXJlZFNlcnZpY2VcbiAgKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMucmVxdWVzdFN0YXRlLmFza2VkKCk7XG4gICAgdGhpcy5fcmVnaXN0ZXJTdWJzY3JpcHRpb24oXG4gICAgICB0aGlzLl9ub3RpZmljYXRpb25EYXRhU2VydmljZVxuICAgICAgICAuZmV0Y2hOb3RpZmljYXRpb25zJCh0aGlzLmZpbHRlcnMoKSlcbiAgICAgICAgLnN1YnNjcmliZSh7XG4gICAgICAgICAgY29tcGxldGU6ICgpID0+IHRoaXMucmVxdWVzdFN0YXRlLmNvbXBsZXRlZCgpLFxuICAgICAgICAgIGVycm9yOiAoZXJyb3I6IEh0dHBFcnJvclJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlcXVlc3RTdGF0ZS5vbkVycm9yKGVycm9yLnN0YXR1cywgZXJyb3Iuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgfSlcbiAgICApO1xuXG4gICAgY29uc3QgdGVtcGxhdGVzVmFsID0gdGhpcy50ZW1wbGF0ZXMoKTtcbiAgICBpZiAodGVtcGxhdGVzVmFsKSB7XG4gICAgICB0aGlzLl9zaGFyZWRTZXJ2aWNlLnBheW1lbnRTdGF0dXNUZW1wbGF0ZSA9IHRlbXBsYXRlc1ZhbC5wYXltZW50U3RhdHVzO1xuICAgICAgdGhpcy5fc2hhcmVkU2VydmljZS5wcm9qZWN0U3RhdHVzVGVtcGxhdGUgPSB0ZW1wbGF0ZXNWYWwucHJvamVjdFN0YXR1cztcbiAgICB9XG4gICAgY29uc3Qgc2VydmljZXNWYWwgPSB0aGlzLnNlcnZpY2VzKCk7XG4gICAgaWYgKHNlcnZpY2VzVmFsKSB7XG4gICAgICB0aGlzLl9zaGFyZWRTZXJ2aWNlLmdldFByb2plY3RzJCA9IHNlcnZpY2VzVmFsLmdldFByb2plY3RzJDtcbiAgICB9XG4gICAgY29uc3Qgcm91dGluZ1ZhbCA9IHRoaXMucm91dGluZygpO1xuICAgIGlmIChyb3V0aW5nVmFsKSB7XG4gICAgICB0aGlzLl9zaGFyZWRTZXJ2aWNlLnJvdXRpbmcgPSByb3V0aW5nVmFsO1xuICAgIH1cbiAgfVxufVxuIiwiPHRhLWxvYWRlclxuICBbaXNMb2FkaW5nXT1cInRoaXMucmVxdWVzdFN0YXRlLmlzTG9hZGluZygpXCJcbiAgKm5nTGV0PVwidGhpcy5ub3RpZmljYXRpb25zJCB8IGFzeW5jIGFzIG5vdGlmaWNhdGlvbnNcIlxuPlxuICA8dGEtZXJyb3JcbiAgICBbbWVzc2FnZV09XCJ0aGlzLnJlcXVlc3RTdGF0ZS5nZXRFcnJvck1lc3NhZ2UoKVwiXG4gICAgW2NvZGVdPVwidGhpcy5yZXF1ZXN0U3RhdGUuZ2V0RXJyb3JTdGF0dXMoKVwiXG4gID5cbiAgICA8dGEtZW1wdHlcbiAgICAgIFtpc0VtcHR5XT1cIiFub3RpZmljYXRpb25zIHx8IG5vdGlmaWNhdGlvbnMubGVuZ3RoID09PSAwXCJcbiAgICAgIGljb249XCJnaG9zdFwiXG4gICAgICBbaXNMaWdodF09XCJmYWxzZVwiXG4gICAgICB0ZXh0PVwibm90aWZpY2F0aW9uLmVtcHR5XCJcbiAgICA+XG4gICAgICA8ZGl2IGNsYXNzPVwibm90aWZpY2F0aW9uLWNvbnRhaW5lclwiPlxuICAgICAgICBAZm9yIChub3RpZiBvZiB0aGlzLm5vdGlmaWNhdGlvbnM7IHRyYWNrIG5vdGlmKSB7XG4gICAgICAgIDxkaXYgY2xhc3M9XCJpdGVtLWNvbnRhaW5lciBjLXBvaW50ZXJcIj5cbiAgICAgICAgICBAc3dpdGNoIChub3RpZi50eXBlKSB7IEBjYXNlICgnUHJvamVjdFN0YXR1c0NoYW5nZWQnKSB7XG4gICAgICAgICAgPHRhLW5vdGlmaWNhdGlvbi1wcm9qZWN0LXN0YXR1cy1jaGFuZ2VkXG4gICAgICAgICAgICBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCJcbiAgICAgICAgICA+PC90YS1ub3RpZmljYXRpb24tcHJvamVjdC1zdGF0dXMtY2hhbmdlZD5cbiAgICAgICAgICB9IEBjYXNlICgnTmV3UXVvdGF0aW9uVmVyc2lvbicpIHtcbiAgICAgICAgICA8dGEtbmV3LXF1b3RhdGlvbi12ZXJzaW9uXG4gICAgICAgICAgICBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCJcbiAgICAgICAgICA+PC90YS1uZXctcXVvdGF0aW9uLXZlcnNpb24+XG4gICAgICAgICAgfSBAY2FzZSAoJ05ld0ludm9pY2UnKSB7XG4gICAgICAgICAgPHRhLW5ldy1pbnZvaWNlIFtub3RpZmljYXRpb25dPVwibm90aWZcIj48L3RhLW5ldy1pbnZvaWNlPlxuICAgICAgICAgIH0gQGNhc2UgKCdJbnZvaWNlUGF5bWVudFN0YXR1c0NoYW5nZWQnKSB7XG4gICAgICAgICAgPHRhLWludm9pY2UtcGF5bWVudC1zdGF0dXMtY2hhbmdlZFxuICAgICAgICAgICAgW25vdGlmaWNhdGlvbl09XCJub3RpZlwiXG4gICAgICAgICAgPjwvdGEtaW52b2ljZS1wYXltZW50LXN0YXR1cy1jaGFuZ2VkPlxuICAgICAgICAgIH0gQGNhc2UgKCdUYXNrQXNzaWduZWQnKSB7XG4gICAgICAgICAgPHRhLXRhc2stYXNzaWduZWQgW25vdGlmaWNhdGlvbl09XCJub3RpZlwiPjwvdGEtdGFzay1hc3NpZ25lZD5cbiAgICAgICAgICB9IEBjYXNlICgnVG9Eb0Fzc2lnbmVkJykge1xuICAgICAgICAgIDx0YS10by1kby1hc3NpZ25lZCBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS10by1kby1hc3NpZ25lZD5cbiAgICAgICAgICB9IEBjYXNlICgnVGFza0R1ZVRvZGF5Jykge1xuICAgICAgICAgIDx0YS10YXNrLWR1ZS10b2RheSBbbm90aWZpY2F0aW9uXT1cIm5vdGlmXCI+PC90YS10YXNrLWR1ZS10b2RheT5cbiAgICAgICAgICB9IEBjYXNlICgnVG9Eb0R1ZVRvZGF5Jykge1xuICAgICAgICAgIDx0YS10by1kby1kdWUtdG9kYXkgW25vdGlmaWNhdGlvbl09XCJub3RpZlwiPjwvdGEtdG8tZG8tZHVlLXRvZGF5PlxuICAgICAgICAgIH0gQGNhc2UgKCdUYXNrTmV3QWN0aXZpdHknKSB7XG4gICAgICAgICAgPHRhLXRhc2stbmV3LWFjdGl2aXR5IFtub3RpZmljYXRpb25dPVwibm90aWZcIj48L3RhLXRhc2stbmV3LWFjdGl2aXR5PlxuICAgICAgICAgIH0gQGNhc2UgKCdVc2VyVGFnZ2VkSW5Db252ZXJzYXRpb24nKSB7XG4gICAgICAgICAgPHRhLXVzZXItdGFnZ2VkLWluLWNvbnZlcnNhdGlvblxuICAgICAgICAgICAgW25vdGlmaWNhdGlvbl09XCJub3RpZlwiXG4gICAgICAgICAgPjwvdGEtdXNlci10YWdnZWQtaW4tY29udmVyc2F0aW9uPlxuICAgICAgICAgIH0gfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgfVxuICAgICAgPC9kaXY+XG4gICAgPC90YS1lbXB0eT5cbiAgPC90YS1lcnJvcj5cbjwvdGEtbG9hZGVyPlxuIl19