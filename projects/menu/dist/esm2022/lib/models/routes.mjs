export var TaMainRoute;
(function (TaMainRoute) {
    TaMainRoute["HOME"] = "HOME";
    TaMainRoute["USERLOGIN"] = "USERLOGIN";
    TaMainRoute["SINGIN"] = "SINGIN";
    TaMainRoute["USERLOGOUT"] = "USERLOGOUT";
    TaMainRoute["NOTIFICATIONS"] = "NOTIFICATIONS";
    TaMainRoute["REDIRECT"] = "REDIRECT";
})(TaMainRoute || (TaMainRoute = {}));
export class TaRoutesCore {
    constructor() {
        this.routes = [
            {
                key: TaMainRoute.HOME,
                url: '',
            },
            {
                key: TaMainRoute.USERLOGIN,
                url: 'login',
            },
            {
                key: TaMainRoute.SINGIN,
                url: 'signin',
            },
            {
                key: TaMainRoute.USERLOGOUT,
                url: 'logout',
            },
            {
                key: TaMainRoute.NOTIFICATIONS,
                url: 'notifications',
            },
            {
                key: TaMainRoute.REDIRECT,
                url: 'redirect',
            },
        ];
    }
    addRoute(route) {
        this.routes.push(route);
    }
    addRoutes(routes) {
        routes.forEach(route => this.addRoute(route));
    }
    getHome() {
        return this.getAbsoluteUrl([TaMainRoute.HOME]);
    }
    getLogin() {
        return this.getAbsoluteUrl([TaMainRoute.USERLOGIN]);
    }
    getSign() {
        return this.getAbsoluteUrl([TaMainRoute.SINGIN]);
    }
    getLogout() {
        return this.getAbsoluteUrl([TaMainRoute.USERLOGOUT]);
    }
    getUrl(eNums, params = {}, strict = false) {
        const url = this._replaceParams(this._getUrl(eNums), params);
        return strict ? this._removeParams(url) : url;
    }
    getAbsoluteUrl(eNums, params = {}, strict = false) {
        const url = this._replaceParams(this._getUrl(eNums, true), params);
        return strict ? this._removeParams(url) : url;
    }
    addQueryParamsToUrl(route, params = {}) {
        const keys = Object.keys(params);
        for (let key of keys) {
            route.params[key] = params[key];
        }
        return route.toString();
    }
    getPermission(eNums) {
        const route = this._getRouteByENum(eNums);
        if (route === null) {
            return true;
        }
        else {
            return route.canActivate === undefined ? true : route.canActivate;
        }
    }
    _replaceParams(url, params) {
        if (!params || Object.keys(params).length === 0) {
            return url;
        }
        // Create regex using the keys of the replacement object.
        const regex = new RegExp(':(' + Object.keys(params).join('|') + ')', 'g');
        // Replace the string by the value in object
        return url.replace(regex, (m, $1) => params[$1] || m);
    }
    _removeParams(url) {
        const regex = new RegExp('/:([a-zA-Z0-9_]*)', 'g');
        return url.replace(regex, '');
    }
    _getRouteByENum(eNums) {
        let route = null;
        for (const eNum of eNums) {
            route = this._getByENum(route === null ? this.routes : route.children, eNum);
            if (route === null) {
                return null;
            }
        }
        return route;
    }
    _getUrl(eNums, absolute = false) {
        let route = null;
        let url = '';
        for (const eNum of eNums) {
            route = this._getByENum(route === null ? this.routes : route.children, eNum);
            if (route === null) {
                break;
            }
            url += (url === '' ? '' : '/') + route.url;
        }
        return route === null ? '' : absolute === false ? route.url : '/' + url;
    }
    _getByENum(routes, eNum) {
        if (!routes) {
            return null;
        }
        for (const route of routes) {
            if (route.key === eNum) {
                return route;
            }
        }
        return null;
    }
}
export const TaRoutes = new TaRoutesCore();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9tb2RlbHMvcm91dGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE1BQU0sQ0FBTixJQUFZLFdBT1g7QUFQRCxXQUFZLFdBQVc7SUFDckIsNEJBQWEsQ0FBQTtJQUNiLHNDQUF1QixDQUFBO0lBQ3ZCLGdDQUFpQixDQUFBO0lBQ2pCLHdDQUF5QixDQUFBO0lBQ3pCLDhDQUErQixDQUFBO0lBQy9CLG9DQUFxQixDQUFBO0FBQ3ZCLENBQUMsRUFQVyxXQUFXLEtBQVgsV0FBVyxRQU90QjtBQVFELE1BQU0sT0FBTyxZQUFZO0lBNEJ2QjtRQTNCTyxXQUFNLEdBQWE7WUFDeEI7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxJQUFJO2dCQUNyQixHQUFHLEVBQUUsRUFBRTthQUNSO1lBQ0Q7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxTQUFTO2dCQUMxQixHQUFHLEVBQUUsT0FBTzthQUNiO1lBQ0Q7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxNQUFNO2dCQUN2QixHQUFHLEVBQUUsUUFBUTthQUNkO1lBQ0Q7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxVQUFVO2dCQUMzQixHQUFHLEVBQUUsUUFBUTthQUNkO1lBQ0Q7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxhQUFhO2dCQUM5QixHQUFHLEVBQUUsZUFBZTthQUNyQjtZQUNEO2dCQUNFLEdBQUcsRUFBRSxXQUFXLENBQUMsUUFBUTtnQkFDekIsR0FBRyxFQUFFLFVBQVU7YUFDaEI7U0FDRixDQUFDO0lBRWEsQ0FBQztJQUVULFFBQVEsQ0FBQyxLQUFhO1FBQzNCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzFCLENBQUM7SUFDTSxTQUFTLENBQUMsTUFBZ0I7UUFDL0IsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLElB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LENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDO1FBQzdDLENBQUM7UUFDRCxPQUFPLEtBQUssS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztJQUMxRSxDQUFDO0lBRU8sVUFBVSxDQUFDLE1BQW1DLEVBQUUsSUFBWTtRQUNsRSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDWixPQUFPLElBQUksQ0FBQztRQUNkLENBQUM7UUFDRCxLQUFLLE1BQU0sS0FBSyxJQUFJLE1BQU0sRUFBRSxDQUFDO1lBQzNCLElBQUksS0FBSyxDQUFDLEdBQUcsS0FBSyxJQUFJLEVBQUUsQ0FBQztnQkFDdkIsT0FBTyxLQUFLLENBQUM7WUFDZixDQUFDO1FBQ0gsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztDQUNGO0FBQ0QsTUFBTSxDQUFDLE1BQU0sUUFBUSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90IH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcblxuZXhwb3J0IGVudW0gVGFNYWluUm91dGUge1xuICBIT01FID0gJ0hPTUUnLFxuICBVU0VSTE9HSU4gPSAnVVNFUkxPR0lOJyxcbiAgU0lOR0lOID0gJ1NJTkdJTicsXG4gIFVTRVJMT0dPVVQgPSAnVVNFUkxPR09VVCcsXG4gIE5PVElGSUNBVElPTlMgPSAnTk9USUZJQ0FUSU9OUycsXG4gIFJFRElSRUNUID0gJ1JFRElSRUNUJyxcbn1cbmV4cG9ydCBpbnRlcmZhY2UgSVJvdXRlIHtcbiAga2V5OiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICBjYW5BY3RpdmF0ZT86IGJvb2xlYW47XG4gIGNoaWxkcmVuPzogSVJvdXRlW107XG59XG5cbmV4cG9ydCBjbGFzcyBUYVJvdXRlc0NvcmUge1xuICBwdWJsaWMgcm91dGVzOiBJUm91dGVbXSA9IFtcbiAgICB7XG4gICAgICBrZXk6IFRhTWFpblJvdXRlLkhPTUUsXG4gICAgICB1cmw6ICcnLFxuICAgIH0sXG4gICAge1xuICAgICAga2V5OiBUYU1haW5Sb3V0ZS5VU0VSTE9HSU4sXG4gICAgICB1cmw6ICdsb2dpbicsXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFRhTWFpblJvdXRlLlNJTkdJTixcbiAgICAgIHVybDogJ3NpZ25pbicsXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFRhTWFpblJvdXRlLlVTRVJMT0dPVVQsXG4gICAgICB1cmw6ICdsb2dvdXQnLFxuICAgIH0sXG4gICAge1xuICAgICAga2V5OiBUYU1haW5Sb3V0ZS5OT1RJRklDQVRJT05TLFxuICAgICAgdXJsOiAnbm90aWZpY2F0aW9ucycsXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFRhTWFpblJvdXRlLlJFRElSRUNULFxuICAgICAgdXJsOiAncmVkaXJlY3QnLFxuICAgIH0sXG4gIF07XG5cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIHB1YmxpYyBhZGRSb3V0ZShyb3V0ZTogSVJvdXRlKSB7XG4gICAgdGhpcy5yb3V0ZXMucHVzaChyb3V0ZSk7XG4gIH1cbiAgcHVibGljIGFkZFJvdXRlcyhyb3V0ZXM6IElSb3V0ZVtdKSB7XG4gICAgcm91dGVzLmZvckVhY2gocm91dGUgPT4gdGhpcy5hZGRSb3V0ZShyb3V0ZSkpO1xuICB9XG4gIHB1YmxpYyBnZXRIb21lKCkge1xuICAgIHJldHVybiB0aGlzLmdldEFic29sdXRlVXJsKFtUYU1haW5Sb3V0ZS5IT01FXSk7XG4gIH1cbiAgcHVibGljIGdldExvZ2luKCkge1xuICAgIHJldHVybiB0aGlzLmdldEFic29sdXRlVXJsKFtUYU1haW5Sb3V0ZS5VU0VSTE9HSU5dKTtcbiAgfVxuICBwdWJsaWMgZ2V0U2lnbigpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBYnNvbHV0ZVVybChbVGFNYWluUm91dGUuU0lOR0lOXSk7XG4gIH1cbiAgcHVibGljIGdldExvZ291dCgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBYnNvbHV0ZVVybChbVGFNYWluUm91dGUuVVNFUkxPR09VVF0pO1xuICB9XG4gIHB1YmxpYyBnZXRVcmwoZU51bXM6IHN0cmluZ1tdLCBwYXJhbXM6IHt9ID0ge30sIHN0cmljdCA9IGZhbHNlKTogc3RyaW5nIHtcbiAgICBjb25zdCB1cmwgPSB0aGlzLl9yZXBsYWNlUGFyYW1zKHRoaXMuX2dldFVybChlTnVtcyksIHBhcmFtcyk7XG4gICAgcmV0dXJuIHN0cmljdCA/IHRoaXMuX3JlbW92ZVBhcmFtcyh1cmwpIDogdXJsO1xuICB9XG4gIHB1YmxpYyBnZXRBYnNvbHV0ZVVybChlTnVtczogc3RyaW5nW10sIHBhcmFtczoge30gPSB7fSwgc3RyaWN0ID0gZmFsc2UpOiBzdHJpbmcge1xuICAgIGNvbnN0IHVybCA9IHRoaXMuX3JlcGxhY2VQYXJhbXModGhpcy5fZ2V0VXJsKGVOdW1zLCB0cnVlKSwgcGFyYW1zKTtcbiAgICByZXR1cm4gc3RyaWN0ID8gdGhpcy5fcmVtb3ZlUGFyYW1zKHVybCkgOiB1cmw7XG4gIH1cbiAgcHVibGljIGFkZFF1ZXJ5UGFyYW1zVG9Vcmwocm91dGU6IEFjdGl2YXRlZFJvdXRlU25hcHNob3QsIHBhcmFtczogeyBbaW5kZXg6IHN0cmluZ106IGFueSB9ID0ge30pOiBzdHJpbmcge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhwYXJhbXMpO1xuXG4gICAgZm9yIChsZXQga2V5IG9mIGtleXMpIHtcbiAgICAgIHJvdXRlLnBhcmFtc1trZXldID0gcGFyYW1zW2tleV07XG4gICAgfVxuICAgIHJldHVybiByb3V0ZS50b1N0cmluZygpO1xuICB9XG4gIHB1YmxpYyBnZXRQZXJtaXNzaW9uKGVOdW1zOiBhbnlbXSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHJvdXRlID0gdGhpcy5fZ2V0Um91dGVCeUVOdW0oZU51bXMpO1xuICAgIGlmIChyb3V0ZSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByb3V0ZS5jYW5BY3RpdmF0ZSA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IHJvdXRlLmNhbkFjdGl2YXRlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX3JlcGxhY2VQYXJhbXModXJsOiBzdHJpbmcsIHBhcmFtczogYW55KTogc3RyaW5nIHtcbiAgICBpZiAoIXBhcmFtcyB8fCBPYmplY3Qua2V5cyhwYXJhbXMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG4gICAgLy8gQ3JlYXRlIHJlZ2V4IHVzaW5nIHRoZSBrZXlzIG9mIHRoZSByZXBsYWNlbWVudCBvYmplY3QuXG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKCc6KCcgKyBPYmplY3Qua2V5cyhwYXJhbXMpLmpvaW4oJ3wnKSArICcpJywgJ2cnKTtcbiAgICAvLyBSZXBsYWNlIHRoZSBzdHJpbmcgYnkgdGhlIHZhbHVlIGluIG9iamVjdFxuICAgIHJldHVybiB1cmwucmVwbGFjZShyZWdleCwgKG0sICQxKSA9PiBwYXJhbXNbJDFdIHx8IG0pO1xuICB9XG4gIHByaXZhdGUgX3JlbW92ZVBhcmFtcyh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKCcvOihbYS16QS1aMC05X10qKScsICdnJyk7XG4gICAgcmV0dXJuIHVybC5yZXBsYWNlKHJlZ2V4LCAnJyk7XG4gIH1cbiAgcHJpdmF0ZSBfZ2V0Um91dGVCeUVOdW0oZU51bXM6IGFueVtdKTogSVJvdXRlIHwgbnVsbCB7XG4gICAgbGV0IHJvdXRlOiBJUm91dGUgfCBudWxsID0gbnVsbDtcbiAgICBmb3IgKGNvbnN0IGVOdW0gb2YgZU51bXMpIHtcbiAgICAgIHJvdXRlID0gdGhpcy5fZ2V0QnlFTnVtKHJvdXRlID09PSBudWxsID8gdGhpcy5yb3V0ZXMgOiByb3V0ZS5jaGlsZHJlbiwgZU51bSk7XG4gICAgICBpZiAocm91dGUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByb3V0ZTtcbiAgfVxuXG4gIHByaXZhdGUgX2dldFVybChlTnVtczogYW55W10sIGFic29sdXRlID0gZmFsc2UpOiBzdHJpbmcge1xuICAgIGxldCByb3V0ZTogSVJvdXRlIHwgbnVsbCA9IG51bGw7XG4gICAgbGV0IHVybCA9ICcnO1xuICAgIGZvciAoY29uc3QgZU51bSBvZiBlTnVtcykge1xuICAgICAgcm91dGUgPSB0aGlzLl9nZXRCeUVOdW0ocm91dGUgPT09IG51bGwgPyB0aGlzLnJvdXRlcyA6IHJvdXRlLmNoaWxkcmVuLCBlTnVtKTtcbiAgICAgIGlmIChyb3V0ZSA9PT0gbnVsbCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHVybCArPSAodXJsID09PSAnJyA/ICcnIDogJy8nKSArIHJvdXRlLnVybDtcbiAgICB9XG4gICAgcmV0dXJuIHJvdXRlID09PSBudWxsID8gJycgOiBhYnNvbHV0ZSA9PT0gZmFsc2UgPyByb3V0ZS51cmwgOiAnLycgKyB1cmw7XG4gIH1cblxuICBwcml2YXRlIF9nZXRCeUVOdW0ocm91dGVzOiBJUm91dGVbXSB8IG51bGwgfCB1bmRlZmluZWQsIGVOdW06IHN0cmluZyk6IElSb3V0ZSB8IG51bGwge1xuICAgIGlmICghcm91dGVzKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgZm9yIChjb25zdCByb3V0ZSBvZiByb3V0ZXMpIHtcbiAgICAgIGlmIChyb3V0ZS5rZXkgPT09IGVOdW0pIHtcbiAgICAgICAgcmV0dXJuIHJvdXRlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuZXhwb3J0IGNvbnN0IFRhUm91dGVzID0gbmV3IFRhUm91dGVzQ29yZSgpO1xuIl19