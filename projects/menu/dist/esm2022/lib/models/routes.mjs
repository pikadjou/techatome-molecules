export var TaMainRoute;
(function (TaMainRoute) {
    TaMainRoute["HOME"] = "HOME";
    TaMainRoute["USERLOGIN"] = "USERLOGIN";
    TaMainRoute["SINGIN"] = "SINGIN";
    TaMainRoute["USERLOGOUT"] = "USERLOGOUT";
    TaMainRoute["NOTIFICATIONS"] = "NOTIFICATIONS";
    TaMainRoute["REDIRECT"] = "REDIRECT";
})(TaMainRoute || (TaMainRoute = {}));
export class TaRoutesCore {
    constructor() {
        this.routes = [
            {
                key: TaMainRoute.HOME,
                url: "",
            },
            {
                key: TaMainRoute.USERLOGIN,
                url: "login",
            },
            {
                key: TaMainRoute.SINGIN,
                url: "signin",
            },
            {
                key: TaMainRoute.USERLOGOUT,
                url: "logout",
            },
            {
                key: TaMainRoute.NOTIFICATIONS,
                url: "notifications",
            },
            {
                key: TaMainRoute.REDIRECT,
                url: "redirect",
            },
        ];
    }
    addRoute(route) {
        this.routes.push(route);
    }
    addRoutes(routes) {
        routes.forEach((route) => this.addRoute(route));
    }
    getHome() {
        return this.getAbsoluteUrl([TaMainRoute.HOME]);
    }
    getLogin() {
        return this.getAbsoluteUrl([TaMainRoute.USERLOGIN]);
    }
    getSign() {
        return this.getAbsoluteUrl([TaMainRoute.SINGIN]);
    }
    getLogout() {
        return this.getAbsoluteUrl([TaMainRoute.USERLOGOUT]);
    }
    getUrl(eNums, params = {}, strict = false) {
        const url = this._replaceParams(this._getUrl(eNums), params);
        return strict ? this._removeParams(url) : url;
    }
    getAbsoluteUrl(eNums, params = {}, strict = false) {
        const url = this._replaceParams(this._getUrl(eNums, true), params);
        return strict ? this._removeParams(url) : url;
    }
    addQueryParamsToUrl(route, params = {}) {
        const keys = Object.keys(params);
        for (let key of keys) {
            route.params[key] = params[key];
        }
        return route.toString();
    }
    getPermission(eNums) {
        const route = this._getRouteByENum(eNums);
        if (route === null) {
            return true;
        }
        else {
            return route.canActivate === undefined ? true : route.canActivate;
        }
    }
    _replaceParams(url, params) {
        if (!params || Object.keys(params).length === 0) {
            return url;
        }
        // Create regex using the keys of the replacement object.
        const regex = new RegExp(":(" + Object.keys(params).join("|") + ")", "g");
        // Replace the string by the value in object
        return url.replace(regex, (m, $1) => params[$1] || m);
    }
    _removeParams(url) {
        const regex = new RegExp("/:([a-zA-Z0-9_]*)", "g");
        return url.replace(regex, "");
    }
    _getRouteByENum(eNums) {
        let route = null;
        for (const eNum of eNums) {
            route = this._getByENum(route === null ? this.routes : route.children, eNum);
            if (route === null) {
                return null;
            }
        }
        return route;
    }
    _getUrl(eNums, absolute = false) {
        let route = null;
        let url = "";
        for (const eNum of eNums) {
            route = this._getByENum(route === null ? this.routes : route.children, eNum);
            if (route === null) {
                break;
            }
            url += (url === "" ? "" : "/") + route.url;
        }
        return route === null ? "" : absolute === false ? route.url : "/" + url;
    }
    _getByENum(routes, eNum) {
        if (!routes) {
            return null;
        }
        for (const route of routes) {
            if (route.key === eNum) {
                return route;
            }
        }
        return null;
    }
}
export const TaRoutes = new TaRoutesCore();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9tb2RlbHMvcm91dGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE1BQU0sQ0FBTixJQUFZLFdBT1g7QUFQRCxXQUFZLFdBQVc7SUFDckIsNEJBQWEsQ0FBQTtJQUNiLHNDQUF1QixDQUFBO0lBQ3ZCLGdDQUFpQixDQUFBO0lBQ2pCLHdDQUF5QixDQUFBO0lBQ3pCLDhDQUErQixDQUFBO0lBQy9CLG9DQUFxQixDQUFBO0FBQ3ZCLENBQUMsRUFQVyxXQUFXLEtBQVgsV0FBVyxRQU90QjtBQVFELE1BQU0sT0FBTyxZQUFZO0lBNEJ2QjtRQTNCTyxXQUFNLEdBQWE7WUFDeEI7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxJQUFJO2dCQUNyQixHQUFHLEVBQUUsRUFBRTthQUNSO1lBQ0Q7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxTQUFTO2dCQUMxQixHQUFHLEVBQUUsT0FBTzthQUNiO1lBQ0Q7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxNQUFNO2dCQUN2QixHQUFHLEVBQUUsUUFBUTthQUNkO1lBQ0Q7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxVQUFVO2dCQUMzQixHQUFHLEVBQUUsUUFBUTthQUNkO1lBQ0Q7Z0JBQ0UsR0FBRyxFQUFFLFdBQVcsQ0FBQyxhQUFhO2dCQUM5QixHQUFHLEVBQUUsZUFBZTthQUNyQjtZQUNEO2dCQUNFLEdBQUcsRUFBRSxXQUFXLENBQUMsUUFBUTtnQkFDekIsR0FBRyxFQUFFLFVBQVU7YUFDaEI7U0FDRixDQUFDO0lBRWEsQ0FBQztJQUVULFFBQVEsQ0FBQyxLQUFhO1FBQzNCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzFCLENBQUM7SUFDTSxTQUFTLENBQUMsTUFBZ0I7UUFDL0IsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENB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Q0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDO1FBQzdDLENBQUM7UUFDRCxPQUFPLEtBQUssS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztJQUMxRSxDQUFDO0lBRU8sVUFBVSxDQUNoQixNQUFtQyxFQUNuQyxJQUFZO1FBRVosSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ1osT0FBTyxJQUFJLENBQUM7UUFDZCxDQUFDO1FBQ0QsS0FBSyxNQUFNLEtBQUssSUFBSSxNQUFNLEVBQUUsQ0FBQztZQUMzQixJQUFJLEtBQUssQ0FBQyxHQUFHLEtBQUssSUFBSSxFQUFFLENBQUM7Z0JBQ3ZCLE9BQU8sS0FBSyxDQUFDO1lBQ2YsQ0FBQztRQUNILENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7Q0FDRjtBQUNELE1BQU0sQ0FBQyxNQUFNLFFBQVEsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWN0aXZhdGVkUm91dGVTbmFwc2hvdCB9IGZyb20gXCJAYW5ndWxhci9yb3V0ZXJcIjtcblxuZXhwb3J0IGVudW0gVGFNYWluUm91dGUge1xuICBIT01FID0gXCJIT01FXCIsXG4gIFVTRVJMT0dJTiA9IFwiVVNFUkxPR0lOXCIsXG4gIFNJTkdJTiA9IFwiU0lOR0lOXCIsXG4gIFVTRVJMT0dPVVQgPSBcIlVTRVJMT0dPVVRcIixcbiAgTk9USUZJQ0FUSU9OUyA9IFwiTk9USUZJQ0FUSU9OU1wiLFxuICBSRURJUkVDVCA9IFwiUkVESVJFQ1RcIixcbn1cbmV4cG9ydCBpbnRlcmZhY2UgSVJvdXRlIHtcbiAga2V5OiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICBjYW5BY3RpdmF0ZT86IGJvb2xlYW47XG4gIGNoaWxkcmVuPzogSVJvdXRlW107XG59XG5cbmV4cG9ydCBjbGFzcyBUYVJvdXRlc0NvcmUge1xuICBwdWJsaWMgcm91dGVzOiBJUm91dGVbXSA9IFtcbiAgICB7XG4gICAgICBrZXk6IFRhTWFpblJvdXRlLkhPTUUsXG4gICAgICB1cmw6IFwiXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFRhTWFpblJvdXRlLlVTRVJMT0dJTixcbiAgICAgIHVybDogXCJsb2dpblwiLFxuICAgIH0sXG4gICAge1xuICAgICAga2V5OiBUYU1haW5Sb3V0ZS5TSU5HSU4sXG4gICAgICB1cmw6IFwic2lnbmluXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFRhTWFpblJvdXRlLlVTRVJMT0dPVVQsXG4gICAgICB1cmw6IFwibG9nb3V0XCIsXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFRhTWFpblJvdXRlLk5PVElGSUNBVElPTlMsXG4gICAgICB1cmw6IFwibm90aWZpY2F0aW9uc1wiLFxuICAgIH0sXG4gICAge1xuICAgICAga2V5OiBUYU1haW5Sb3V0ZS5SRURJUkVDVCxcbiAgICAgIHVybDogXCJyZWRpcmVjdFwiLFxuICAgIH0sXG4gIF07XG5cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIHB1YmxpYyBhZGRSb3V0ZShyb3V0ZTogSVJvdXRlKSB7XG4gICAgdGhpcy5yb3V0ZXMucHVzaChyb3V0ZSk7XG4gIH1cbiAgcHVibGljIGFkZFJvdXRlcyhyb3V0ZXM6IElSb3V0ZVtdKSB7XG4gICAgcm91dGVzLmZvckVhY2goKHJvdXRlKSA9PiB0aGlzLmFkZFJvdXRlKHJvdXRlKSk7XG4gIH1cbiAgcHVibGljIGdldEhvbWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QWJzb2x1dGVVcmwoW1RhTWFpblJvdXRlLkhPTUVdKTtcbiAgfVxuICBwdWJsaWMgZ2V0TG9naW4oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QWJzb2x1dGVVcmwoW1RhTWFpblJvdXRlLlVTRVJMT0dJTl0pO1xuICB9XG4gIHB1YmxpYyBnZXRTaWduKCkge1xuICAgIHJldHVybiB0aGlzLmdldEFic29sdXRlVXJsKFtUYU1haW5Sb3V0ZS5TSU5HSU5dKTtcbiAgfVxuICBwdWJsaWMgZ2V0TG9nb3V0KCkge1xuICAgIHJldHVybiB0aGlzLmdldEFic29sdXRlVXJsKFtUYU1haW5Sb3V0ZS5VU0VSTE9HT1VUXSk7XG4gIH1cbiAgcHVibGljIGdldFVybChlTnVtczogc3RyaW5nW10sIHBhcmFtczoge30gPSB7fSwgc3RyaWN0ID0gZmFsc2UpOiBzdHJpbmcge1xuICAgIGNvbnN0IHVybCA9IHRoaXMuX3JlcGxhY2VQYXJhbXModGhpcy5fZ2V0VXJsKGVOdW1zKSwgcGFyYW1zKTtcbiAgICByZXR1cm4gc3RyaWN0ID8gdGhpcy5fcmVtb3ZlUGFyYW1zKHVybCkgOiB1cmw7XG4gIH1cbiAgcHVibGljIGdldEFic29sdXRlVXJsKFxuICAgIGVOdW1zOiBzdHJpbmdbXSxcbiAgICBwYXJhbXM6IHt9ID0ge30sXG4gICAgc3RyaWN0ID0gZmFsc2VcbiAgKTogc3RyaW5nIHtcbiAgICBjb25zdCB1cmwgPSB0aGlzLl9yZXBsYWNlUGFyYW1zKHRoaXMuX2dldFVybChlTnVtcywgdHJ1ZSksIHBhcmFtcyk7XG4gICAgcmV0dXJuIHN0cmljdCA/IHRoaXMuX3JlbW92ZVBhcmFtcyh1cmwpIDogdXJsO1xuICB9XG4gIHB1YmxpYyBhZGRRdWVyeVBhcmFtc1RvVXJsKFxuICAgIHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90LFxuICAgIHBhcmFtczogeyBbaW5kZXg6IHN0cmluZ106IGFueSB9ID0ge31cbiAgKTogc3RyaW5nIHtcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMocGFyYW1zKTtcblxuICAgIGZvciAobGV0IGtleSBvZiBrZXlzKSB7XG4gICAgICByb3V0ZS5wYXJhbXNba2V5XSA9IHBhcmFtc1trZXldO1xuICAgIH1cbiAgICByZXR1cm4gcm91dGUudG9TdHJpbmcoKTtcbiAgfVxuICBwdWJsaWMgZ2V0UGVybWlzc2lvbihlTnVtczogYW55W10pOiBib29sZWFuIHtcbiAgICBjb25zdCByb3V0ZSA9IHRoaXMuX2dldFJvdXRlQnlFTnVtKGVOdW1zKTtcbiAgICBpZiAocm91dGUgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcm91dGUuY2FuQWN0aXZhdGUgPT09IHVuZGVmaW5lZCA/IHRydWUgOiByb3V0ZS5jYW5BY3RpdmF0ZTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9yZXBsYWNlUGFyYW1zKHVybDogc3RyaW5nLCBwYXJhbXM6IGFueSk6IHN0cmluZyB7XG4gICAgaWYgKCFwYXJhbXMgfHwgT2JqZWN0LmtleXMocGFyYW1zKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfVxuICAgIC8vIENyZWF0ZSByZWdleCB1c2luZyB0aGUga2V5cyBvZiB0aGUgcmVwbGFjZW1lbnQgb2JqZWN0LlxuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChcIjooXCIgKyBPYmplY3Qua2V5cyhwYXJhbXMpLmpvaW4oXCJ8XCIpICsgXCIpXCIsIFwiZ1wiKTtcbiAgICAvLyBSZXBsYWNlIHRoZSBzdHJpbmcgYnkgdGhlIHZhbHVlIGluIG9iamVjdFxuICAgIHJldHVybiB1cmwucmVwbGFjZShyZWdleCwgKG0sICQxKSA9PiBwYXJhbXNbJDFdIHx8IG0pO1xuICB9XG4gIHByaXZhdGUgX3JlbW92ZVBhcmFtcyh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKFwiLzooW2EtekEtWjAtOV9dKilcIiwgXCJnXCIpO1xuICAgIHJldHVybiB1cmwucmVwbGFjZShyZWdleCwgXCJcIik7XG4gIH1cbiAgcHJpdmF0ZSBfZ2V0Um91dGVCeUVOdW0oZU51bXM6IGFueVtdKTogSVJvdXRlIHwgbnVsbCB7XG4gICAgbGV0IHJvdXRlOiBJUm91dGUgfCBudWxsID0gbnVsbDtcbiAgICBmb3IgKGNvbnN0IGVOdW0gb2YgZU51bXMpIHtcbiAgICAgIHJvdXRlID0gdGhpcy5fZ2V0QnlFTnVtKFxuICAgICAgICByb3V0ZSA9PT0gbnVsbCA/IHRoaXMucm91dGVzIDogcm91dGUuY2hpbGRyZW4sXG4gICAgICAgIGVOdW1cbiAgICAgICk7XG4gICAgICBpZiAocm91dGUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByb3V0ZTtcbiAgfVxuXG4gIHByaXZhdGUgX2dldFVybChlTnVtczogYW55W10sIGFic29sdXRlID0gZmFsc2UpOiBzdHJpbmcge1xuICAgIGxldCByb3V0ZTogSVJvdXRlIHwgbnVsbCA9IG51bGw7XG4gICAgbGV0IHVybCA9IFwiXCI7XG4gICAgZm9yIChjb25zdCBlTnVtIG9mIGVOdW1zKSB7XG4gICAgICByb3V0ZSA9IHRoaXMuX2dldEJ5RU51bShcbiAgICAgICAgcm91dGUgPT09IG51bGwgPyB0aGlzLnJvdXRlcyA6IHJvdXRlLmNoaWxkcmVuLFxuICAgICAgICBlTnVtXG4gICAgICApO1xuICAgICAgaWYgKHJvdXRlID09PSBudWxsKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgdXJsICs9ICh1cmwgPT09IFwiXCIgPyBcIlwiIDogXCIvXCIpICsgcm91dGUudXJsO1xuICAgIH1cbiAgICByZXR1cm4gcm91dGUgPT09IG51bGwgPyBcIlwiIDogYWJzb2x1dGUgPT09IGZhbHNlID8gcm91dGUudXJsIDogXCIvXCIgKyB1cmw7XG4gIH1cblxuICBwcml2YXRlIF9nZXRCeUVOdW0oXG4gICAgcm91dGVzOiBJUm91dGVbXSB8IG51bGwgfCB1bmRlZmluZWQsXG4gICAgZU51bTogc3RyaW5nXG4gICk6IElSb3V0ZSB8IG51bGwge1xuICAgIGlmICghcm91dGVzKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgZm9yIChjb25zdCByb3V0ZSBvZiByb3V0ZXMpIHtcbiAgICAgIGlmIChyb3V0ZS5rZXkgPT09IGVOdW0pIHtcbiAgICAgICAgcmV0dXJuIHJvdXRlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuZXhwb3J0IGNvbnN0IFRhUm91dGVzID0gbmV3IFRhUm91dGVzQ29yZSgpO1xuIl19