import { AsyncPipe, NgClass, NgTemplateOutlet } from '@angular/common';
import { Component, input } from '@angular/core';
import { RouterModule } from '@angular/router';
import { TranslateModule } from '@ngx-translate/core';
import { FontIconComponent } from '@ta/icons';
import { LabelComponent, SwiperLightComponent } from '@ta/ui';
import { TaAbstractComponent, TypedTemplateDirective } from '@ta/utils';
import { getFontIcon, hasFontIcon } from '../../helpers/icon-manager';
import { TaTranslationMenu } from '../../translation.service';
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "@ngx-translate/core";
export class NavigationComponent extends TaAbstractComponent {
    constructor() {
        super();
        this.menu = input.required();
        this.container = input.required();
        this.swiper = input(false);
        this.options = input({});
        this.manuallyChanged$ = input();
        this.hasFontIcon = hasFontIcon;
        this.getFontIcon = getFontIcon;
        this.activeKey = '';
        TaTranslationMenu.getInstance();
    }
    ngOnInit() {
        const defaultOpen = this.menu().elements.find(e => e.defaultOpen);
        if (!defaultOpen || !defaultOpen.callback) {
            return;
        }
        this.callback(defaultOpen);
        const manuallyChanged = this.manuallyChanged$();
        if (manuallyChanged) {
            this._registerSubscription(manuallyChanged.subscribe({
                next: (key) => {
                    const found = this.menu().elements.find(element => element.key === key);
                    if (found) {
                        this.callback(found);
                    }
                },
            }));
        }
    }
    getSpaceClass() {
        if (this.options().spaceElement === null) {
            return '';
        }
        return `g-space-${this.options().spaceElement ?? 'lg'}`;
    }
    getLink(item) {
        if (item.link && item.link !== '') {
            return item.link;
        }
        return ''; // TODO this._navigationService.currentPageUrl;
    }
    callback(item) {
        if (item.disabled) {
            return;
        }
        this.activeKey = item.key;
        if (item.callback) {
            item.callback();
        }
    }
    isActive(item) {
        return item.key === this.activeKey;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: NavigationComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.14", type: NavigationComponent, isStandalone: true, selector: "ta-menu-navigation", inputs: { menu: { classPropertyName: "menu", publicName: "menu", isSignal: true, isRequired: true, transformFunction: null }, container: { classPropertyName: "container", publicName: "container", isSignal: true, isRequired: true, transformFunction: null }, swiper: { classPropertyName: "swiper", publicName: "swiper", isSignal: true, isRequired: false, transformFunction: null }, options: { classPropertyName: "options", publicName: "options", isSignal: true, isRequired: false, transformFunction: null }, manuallyChanged$: { classPropertyName: "manuallyChanged$", publicName: "manuallyChanged$", isSignal: true, isRequired: false, transformFunction: null } }, usesInheritance: true, ngImport: i0, template: "<div class=\"navigation-container\" [class]=\"this.container()\">\n  <div class=\"list\">\n    @if (this.swiper()) {\n      <ta-swiper-light\n        [items]=\"this.menu().elements\"\n        [template]=\"template\"\n        [forced]=\"true\"\n        [swiperClasses]=\"this.getSpaceClass()\"\n      ></ta-swiper-light>\n    } @else {\n      <div class=\"element-list\" [ngClass]=\"this.menu().direction + ' ' + this.getSpaceClass()\">\n        @for (element of this.menu().elements; track element) {\n          @let visible = element.visible$ | async;\n          @if (visible) {\n            <div class=\"element\">\n              <ng-template\n                [ngTemplateOutlet]=\"template\"\n                [ngTemplateOutletContext]=\"{\n                  element: element,\n                }\"\n              >\n              </ng-template>\n            </div>\n          }\n        }\n      </div>\n    }\n  </div>\n</div>\n\n<ng-template #template let-element=\"element\">\n  <div class=\"c-pointer flex-full\">\n    @if (element.callback || element.disabled) {\n      <div\n        (click)=\"this.callback(element)\"\n        class=\"item-container flex-full\"\n        [ngClass]=\"{ active: this.isActive(element), disabled: element.disabled }\"\n      >\n        <ng-template\n          [ngTemplateOutlet]=\"Item\"\n          [ngTemplateOutletContext]=\"{\n            item: element,\n          }\"\n        >\n        </ng-template>\n      </div>\n    } @else {\n      <div\n        class=\"item-container flex-full\"\n        routerLinkActive=\"active\"\n        [routerLinkActiveOptions]=\"{ exact: element.exact }\"\n        [routerLink]=\"[this.getLink(element)]\"\n        [queryParamsHandling]=\"element.queryParamsHandling\"\n      >\n        <ng-template\n          [ngTemplateOutlet]=\"Item\"\n          [ngTemplateOutletContext]=\"{\n            item: element,\n          }\"\n        >\n        </ng-template>\n      </div>\n    }\n  </div>\n</ng-template>\n\n<ng-template #Item let-item=\"item\" [typedTemplate]=\"this.typeItem\">\n  <div class=\"item flex-full flex-start g-space-sm\" [class.disabled]=\"item.disabled\">\n    @if (this.hasFontIcon(item)) {\n      <div class=\"icon\">\n        <ta-font-icon [name]=\"this.getFontIcon(item)\"></ta-font-icon>\n      </div>\n    }\n    @if (item.label) {\n      <div class=\"label\">\n        {{ item.label | translate }}\n      </div>\n    }\n    @if (item.options?.notificationBadge?.label) {\n      <ta-label [style]=\"item.options?.notificationBadge?.style\" size=\"xs\" type=\"warning\">\n        {{ item.options?.notificationBadge?.label || 0 }}\n      </ta-label>\n    }\n    @if (item.translationData?.length) {\n      <div class=\"bullet\">({{ item.translationData?.length }})</div>\n    }\n  </div>\n</ng-template>\n", styles: [".element-list{gap:var(--ta-space-md);display:flex;flex-direction:row}.element-list .item-container{cursor:pointer}.element-list .item-container.disabled{cursor:not-allowed}.element-list.vertical{display:flex;flex-direction:column}.tags .item-container .item{flex-direction:row;display:flex;align-items:center;gap:var(--ta-space-xs);padding:var(--ta-space-md);border:1px solid transparent;color:var(--ta-text-tertiary);background-color:var(--ta-surface-tertiary);border-color:var(--ta-surface-tertiary);border-radius:var(--ta-radius-rounded);font-size:var(--ta-font-body-sm-default-size);font-weight:var(--ta-font-body-sm-default-weight)}.tags .item-container.disabled .item{background-color:var(--ta-surface-primary);border-color:var(--ta-border-disabled)}.tags .item-container.active .item{color:var(--ta-text-brand-primary);background-color:var(--ta-surface-default);border-color:var(--ta-surface-default)}.tab .list{border-bottom:1px solid var(--ta-border-secondary)}.tab .item-container .item{flex-direction:row;display:flex;align-items:center;gap:var(--ta-space-xs);padding:var(--ta-space-md);border-bottom:2px solid transparent;color:var(--ta-text-tertiary);font-size:var(--ta-font-body-sm-default-size);font-weight:var(--ta-font-body-sm-default-weight)}.tab .item-container.disabled{opacity:.5}.tab .item-container.active .item{color:var(--ta-text-brand-primary);border-bottom-color:var(--ta-border-brand)}.submenu{padding:var(--ta-space-xs);background-color:var(--ta-surface-default);border-radius:var(--ta-radius-rounded)}.submenu .element-list{gap:var(--ta-space-xs);display:flex;flex-direction:row;justify-content:space-between}.submenu .element-list .element{display:flex;flex:1 1 auto}.submenu .item-container .item{flex-direction:row;align-items:center;display:flex;justify-content:center;margin:auto;padding:var(--ta-space-sm);border-radius:var(--ta-radius-rounded);color:var(--ta-text-secondary);font-size:var(--ta-font-body-md-default-size);font-weight:var(--ta-font-body-md-default-weight)}.submenu .item-container.disabled{opacity:.5}.submenu .item-container.active .item{background-color:var(--ta-surface-primary);color:var(--ta-text-brand-primary);font-size:var(--ta-font-body-md-default-size);font-weight:var(--ta-font-body-md-bold-weight)}.submenu .item-container:hover .item{color:var(--ta-text-brand-primary);font-size:var(--ta-font-body-md-default-size);font-weight:var(--ta-font-body-md-bold-weight)}:host ::ng-deep .swiper-container{gap:var(--ta-space-sm)!important}:host ::ng-deep ta-font-icon{margin-top:-6px;display:block}:host ::ng-deep ta-font-icon i{height:18px!important;font-size:18px!important}\n"], dependencies: [{ kind: "directive", type: NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "ngmodule", type: RouterModule }, { kind: "directive", type: i1.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "info", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "directive", type: i1.RouterLinkActive, selector: "[routerLinkActive]", inputs: ["routerLinkActiveOptions", "ariaCurrentWhenActive", "routerLinkActive"], outputs: ["isActiveChange"], exportAs: ["routerLinkActive"] }, { kind: "ngmodule", type: TranslateModule }, { kind: "pipe", type: i2.TranslatePipe, name: "translate" }, { kind: "component", type: FontIconComponent, selector: "ta-font-icon", inputs: ["name", "type"] }, { kind: "directive", type: TypedTemplateDirective, selector: "ng-template[typedTemplate]", inputs: ["typedTemplate"] }, { kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "component", type: LabelComponent, selector: "ta-label", inputs: ["size", "type"] }, { kind: "component", type: SwiperLightComponent, selector: "ta-swiper-light", inputs: ["items", "template", "swiperClasses", "containerClasses", "forced"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: NavigationComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ta-menu-navigation', standalone: true, imports: [
                        NgClass,
                        NgTemplateOutlet,
                        RouterModule,
                        TranslateModule,
                        FontIconComponent,
                        TypedTemplateDirective,
                        AsyncPipe,
                        LabelComponent,
                        SwiperLightComponent,
                    ], template: "<div class=\"navigation-container\" [class]=\"this.container()\">\n  <div class=\"list\">\n    @if (this.swiper()) {\n      <ta-swiper-light\n        [items]=\"this.menu().elements\"\n        [template]=\"template\"\n        [forced]=\"true\"\n        [swiperClasses]=\"this.getSpaceClass()\"\n      ></ta-swiper-light>\n    } @else {\n      <div class=\"element-list\" [ngClass]=\"this.menu().direction + ' ' + this.getSpaceClass()\">\n        @for (element of this.menu().elements; track element) {\n          @let visible = element.visible$ | async;\n          @if (visible) {\n            <div class=\"element\">\n              <ng-template\n                [ngTemplateOutlet]=\"template\"\n                [ngTemplateOutletContext]=\"{\n                  element: element,\n                }\"\n              >\n              </ng-template>\n            </div>\n          }\n        }\n      </div>\n    }\n  </div>\n</div>\n\n<ng-template #template let-element=\"element\">\n  <div class=\"c-pointer flex-full\">\n    @if (element.callback || element.disabled) {\n      <div\n        (click)=\"this.callback(element)\"\n        class=\"item-container flex-full\"\n        [ngClass]=\"{ active: this.isActive(element), disabled: element.disabled }\"\n      >\n        <ng-template\n          [ngTemplateOutlet]=\"Item\"\n          [ngTemplateOutletContext]=\"{\n            item: element,\n          }\"\n        >\n        </ng-template>\n      </div>\n    } @else {\n      <div\n        class=\"item-container flex-full\"\n        routerLinkActive=\"active\"\n        [routerLinkActiveOptions]=\"{ exact: element.exact }\"\n        [routerLink]=\"[this.getLink(element)]\"\n        [queryParamsHandling]=\"element.queryParamsHandling\"\n      >\n        <ng-template\n          [ngTemplateOutlet]=\"Item\"\n          [ngTemplateOutletContext]=\"{\n            item: element,\n          }\"\n        >\n        </ng-template>\n      </div>\n    }\n  </div>\n</ng-template>\n\n<ng-template #Item let-item=\"item\" [typedTemplate]=\"this.typeItem\">\n  <div class=\"item flex-full flex-start g-space-sm\" [class.disabled]=\"item.disabled\">\n    @if (this.hasFontIcon(item)) {\n      <div class=\"icon\">\n        <ta-font-icon [name]=\"this.getFontIcon(item)\"></ta-font-icon>\n      </div>\n    }\n    @if (item.label) {\n      <div class=\"label\">\n        {{ item.label | translate }}\n      </div>\n    }\n    @if (item.options?.notificationBadge?.label) {\n      <ta-label [style]=\"item.options?.notificationBadge?.style\" size=\"xs\" type=\"warning\">\n        {{ item.options?.notificationBadge?.label || 0 }}\n      </ta-label>\n    }\n    @if (item.translationData?.length) {\n      <div class=\"bullet\">({{ item.translationData?.length }})</div>\n    }\n  </div>\n</ng-template>\n", styles: [".element-list{gap:var(--ta-space-md);display:flex;flex-direction:row}.element-list .item-container{cursor:pointer}.element-list .item-container.disabled{cursor:not-allowed}.element-list.vertical{display:flex;flex-direction:column}.tags .item-container .item{flex-direction:row;display:flex;align-items:center;gap:var(--ta-space-xs);padding:var(--ta-space-md);border:1px solid transparent;color:var(--ta-text-tertiary);background-color:var(--ta-surface-tertiary);border-color:var(--ta-surface-tertiary);border-radius:var(--ta-radius-rounded);font-size:var(--ta-font-body-sm-default-size);font-weight:var(--ta-font-body-sm-default-weight)}.tags .item-container.disabled .item{background-color:var(--ta-surface-primary);border-color:var(--ta-border-disabled)}.tags .item-container.active .item{color:var(--ta-text-brand-primary);background-color:var(--ta-surface-default);border-color:var(--ta-surface-default)}.tab .list{border-bottom:1px solid var(--ta-border-secondary)}.tab .item-container .item{flex-direction:row;display:flex;align-items:center;gap:var(--ta-space-xs);padding:var(--ta-space-md);border-bottom:2px solid transparent;color:var(--ta-text-tertiary);font-size:var(--ta-font-body-sm-default-size);font-weight:var(--ta-font-body-sm-default-weight)}.tab .item-container.disabled{opacity:.5}.tab .item-container.active .item{color:var(--ta-text-brand-primary);border-bottom-color:var(--ta-border-brand)}.submenu{padding:var(--ta-space-xs);background-color:var(--ta-surface-default);border-radius:var(--ta-radius-rounded)}.submenu .element-list{gap:var(--ta-space-xs);display:flex;flex-direction:row;justify-content:space-between}.submenu .element-list .element{display:flex;flex:1 1 auto}.submenu .item-container .item{flex-direction:row;align-items:center;display:flex;justify-content:center;margin:auto;padding:var(--ta-space-sm);border-radius:var(--ta-radius-rounded);color:var(--ta-text-secondary);font-size:var(--ta-font-body-md-default-size);font-weight:var(--ta-font-body-md-default-weight)}.submenu .item-container.disabled{opacity:.5}.submenu .item-container.active .item{background-color:var(--ta-surface-primary);color:var(--ta-text-brand-primary);font-size:var(--ta-font-body-md-default-size);font-weight:var(--ta-font-body-md-bold-weight)}.submenu .item-container:hover .item{color:var(--ta-text-brand-primary);font-size:var(--ta-font-body-md-default-size);font-weight:var(--ta-font-body-md-bold-weight)}:host ::ng-deep .swiper-container{gap:var(--ta-space-sm)!important}:host ::ng-deep ta-font-icon{margin-top:-6px;display:block}:host ::ng-deep ta-font-icon i{height:18px!important;font-size:18px!important}\n"] }]
        }], ctorParameters: () => [] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmF2aWdhdGlvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2NvbXBvbmVudHMvbmF2aWdhdGlvbi9uYXZpZ2F0aW9uLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9uYXZpZ2F0aW9uL25hdmlnYXRpb24uY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN2RSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBVSxNQUFNLGVBQWUsQ0FBQztBQUN6RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFL0MsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBR3RELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUU5QyxPQUFPLEVBQUUsY0FBYyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sUUFBUSxDQUFDO0FBQzlELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxzQkFBc0IsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUV4RSxPQUFPLEVBQUUsV0FBVyxFQUFFLFdBQVcsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBSXRFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDJCQUEyQixDQUFDOzs7O0FBbUI5RCxNQUFNLE9BQU8sbUJBQW9CLFNBQVEsbUJBQW1CO0lBbUIxRDtRQUNFLEtBQUssRUFBRSxDQUFDO1FBbkJWLFNBQUksR0FBRyxLQUFLLENBQUMsUUFBUSxFQUFRLENBQUM7UUFFOUIsY0FBUyxHQUFHLEtBQUssQ0FBQyxRQUFRLEVBQThCLENBQUM7UUFFekQsV0FBTSxHQUFHLEtBQUssQ0FBVSxLQUFLLENBQUMsQ0FBQztRQUUvQixZQUFPLEdBQUcsS0FB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Iiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXN5bmNQaXBlLCBOZ0NsYXNzLCBOZ1RlbXBsYXRlT3V0bGV0IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IENvbXBvbmVudCwgaW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUm91dGVyTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcblxuaW1wb3J0IHsgVHJhbnNsYXRlTW9kdWxlIH0gZnJvbSAnQG5neC10cmFuc2xhdGUvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7IEZvbnRJY29uQ29tcG9uZW50IH0gZnJvbSAnQHRhL2ljb25zJztcbmltcG9ydCB7IFRhU2l6ZXMgfSBmcm9tICdAdGEvc3R5bGVzJztcbmltcG9ydCB7IExhYmVsQ29tcG9uZW50LCBTd2lwZXJMaWdodENvbXBvbmVudCB9IGZyb20gJ0B0YS91aSc7XG5pbXBvcnQgeyBUYUFic3RyYWN0Q29tcG9uZW50LCBUeXBlZFRlbXBsYXRlRGlyZWN0aXZlIH0gZnJvbSAnQHRhL3V0aWxzJztcblxuaW1wb3J0IHsgZ2V0Rm9udEljb24sIGhhc0ZvbnRJY29uIH0gZnJvbSAnLi4vLi4vaGVscGVycy9pY29uLW1hbmFnZXInO1xuaW1wb3J0IHsgTWVudUFjdGlvbiB9IGZyb20gJy4uLy4uL21vZGVscy9tZW51L2l0ZW0vYWN0aW9uJztcbmltcG9ydCB7IE1lbnVCYXNlIH0gZnJvbSAnLi4vLi4vbW9kZWxzL21lbnUvaXRlbS9iYXNlJztcbmltcG9ydCB7IE1lbnUsIE1lbnVJY29uIH0gZnJvbSAnLi4vLi4vbW9kZWxzL3B1YmxpYy1hcGknO1xuaW1wb3J0IHsgVGFUcmFuc2xhdGlvbk1lbnUgfSBmcm9tICcuLi8uLi90cmFuc2xhdGlvbi5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGEtbWVudS1uYXZpZ2F0aW9uJyxcbiAgdGVtcGxhdGVVcmw6ICcuL25hdmlnYXRpb24uY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9uYXZpZ2F0aW9uLmNvbXBvbmVudC5zY3NzJ10sXG4gIHN0YW5kYWxvbmU6IHRydWUsXG4gIGltcG9ydHM6IFtcbiAgICBOZ0NsYXNzLFxuICAgIE5nVGVtcGxhdGVPdXRsZXQsXG4gICAgUm91dGVyTW9kdWxlLFxuICAgIFRyYW5zbGF0ZU1vZHVsZSxcbiAgICBGb250SWNvbkNvbXBvbmVudCxcbiAgICBUeXBlZFRlbXBsYXRlRGlyZWN0aXZlLFxuICAgIEFzeW5jUGlwZSxcbiAgICBMYWJlbENvbXBvbmVudCxcbiAgICBTd2lwZXJMaWdodENvbXBvbmVudCxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgTmF2aWdhdGlvbkNvbXBvbmVudCBleHRlbmRzIFRhQWJzdHJhY3RDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBtZW51ID0gaW5wdXQucmVxdWlyZWQ8TWVudT4oKTtcblxuICBjb250YWluZXIgPSBpbnB1dC5yZXF1aXJlZDwndGFncycgfCAndGFiJyB8ICdzdWJtZW51Jz4oKTtcblxuICBzd2lwZXIgPSBpbnB1dDxib29sZWFuPihmYWxzZSk7XG5cbiAgb3B0aW9ucyA9IGlucHV0PHtcbiAgICBzcGFjZUVsZW1lbnQ/OiBUYVNpemVzIHwgbnVsbDtcbiAgfT4oe30pO1xuXG4gIG1hbnVhbGx5Q2hhbmdlZCQgPSBpbnB1dDxPYnNlcnZhYmxlPHN0cmluZz4+KCk7XG5cbiAgcmVhZG9ubHkgaGFzRm9udEljb24gPSBoYXNGb250SWNvbjtcbiAgcmVhZG9ubHkgZ2V0Rm9udEljb24gPSBnZXRGb250SWNvbjtcblxuICBwdWJsaWMgcmVhZG9ubHkgdHlwZUl0ZW0hOiB7IGl0ZW06IE1lbnVCYXNlIHwgTWVudUFjdGlvbiB8IE1lbnVJY29uIH07XG4gIHB1YmxpYyBhY3RpdmVLZXk6IHN0cmluZyA9ICcnO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgVGFUcmFuc2xhdGlvbk1lbnUuZ2V0SW5zdGFuY2UoKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIGNvbnN0IGRlZmF1bHRPcGVuID0gdGhpcy5tZW51KCkuZWxlbWVudHMuZmluZChlID0+IGUuZGVmYXVsdE9wZW4pO1xuXG4gICAgaWYgKCFkZWZhdWx0T3BlbiB8fCAhZGVmYXVsdE9wZW4uY2FsbGJhY2spIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5jYWxsYmFjayhkZWZhdWx0T3Blbik7XG5cbiAgICBjb25zdCBtYW51YWxseUNoYW5nZWQgPSB0aGlzLm1hbnVhbGx5Q2hhbmdlZCQoKTtcbiAgICBpZiAobWFudWFsbHlDaGFuZ2VkKSB7XG4gICAgICB0aGlzLl9yZWdpc3RlclN1YnNjcmlwdGlvbihcbiAgICAgICAgbWFudWFsbHlDaGFuZ2VkLnN1YnNjcmliZSh7XG4gICAgICAgICAgbmV4dDogKGtleTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmb3VuZCA9IHRoaXMubWVudSgpLmVsZW1lbnRzLmZpbmQoZWxlbWVudCA9PiBlbGVtZW50LmtleSA9PT0ga2V5KTtcbiAgICAgICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrKGZvdW5kKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgZ2V0U3BhY2VDbGFzcygpIHtcbiAgICBpZiAodGhpcy5vcHRpb25zKCkuc3BhY2VFbGVtZW50ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHJldHVybiBgZy1zcGFjZS0ke3RoaXMub3B0aW9ucygpLnNwYWNlRWxlbWVudCA/PyAnbGcnfWA7XG4gIH1cbiAgcHVibGljIGdldExpbmsoaXRlbTogTWVudUljb24gfCBNZW51QWN0aW9uIHwgTWVudUJhc2UpIHtcbiAgICBpZiAoaXRlbS5saW5rICYmIGl0ZW0ubGluayAhPT0gJycpIHtcbiAgICAgIHJldHVybiBpdGVtLmxpbms7XG4gICAgfVxuXG4gICAgcmV0dXJuICcnOyAvLyBUT0RPIHRoaXMuX25hdmlnYXRpb25TZXJ2aWNlLmN1cnJlbnRQYWdlVXJsO1xuICB9XG5cbiAgcHVibGljIGNhbGxiYWNrKGl0ZW06IE1lbnVCYXNlKSB7XG4gICAgaWYgKGl0ZW0uZGlzYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5hY3RpdmVLZXkgPSBpdGVtLmtleTtcbiAgICBpZiAoaXRlbS5jYWxsYmFjaykge1xuICAgICAgaXRlbS5jYWxsYmFjaygpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBpc0FjdGl2ZShpdGVtOiBNZW51QmFzZSkge1xuICAgIHJldHVybiBpdGVtLmtleSA9PT0gdGhpcy5hY3RpdmVLZXk7XG4gIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJuYXZpZ2F0aW9uLWNvbnRhaW5lclwiIFtjbGFzc109XCJ0aGlzLmNvbnRhaW5lcigpXCI+XG4gIDxkaXYgY2xhc3M9XCJsaXN0XCI+XG4gICAgQGlmICh0aGlzLnN3aXBlcigpKSB7XG4gICAgICA8dGEtc3dpcGVyLWxpZ2h0XG4gICAgICAgIFtpdGVtc109XCJ0aGlzLm1lbnUoKS5lbGVtZW50c1wiXG4gICAgICAgIFt0ZW1wbGF0ZV09XCJ0ZW1wbGF0ZVwiXG4gICAgICAgIFtmb3JjZWRdPVwidHJ1ZVwiXG4gICAgICAgIFtzd2lwZXJDbGFzc2VzXT1cInRoaXMuZ2V0U3BhY2VDbGFzcygpXCJcbiAgICAgID48L3RhLXN3aXBlci1saWdodD5cbiAgICB9IEBlbHNlIHtcbiAgICAgIDxkaXYgY2xhc3M9XCJlbGVtZW50LWxpc3RcIiBbbmdDbGFzc109XCJ0aGlzLm1lbnUoKS5kaXJlY3Rpb24gKyAnICcgKyB0aGlzLmdldFNwYWNlQ2xhc3MoKVwiPlxuICAgICAgICBAZm9yIChlbGVtZW50IG9mIHRoaXMubWVudSgpLmVsZW1lbnRzOyB0cmFjayBlbGVtZW50KSB7XG4gICAgICAgICAgQGxldCB2aXNpYmxlID0gZWxlbWVudC52aXNpYmxlJCB8IGFzeW5jO1xuICAgICAgICAgIEBpZiAodmlzaWJsZSkge1xuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImVsZW1lbnRcIj5cbiAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlXG4gICAgICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwidGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgICAgICAgICAgIH1cIlxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIDwvZGl2PlxuICAgIH1cbiAgPC9kaXY+XG48L2Rpdj5cblxuPG5nLXRlbXBsYXRlICN0ZW1wbGF0ZSBsZXQtZWxlbWVudD1cImVsZW1lbnRcIj5cbiAgPGRpdiBjbGFzcz1cImMtcG9pbnRlciBmbGV4LWZ1bGxcIj5cbiAgICBAaWYgKGVsZW1lbnQuY2FsbGJhY2sgfHwgZWxlbWVudC5kaXNhYmxlZCkge1xuICAgICAgPGRpdlxuICAgICAgICAoY2xpY2spPVwidGhpcy5jYWxsYmFjayhlbGVtZW50KVwiXG4gICAgICAgIGNsYXNzPVwiaXRlbS1jb250YWluZXIgZmxleC1mdWxsXCJcbiAgICAgICAgW25nQ2xhc3NdPVwieyBhY3RpdmU6IHRoaXMuaXNBY3RpdmUoZWxlbWVudCksIGRpc2FibGVkOiBlbGVtZW50LmRpc2FibGVkIH1cIlxuICAgICAgPlxuICAgICAgICA8bmctdGVtcGxhdGVcbiAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldF09XCJJdGVtXCJcbiAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwie1xuICAgICAgICAgICAgaXRlbTogZWxlbWVudCxcbiAgICAgICAgICB9XCJcbiAgICAgICAgPlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgPC9kaXY+XG4gICAgfSBAZWxzZSB7XG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwiaXRlbS1jb250YWluZXIgZmxleC1mdWxsXCJcbiAgICAgICAgcm91dGVyTGlua0FjdGl2ZT1cImFjdGl2ZVwiXG4gICAgICAgIFtyb3V0ZXJMaW5rQWN0aXZlT3B0aW9uc109XCJ7IGV4YWN0OiBlbGVtZW50LmV4YWN0IH1cIlxuICAgICAgICBbcm91dGVyTGlua109XCJbdGhpcy5nZXRMaW5rKGVsZW1lbnQpXVwiXG4gICAgICAgIFtxdWVyeVBhcmFtc0hhbmRsaW5nXT1cImVsZW1lbnQucXVlcnlQYXJhbXNIYW5kbGluZ1wiXG4gICAgICA+XG4gICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cIkl0ZW1cIlxuICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7XG4gICAgICAgICAgICBpdGVtOiBlbGVtZW50LFxuICAgICAgICAgIH1cIlxuICAgICAgICA+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICA8L2Rpdj5cbiAgICB9XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cblxuPG5nLXRlbXBsYXRlICNJdGVtIGxldC1pdGVtPVwiaXRlbVwiIFt0eXBlZFRlbXBsYXRlXT1cInRoaXMudHlwZUl0ZW1cIj5cbiAgPGRpdiBjbGFzcz1cIml0ZW0gZmxleC1mdWxsIGZsZXgtc3RhcnQgZy1zcGFjZS1zbVwiIFtjbGFzcy5kaXNhYmxlZF09XCJpdGVtLmRpc2FibGVkXCI+XG4gICAgQGlmICh0aGlzLmhhc0ZvbnRJY29uKGl0ZW0pKSB7XG4gICAgICA8ZGl2IGNsYXNzPVwiaWNvblwiPlxuICAgICAgICA8dGEtZm9udC1pY29uIFtuYW1lXT1cInRoaXMuZ2V0Rm9udEljb24oaXRlbSlcIj48L3RhLWZvbnQtaWNvbj5cbiAgICAgIDwvZGl2PlxuICAgIH1cbiAgICBAaWYgKGl0ZW0ubGFiZWwpIHtcbiAgICAgIDxkaXYgY2xhc3M9XCJsYWJlbFwiPlxuICAgICAgICB7eyBpdGVtLmxhYmVsIHwgdHJhbnNsYXRlIH19XG4gICAgICA8L2Rpdj5cbiAgICB9XG4gICAgQGlmIChpdGVtLm9wdGlvbnM/Lm5vdGlmaWNhdGlvbkJhZGdlPy5sYWJlbCkge1xuICAgICAgPHRhLWxhYmVsIFtzdHlsZV09XCJpdGVtLm9wdGlvbnM/Lm5vdGlmaWNhdGlvbkJhZGdlPy5zdHlsZVwiIHNpemU9XCJ4c1wiIHR5cGU9XCJ3YXJuaW5nXCI+XG4gICAgICAgIHt7IGl0ZW0ub3B0aW9ucz8ubm90aWZpY2F0aW9uQmFkZ2U/LmxhYmVsIHx8IDAgfX1cbiAgICAgIDwvdGEtbGFiZWw+XG4gICAgfVxuICAgIEBpZiAoaXRlbS50cmFuc2xhdGlvbkRhdGE/Lmxlbmd0aCkge1xuICAgICAgPGRpdiBjbGFzcz1cImJ1bGxldFwiPih7eyBpdGVtLnRyYW5zbGF0aW9uRGF0YT8ubGVuZ3RoIH19KTwvZGl2PlxuICAgIH1cbiAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuIl19