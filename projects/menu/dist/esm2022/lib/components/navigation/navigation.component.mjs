import { AsyncPipe, NgClass, NgTemplateOutlet } from "@angular/common";
import { Component, Input } from "@angular/core";
import { RouterModule } from "@angular/router";
import { TranslateModule } from "@ngx-translate/core";
import { FontIconComponent } from "@ta/icons";
import { NotificationBadgeComponent, NotificationBadgeContainerComponent, SwiperLightComponent, } from "@ta/ui";
import { TaAbstractComponent, TypedTemplateDirective } from "@ta/utils";
import { getFontIcon, hasFontIcon } from "../../helpers/icon-manager";
import { TaTranslationMenu } from "../../translation.service";
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "@ngx-translate/core";
export class NavigationComponent extends TaAbstractComponent {
    constructor() {
        super();
        this.swiper = false;
        this.options = {};
        this.hasFontIcon = hasFontIcon;
        this.getFontIcon = getFontIcon;
        this.activeKey = "";
        TaTranslationMenu.getInstance();
    }
    ngOnInit() {
        const defaultOpen = this.menu.elements.find((e) => e.defaultOpen);
        if (!defaultOpen || !defaultOpen.callback) {
            return;
        }
        this.callback(defaultOpen);
        if (this.manuallyChanged$) {
            this._registerSubscription(this.manuallyChanged$.subscribe({
                next: (key) => {
                    const found = this.menu.elements.find((element) => element.key === key);
                    if (found) {
                        this.callback(found);
                    }
                },
            }));
        }
    }
    getSpaceClass() {
        if (this.options.spaceElement === null) {
            return "";
        }
        return `g-space-${this.options.spaceElement ?? "lg"}`;
    }
    getLink(item) {
        if (item.link && item.link !== "") {
            return item.link;
        }
        return ""; // TODO this._navigationService.currentPageUrl;
    }
    callback(item) {
        if (item.disabled) {
            return;
        }
        this.activeKey = item.key;
        if (item.callback) {
            item.callback();
        }
    }
    isActive(item) {
        return item.key === this.activeKey;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: NavigationComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.14", type: NavigationComponent, isStandalone: true, selector: "ta-menu-navigation", inputs: { menu: "menu", container: "container", swiper: "swiper", options: "options", manuallyChanged$: "manuallyChanged$" }, usesInheritance: true, ngImport: i0, template: "<div class=\"navigation-container\" [class]=\"this.container\">\n  <div class=\"list\">\n    @if (this.swiper) {\n    <ta-swiper-light\n      [items]=\"this.menu.elements\"\n      [template]=\"template\"\n      [forced]=\"true\"\n      [swiperClasses]=\"this.getSpaceClass()\"\n    ></ta-swiper-light>\n    } @else {\n    <div\n      class=\"element-list\"\n      [ngClass]=\"this.menu.direction + ' ' + this.getSpaceClass()\"\n    >\n      @for (element of this.menu.elements; track element) { @let visible =\n      element.visible$ | async; @if(visible) {\n      <div class=\"element\">\n        <ng-template\n          [ngTemplateOutlet]=\"template\"\n          [ngTemplateOutletContext]=\"{\n                  element: element,\n                }\"\n        >\n        </ng-template>\n      </div>\n      } }\n    </div>\n    }\n  </div>\n</div>\n\n<ng-template #template let-element=\"element\">\n  <ta-notification-badge-container class=\"c-pointer\">\n    @if (element.callback || element.disabled) {\n    <div\n      (click)=\"this.callback(element)\"\n      class=\"item-container\"\n      [ngClass]=\"{ active: this.isActive(element), disabled: element.disabled }\"\n    >\n      <ng-template\n        [ngTemplateOutlet]=\"Item\"\n        [ngTemplateOutletContext]=\"{\n            item: element,\n          }\"\n      >\n      </ng-template>\n    </div>\n    } @else {\n    <div\n      class=\"item-container\"\n      routerLinkActive=\"active\"\n      [routerLinkActiveOptions]=\"{ exact: element.exact }\"\n      [routerLink]=\"[this.getLink(element)]\"\n      [queryParamsHandling]=\"element.queryParamsHandling\"\n    >\n      <ng-template\n        [ngTemplateOutlet]=\"Item\"\n        [ngTemplateOutletContext]=\"{\n            item: element,\n          }\"\n      >\n      </ng-template>\n    </div>\n    } @if (element.options?.notificationBadge?.label) {\n    <ta-notification-badge\n      [number]=\"element.options?.notificationBadge?.label || 0\"\n      [style]=\"element.options?.notificationBadge?.style\"\n      fontSize=\"xs\"\n    ></ta-notification-badge>\n    }\n  </ta-notification-badge-container>\n</ng-template>\n\n<ng-template #Item let-item=\"item\" [typedTemplate]=\"this.typeItem\">\n  <div class=\"item\" [class.disabled]=\"item.disabled\">\n    @if (this.hasFontIcon(item)) {\n    <div class=\"icon\">\n      <ta-font-icon [name]=\"this.getFontIcon(item)\"></ta-font-icon>\n    </div>\n    } @if (item.label) {\n    <div class=\"label\">\n      {{ item.label | translate }}\n    </div>\n    } @if (item.translationData?.length) {\n    <div class=\"bullet\">({{ item.translationData?.length }})</div>\n    }\n  </div>\n</ng-template>\n", styles: [".element-list{gap:var(--ta-space-md);display:flex;flex-direction:row}.element-list.vertical{display:flex;flex-direction:column}.tags .item-container .item{flex-direction:row;display:flex;align-items:center;gap:var(--ta-space-xs);padding:var(--ta-space-md);border:1px solid transparent;color:var(--ta-text-tertiary);background-color:var(--ta-surface-tertiary);border-color:var(--ta-surface-tertiary);border-radius:var(--ta-radius-rounded);font-size:var(--ta-font-body-sm-default-size);line-height:var(--ta-font-body-sm-default-line);font-weight:var(--ta-font-body-sm-default-weight)}.tags .item-container.disabled .item{background-color:var(--ta-surface-primary);border-color:var(--ta-border-disabled)}.tags .item-container.active .item{color:var(--ta-text-brand-primary);background-color:var(--ta-surface-default);border-color:var(--ta-surface-default)}.tab .list{border-bottom:1px solid var(--ta-border-secondary)}.tab .item-container .item{flex-direction:row;display:flex;align-items:center;gap:var(--ta-space-xs);padding:var(--ta-space-md);border-bottom:2px solid transparent;color:var(--ta-text-tertiary);font-size:var(--ta-font-body-sm-default-size);line-height:var(--ta-font-body-sm-default-line);font-weight:var(--ta-font-body-sm-default-weight)}.tab .item-container.disabled{opacity:.5}.tab .item-container.active .item{color:var(--ta-text-brand-primary);border-bottom-color:var(--ta-border-brand)}:host ::ng-deep .swiper-container{gap:var(--ta-space-sm)!important}:host ::ng-deep ta-font-icon{margin-top:-6px;display:block}:host ::ng-deep ta-font-icon i{height:18px!important;font-size:18px!important}\n"], dependencies: [{ kind: "directive", type: NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "ngmodule", type: RouterModule }, { kind: "directive", type: i1.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "info", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "directive", type: i1.RouterLinkActive, selector: "[routerLinkActive]", inputs: ["routerLinkActiveOptions", "ariaCurrentWhenActive", "routerLinkActive"], outputs: ["isActiveChange"], exportAs: ["routerLinkActive"] }, { kind: "ngmodule", type: TranslateModule }, { kind: "pipe", type: i2.TranslatePipe, name: "translate" }, { kind: "component", type: FontIconComponent, selector: "ta-font-icon", inputs: ["name", "type"] }, { kind: "component", type: NotificationBadgeComponent, selector: "ta-notification-badge", inputs: ["number", "fontSize", "style", "relative"] }, { kind: "component", type: NotificationBadgeContainerComponent, selector: "ta-notification-badge-container" }, { kind: "component", type: SwiperLightComponent, selector: "ta-swiper-light", inputs: ["items", "template", "swiperClasses", "containerClasses", "forced"] }, { kind: "directive", type: TypedTemplateDirective, selector: "ng-template[typedTemplate]", inputs: ["typedTemplate"] }, { kind: "pipe", type: AsyncPipe, name: "async" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: NavigationComponent, decorators: [{
            type: Component,
            args: [{ selector: "ta-menu-navigation", standalone: true, imports: [
                        NgClass,
                        NgTemplateOutlet,
                        RouterModule,
                        TranslateModule,
                        FontIconComponent,
                        NotificationBadgeComponent,
                        NotificationBadgeContainerComponent,
                        SwiperLightComponent,
                        TypedTemplateDirective,
                        AsyncPipe,
                    ], template: "<div class=\"navigation-container\" [class]=\"this.container\">\n  <div class=\"list\">\n    @if (this.swiper) {\n    <ta-swiper-light\n      [items]=\"this.menu.elements\"\n      [template]=\"template\"\n      [forced]=\"true\"\n      [swiperClasses]=\"this.getSpaceClass()\"\n    ></ta-swiper-light>\n    } @else {\n    <div\n      class=\"element-list\"\n      [ngClass]=\"this.menu.direction + ' ' + this.getSpaceClass()\"\n    >\n      @for (element of this.menu.elements; track element) { @let visible =\n      element.visible$ | async; @if(visible) {\n      <div class=\"element\">\n        <ng-template\n          [ngTemplateOutlet]=\"template\"\n          [ngTemplateOutletContext]=\"{\n                  element: element,\n                }\"\n        >\n        </ng-template>\n      </div>\n      } }\n    </div>\n    }\n  </div>\n</div>\n\n<ng-template #template let-element=\"element\">\n  <ta-notification-badge-container class=\"c-pointer\">\n    @if (element.callback || element.disabled) {\n    <div\n      (click)=\"this.callback(element)\"\n      class=\"item-container\"\n      [ngClass]=\"{ active: this.isActive(element), disabled: element.disabled }\"\n    >\n      <ng-template\n        [ngTemplateOutlet]=\"Item\"\n        [ngTemplateOutletContext]=\"{\n            item: element,\n          }\"\n      >\n      </ng-template>\n    </div>\n    } @else {\n    <div\n      class=\"item-container\"\n      routerLinkActive=\"active\"\n      [routerLinkActiveOptions]=\"{ exact: element.exact }\"\n      [routerLink]=\"[this.getLink(element)]\"\n      [queryParamsHandling]=\"element.queryParamsHandling\"\n    >\n      <ng-template\n        [ngTemplateOutlet]=\"Item\"\n        [ngTemplateOutletContext]=\"{\n            item: element,\n          }\"\n      >\n      </ng-template>\n    </div>\n    } @if (element.options?.notificationBadge?.label) {\n    <ta-notification-badge\n      [number]=\"element.options?.notificationBadge?.label || 0\"\n      [style]=\"element.options?.notificationBadge?.style\"\n      fontSize=\"xs\"\n    ></ta-notification-badge>\n    }\n  </ta-notification-badge-container>\n</ng-template>\n\n<ng-template #Item let-item=\"item\" [typedTemplate]=\"this.typeItem\">\n  <div class=\"item\" [class.disabled]=\"item.disabled\">\n    @if (this.hasFontIcon(item)) {\n    <div class=\"icon\">\n      <ta-font-icon [name]=\"this.getFontIcon(item)\"></ta-font-icon>\n    </div>\n    } @if (item.label) {\n    <div class=\"label\">\n      {{ item.label | translate }}\n    </div>\n    } @if (item.translationData?.length) {\n    <div class=\"bullet\">({{ item.translationData?.length }})</div>\n    }\n  </div>\n</ng-template>\n", styles: [".element-list{gap:var(--ta-space-md);display:flex;flex-direction:row}.element-list.vertical{display:flex;flex-direction:column}.tags .item-container .item{flex-direction:row;display:flex;align-items:center;gap:var(--ta-space-xs);padding:var(--ta-space-md);border:1px solid transparent;color:var(--ta-text-tertiary);background-color:var(--ta-surface-tertiary);border-color:var(--ta-surface-tertiary);border-radius:var(--ta-radius-rounded);font-size:var(--ta-font-body-sm-default-size);line-height:var(--ta-font-body-sm-default-line);font-weight:var(--ta-font-body-sm-default-weight)}.tags .item-container.disabled .item{background-color:var(--ta-surface-primary);border-color:var(--ta-border-disabled)}.tags .item-container.active .item{color:var(--ta-text-brand-primary);background-color:var(--ta-surface-default);border-color:var(--ta-surface-default)}.tab .list{border-bottom:1px solid var(--ta-border-secondary)}.tab .item-container .item{flex-direction:row;display:flex;align-items:center;gap:var(--ta-space-xs);padding:var(--ta-space-md);border-bottom:2px solid transparent;color:var(--ta-text-tertiary);font-size:var(--ta-font-body-sm-default-size);line-height:var(--ta-font-body-sm-default-line);font-weight:var(--ta-font-body-sm-default-weight)}.tab .item-container.disabled{opacity:.5}.tab .item-container.active .item{color:var(--ta-text-brand-primary);border-bottom-color:var(--ta-border-brand)}:host ::ng-deep .swiper-container{gap:var(--ta-space-sm)!important}:host ::ng-deep ta-font-icon{margin-top:-6px;display:block}:host ::ng-deep ta-font-icon i{height:18px!important;font-size:18px!important}\n"] }]
        }], ctorParameters: () => [], propDecorators: { menu: [{
                type: Input
            }], container: [{
                type: Input
            }], swiper: [{
                type: Input
            }], options: [{
                type: Input
            }], manuallyChanged$: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmF2aWdhdGlvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2NvbXBvbmVudHMvbmF2aWdhdGlvbi9uYXZpZ2F0aW9uLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9uYXZpZ2F0aW9uL25hdmlnYXRpb24uY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN2RSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBVSxNQUFNLGVBQWUsQ0FBQztBQUN6RCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFL0MsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBR3RELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUM5QyxPQUFPLEVBQ0wsMEJBQTBCLEVBQzFCLG1DQUFtQyxFQUNuQyxvQkFBb0IsR0FDckIsTUFBTSxRQUFRLENBQUM7QUFDaEIsT0FBTyxFQUFFLG1CQUFtQixFQUFFLHNCQUFzQixFQUFFLE1BQU0sV0FBVyxDQUFDO0FBRXhFLE9BQU8sRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFJdEUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7Ozs7QUFxQjlELE1BQU0sT0FBTyxtQkFBb0IsU0FBUSxtQkFBbUI7SUF3QjFEO1FBQ0UsS0FBSyxFQUFFLENBQUM7UUFqQlYsV0FBTSxHQUFHLEtBQUssQ0FBQztRQUdmLFlBQU8sR0FFSCxFQUFFLENBQUM7UUFLRSxnQkFBVyxHQUFHLFdBQVcsQ0FBQztRQUMxQixnQkFBVyxHQUFHLFdBQVcsQ0FBQztRQUc1QixjQUFTLEdBQVcsRUFBRSxD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OlsiaW1wb3J0IHsgQXN5bmNQaXBlLCBOZ0NsYXNzLCBOZ1RlbXBsYXRlT3V0bGV0IH0gZnJvbSBcIkBhbmd1bGFyL2NvbW1vblwiO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0IH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IFJvdXRlck1vZHVsZSB9IGZyb20gXCJAYW5ndWxhci9yb3V0ZXJcIjtcblxuaW1wb3J0IHsgVHJhbnNsYXRlTW9kdWxlIH0gZnJvbSBcIkBuZ3gtdHJhbnNsYXRlL2NvcmVcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwicnhqc1wiO1xuXG5pbXBvcnQgeyBGb250SWNvbkNvbXBvbmVudCB9IGZyb20gXCJAdGEvaWNvbnNcIjtcbmltcG9ydCB7XG4gIE5vdGlmaWNhdGlvbkJhZGdlQ29tcG9uZW50LFxuICBOb3RpZmljYXRpb25CYWRnZUNvbnRhaW5lckNvbXBvbmVudCxcbiAgU3dpcGVyTGlnaHRDb21wb25lbnQsXG59IGZyb20gXCJAdGEvdWlcIjtcbmltcG9ydCB7IFRhQWJzdHJhY3RDb21wb25lbnQsIFR5cGVkVGVtcGxhdGVEaXJlY3RpdmUgfSBmcm9tIFwiQHRhL3V0aWxzXCI7XG5cbmltcG9ydCB7IGdldEZvbnRJY29uLCBoYXNGb250SWNvbiB9IGZyb20gXCIuLi8uLi9oZWxwZXJzL2ljb24tbWFuYWdlclwiO1xuaW1wb3J0IHsgTWVudUFjdGlvbiB9IGZyb20gXCIuLi8uLi9tb2RlbHMvbWVudS9pdGVtL2FjdGlvblwiO1xuaW1wb3J0IHsgTWVudUJhc2UgfSBmcm9tIFwiLi4vLi4vbW9kZWxzL21lbnUvaXRlbS9iYXNlXCI7XG5pbXBvcnQgeyBNZW51LCBNZW51SWNvbiB9IGZyb20gXCIuLi8uLi9tb2RlbHMvcHVibGljLWFwaVwiO1xuaW1wb3J0IHsgVGFUcmFuc2xhdGlvbk1lbnUgfSBmcm9tIFwiLi4vLi4vdHJhbnNsYXRpb24uc2VydmljZVwiO1xuaW1wb3J0IHsgVGFTaXplcyB9IGZyb20gXCJAdGEvc3R5bGVzXCI7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogXCJ0YS1tZW51LW5hdmlnYXRpb25cIixcbiAgdGVtcGxhdGVVcmw6IFwiLi9uYXZpZ2F0aW9uLmNvbXBvbmVudC5odG1sXCIsXG4gIHN0eWxlVXJsczogW1wiLi9uYXZpZ2F0aW9uLmNvbXBvbmVudC5zY3NzXCJdLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgTmdDbGFzcyxcbiAgICBOZ1RlbXBsYXRlT3V0bGV0LFxuICAgIFJvdXRlck1vZHVsZSxcbiAgICBUcmFuc2xhdGVNb2R1bGUsXG4gICAgRm9udEljb25Db21wb25lbnQsXG4gICAgTm90aWZpY2F0aW9uQmFkZ2VDb21wb25lbnQsXG4gICAgTm90aWZpY2F0aW9uQmFkZ2VDb250YWluZXJDb21wb25lbnQsXG4gICAgU3dpcGVyTGlnaHRDb21wb25lbnQsXG4gICAgVHlwZWRUZW1wbGF0ZURpcmVjdGl2ZSxcbiAgICBBc3luY1BpcGUsXG4gIF0sXG59KVxuZXhwb3J0IGNsYXNzIE5hdmlnYXRpb25Db21wb25lbnQgZXh0ZW5kcyBUYUFic3RyYWN0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KClcbiAgbWVudSE6IE1lbnU7XG5cbiAgQElucHV0KClcbiAgY29udGFpbmVyITogXCJ0YWdzXCIgfCBcInRhYlwiO1xuXG4gIEBJbnB1dCgpXG4gIHN3aXBlciA9IGZhbHNlO1xuXG4gIEBJbnB1dCgpXG4gIG9wdGlvbnM6IHtcbiAgICBzcGFjZUVsZW1lbnQ/OiBUYVNpemVzIHwgbnVsbDtcbiAgfSA9IHt9O1xuXG4gIEBJbnB1dCgpXG4gIG1hbnVhbGx5Q2hhbmdlZCQ/OiBPYnNlcnZhYmxlPHN0cmluZz47XG5cbiAgcmVhZG9ubHkgaGFzRm9udEljb24gPSBoYXNGb250SWNvbjtcbiAgcmVhZG9ubHkgZ2V0Rm9udEljb24gPSBnZXRGb250SWNvbjtcblxuICBwdWJsaWMgcmVhZG9ubHkgdHlwZUl0ZW0hOiB7IGl0ZW06IE1lbnVCYXNlIHwgTWVudUFjdGlvbiB8IE1lbnVJY29uIH07XG4gIHB1YmxpYyBhY3RpdmVLZXk6IHN0cmluZyA9IFwiXCI7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICBUYVRyYW5zbGF0aW9uTWVudS5nZXRJbnN0YW5jZSgpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgY29uc3QgZGVmYXVsdE9wZW4gPSB0aGlzLm1lbnUuZWxlbWVudHMuZmluZCgoZSkgPT4gZS5kZWZhdWx0T3Blbik7XG5cbiAgICBpZiAoIWRlZmF1bHRPcGVuIHx8ICFkZWZhdWx0T3Blbi5jYWxsYmFjaykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmNhbGxiYWNrKGRlZmF1bHRPcGVuKTtcblxuICAgIGlmICh0aGlzLm1hbnVhbGx5Q2hhbmdlZCQpIHtcbiAgICAgIHRoaXMuX3JlZ2lzdGVyU3Vic2NyaXB0aW9uKFxuICAgICAgICB0aGlzLm1hbnVhbGx5Q2hhbmdlZCQuc3Vic2NyaWJlKHtcbiAgICAgICAgICBuZXh0OiAoa2V5OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZvdW5kID0gdGhpcy5tZW51LmVsZW1lbnRzLmZpbmQoXG4gICAgICAgICAgICAgIChlbGVtZW50KSA9PiBlbGVtZW50LmtleSA9PT0ga2V5XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKGZvdW5kKSB7XG4gICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2soZm91bmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBnZXRTcGFjZUNsYXNzKCkge1xuICAgIGlmICh0aGlzLm9wdGlvbnMuc3BhY2VFbGVtZW50ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gICAgcmV0dXJuIGBnLXNwYWNlLSR7dGhpcy5vcHRpb25zLnNwYWNlRWxlbWVudCA/PyBcImxnXCJ9YDtcbiAgfVxuICBwdWJsaWMgZ2V0TGluayhpdGVtOiBNZW51SWNvbiB8IE1lbnVBY3Rpb24gfCBNZW51QmFzZSkge1xuICAgIGlmIChpdGVtLmxpbmsgJiYgaXRlbS5saW5rICE9PSBcIlwiKSB7XG4gICAgICByZXR1cm4gaXRlbS5saW5rO1xuICAgIH1cblxuICAgIHJldHVybiBcIlwiOyAvLyBUT0RPIHRoaXMuX25hdmlnYXRpb25TZXJ2aWNlLmN1cnJlbnRQYWdlVXJsO1xuICB9XG5cbiAgcHVibGljIGNhbGxiYWNrKGl0ZW06IE1lbnVCYXNlKSB7XG4gICAgaWYgKGl0ZW0uZGlzYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5hY3RpdmVLZXkgPSBpdGVtLmtleTtcbiAgICBpZiAoaXRlbS5jYWxsYmFjaykge1xuICAgICAgaXRlbS5jYWxsYmFjaygpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBpc0FjdGl2ZShpdGVtOiBNZW51QmFzZSkge1xuICAgIHJldHVybiBpdGVtLmtleSA9PT0gdGhpcy5hY3RpdmVLZXk7XG4gIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJuYXZpZ2F0aW9uLWNvbnRhaW5lclwiIFtjbGFzc109XCJ0aGlzLmNvbnRhaW5lclwiPlxuICA8ZGl2IGNsYXNzPVwibGlzdFwiPlxuICAgIEBpZiAodGhpcy5zd2lwZXIpIHtcbiAgICA8dGEtc3dpcGVyLWxpZ2h0XG4gICAgICBbaXRlbXNdPVwidGhpcy5tZW51LmVsZW1lbnRzXCJcbiAgICAgIFt0ZW1wbGF0ZV09XCJ0ZW1wbGF0ZVwiXG4gICAgICBbZm9yY2VkXT1cInRydWVcIlxuICAgICAgW3N3aXBlckNsYXNzZXNdPVwidGhpcy5nZXRTcGFjZUNsYXNzKClcIlxuICAgID48L3RhLXN3aXBlci1saWdodD5cbiAgICB9IEBlbHNlIHtcbiAgICA8ZGl2XG4gICAgICBjbGFzcz1cImVsZW1lbnQtbGlzdFwiXG4gICAgICBbbmdDbGFzc109XCJ0aGlzLm1lbnUuZGlyZWN0aW9uICsgJyAnICsgdGhpcy5nZXRTcGFjZUNsYXNzKClcIlxuICAgID5cbiAgICAgIEBmb3IgKGVsZW1lbnQgb2YgdGhpcy5tZW51LmVsZW1lbnRzOyB0cmFjayBlbGVtZW50KSB7IEBsZXQgdmlzaWJsZSA9XG4gICAgICBlbGVtZW50LnZpc2libGUkIHwgYXN5bmM7IEBpZih2aXNpYmxlKSB7XG4gICAgICA8ZGl2IGNsYXNzPVwiZWxlbWVudFwiPlxuICAgICAgICA8bmctdGVtcGxhdGVcbiAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldF09XCJ0ZW1wbGF0ZVwiXG4gICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cIntcbiAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgfVwiXG4gICAgICAgID5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgIDwvZGl2PlxuICAgICAgfSB9XG4gICAgPC9kaXY+XG4gICAgfVxuICA8L2Rpdj5cbjwvZGl2PlxuXG48bmctdGVtcGxhdGUgI3RlbXBsYXRlIGxldC1lbGVtZW50PVwiZWxlbWVudFwiPlxuICA8dGEtbm90aWZpY2F0aW9uLWJhZGdlLWNvbnRhaW5lciBjbGFzcz1cImMtcG9pbnRlclwiPlxuICAgIEBpZiAoZWxlbWVudC5jYWxsYmFjayB8fCBlbGVtZW50LmRpc2FibGVkKSB7XG4gICAgPGRpdlxuICAgICAgKGNsaWNrKT1cInRoaXMuY2FsbGJhY2soZWxlbWVudClcIlxuICAgICAgY2xhc3M9XCJpdGVtLWNvbnRhaW5lclwiXG4gICAgICBbbmdDbGFzc109XCJ7IGFjdGl2ZTogdGhpcy5pc0FjdGl2ZShlbGVtZW50KSwgZGlzYWJsZWQ6IGVsZW1lbnQuZGlzYWJsZWQgfVwiXG4gICAgPlxuICAgICAgPG5nLXRlbXBsYXRlXG4gICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cIkl0ZW1cIlxuICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwie1xuICAgICAgICAgICAgaXRlbTogZWxlbWVudCxcbiAgICAgICAgICB9XCJcbiAgICAgID5cbiAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgPC9kaXY+XG4gICAgfSBAZWxzZSB7XG4gICAgPGRpdlxuICAgICAgY2xhc3M9XCJpdGVtLWNvbnRhaW5lclwiXG4gICAgICByb3V0ZXJMaW5rQWN0aXZlPVwiYWN0aXZlXCJcbiAgICAgIFtyb3V0ZXJMaW5rQWN0aXZlT3B0aW9uc109XCJ7IGV4YWN0OiBlbGVtZW50LmV4YWN0IH1cIlxuICAgICAgW3JvdXRlckxpbmtdPVwiW3RoaXMuZ2V0TGluayhlbGVtZW50KV1cIlxuICAgICAgW3F1ZXJ5UGFyYW1zSGFuZGxpbmddPVwiZWxlbWVudC5xdWVyeVBhcmFtc0hhbmRsaW5nXCJcbiAgICA+XG4gICAgICA8bmctdGVtcGxhdGVcbiAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwiSXRlbVwiXG4gICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7XG4gICAgICAgICAgICBpdGVtOiBlbGVtZW50LFxuICAgICAgICAgIH1cIlxuICAgICAgPlxuICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICA8L2Rpdj5cbiAgICB9IEBpZiAoZWxlbWVudC5vcHRpb25zPy5ub3RpZmljYXRpb25CYWRnZT8ubGFiZWwpIHtcbiAgICA8dGEtbm90aWZpY2F0aW9uLWJhZGdlXG4gICAgICBbbnVtYmVyXT1cImVsZW1lbnQub3B0aW9ucz8ubm90aWZpY2F0aW9uQmFkZ2U/LmxhYmVsIHx8IDBcIlxuICAgICAgW3N0eWxlXT1cImVsZW1lbnQub3B0aW9ucz8ubm90aWZpY2F0aW9uQmFkZ2U/LnN0eWxlXCJcbiAgICAgIGZvbnRTaXplPVwieHNcIlxuICAgID48L3RhLW5vdGlmaWNhdGlvbi1iYWRnZT5cbiAgICB9XG4gIDwvdGEtbm90aWZpY2F0aW9uLWJhZGdlLWNvbnRhaW5lcj5cbjwvbmctdGVtcGxhdGU+XG5cbjxuZy10ZW1wbGF0ZSAjSXRlbSBsZXQtaXRlbT1cIml0ZW1cIiBbdHlwZWRUZW1wbGF0ZV09XCJ0aGlzLnR5cGVJdGVtXCI+XG4gIDxkaXYgY2xhc3M9XCJpdGVtXCIgW2NsYXNzLmRpc2FibGVkXT1cIml0ZW0uZGlzYWJsZWRcIj5cbiAgICBAaWYgKHRoaXMuaGFzRm9udEljb24oaXRlbSkpIHtcbiAgICA8ZGl2IGNsYXNzPVwiaWNvblwiPlxuICAgICAgPHRhLWZvbnQtaWNvbiBbbmFtZV09XCJ0aGlzLmdldEZvbnRJY29uKGl0ZW0pXCI+PC90YS1mb250LWljb24+XG4gICAgPC9kaXY+XG4gICAgfSBAaWYgKGl0ZW0ubGFiZWwpIHtcbiAgICA8ZGl2IGNsYXNzPVwibGFiZWxcIj5cbiAgICAgIHt7IGl0ZW0ubGFiZWwgfCB0cmFuc2xhdGUgfX1cbiAgICA8L2Rpdj5cbiAgICB9IEBpZiAoaXRlbS50cmFuc2xhdGlvbkRhdGE/Lmxlbmd0aCkge1xuICAgIDxkaXYgY2xhc3M9XCJidWxsZXRcIj4oe3sgaXRlbS50cmFuc2xhdGlvbkRhdGE/Lmxlbmd0aCB9fSk8L2Rpdj5cbiAgICB9XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cbiJdfQ==