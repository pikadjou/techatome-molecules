import { NgClass, NgIf, NgTemplateOutlet } from '@angular/common';
import { Component, Input } from '@angular/core';
import { RouterModule } from '@angular/router';
import { TranslateModule } from '@ngx-translate/core';
import { FontIconComponent, LocalIconComponent } from '@ta/icons';
import { SwiperLightComponent } from '@ta/ui';
import { getFontIcon, getIcon, hasFontIcon, hasIconImage } from '../../helpers/icon-manager';
import { TaTranslationMenu } from '../../translation.service';
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "@ngx-translate/core";
/*
 ** @deprecated
 */
export class ToggleNavigationComponent {
    constructor() {
        this.activeKey = '';
        this.notifEnabled = false;
        TaTranslationMenu.getInstance();
    }
    get containerCss() {
        return this.container ?? '';
    }
    ngOnInit() {
        if (this.menu.elements.find(element => element.options?.notificationBadge?.label)) {
            this.notifEnabled = true;
        }
        const activeItem = this.menu.elements.find(item => item.defaultOpen);
        if (activeItem) {
            this.callback(activeItem);
        }
    }
    hasFontIcon(item) {
        return hasFontIcon(item);
    }
    hasIconImage(item) {
        return hasIconImage(item);
    }
    getIcon(item) {
        return getIcon(item);
    }
    getFontIcon(item) {
        return getFontIcon(item);
    }
    getLink(item) {
        if (item.link && item.link !== '')
            return item.link;
        return ''; // TODO this._navigationService.currentPageUrl;
    }
    callback(item) {
        if (item.disabled) {
            return;
        }
        this.activeKey = item.key;
        if (item.callback) {
            item.callback();
        }
    }
    isActive(item) {
        return item.key === this.activeKey;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: ToggleNavigationComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.14", type: ToggleNavigationComponent, isStandalone: true, selector: "ta-toggle-navigation", inputs: { menu: "menu", container: "container" }, ngImport: i0, template: "<div class=\"toggle-container\" [ngClass]=\"this.containerCss\" [class.switch-container]=\"this.container === 'switch'\">\n  <ta-swiper-light\n    [items]=\"this.menu.elements\"\n    [template]=\"template\"\n    [forced]=\"true\"\n    swiperClasses=\"g-space-lg pt-space-md\"\n  ></ta-swiper-light>\n</div>\n\n<ng-template #template let-element=\"element\">\n  @if (element.callback || element.disabled) {\n    <div\n      (click)=\"this.callback(element)\"\n      class=\"toggle-element\"\n      [class.active]=\"this.isActive(element)\"\n      [class.disabled]=\"element.disabled\"\n    >\n      <ng-template\n        [ngTemplateOutlet]=\"Item\"\n        [ngTemplateOutletContext]=\"{\n          item: element,\n        }\"\n      >\n      </ng-template>\n    </div>\n  } @else {\n    <div\n      class=\"toggle-element\"\n      routerLinkActive=\"active\"\n      [routerLinkActiveOptions]=\"{ exact: element.exact }\"\n      [routerLink]=\"[this.getLink(element)]\"\n      [queryParamsHandling]=\"element.queryParamsHandling\"\n      [replaceUrl]=\"element.replaceUrl\"\n      [ngClass]=\"{ disabled: element.disabled }\"\n    >\n      <ng-template\n        [ngTemplateOutlet]=\"Item\"\n        [ngTemplateOutletContext]=\"{\n          item: element,\n        }\"\n      >\n      </ng-template>\n    </div>\n  }\n</ng-template>\n\n<ng-template #Item let-item=\"item\" [typedTemplate]=\"this.typeItem\">\n  <div class=\"label flex-row align-center mb-space-xs\">\n    @if (this.hasFontIcon(item) || this.hasIconImage(item)) {\n      <div class=\"icon\">\n        @if (this.hasFontIcon(item)) {\n          <span class=\"icon-material\">\n            <ta-font-icon [name]=\"this.getFontIcon(item)\"></ta-font-icon>\n          </span>\n        } @else if (this.hasIconImage(item)) {\n          <span class=\"icon-image\">\n            <ta-local-icon [type]=\"this.getIcon(item)\" size=\"xs\"></ta-local-icon>\n          </span>\n        }\n      </div>\n    }\n    @if (item.label) {\n      <div class=\"text-truncate\">\n        {{ item.label | translate }}\n      </div>\n    }\n    @if (item.options?.notificationBadge !== null) {\n      <div class=\"badge ml-space-xs\">\n        {{ item.options?.notificationBadge?.label }}\n      </div>\n    }\n    @if (item.translationData?.length) {\n      <div>({{ item.translationData?.length }})</div>\n    }\n  </div>\n</ng-template>\n", styles: [".toggle-container{border-bottom:1px solid var(--ta-neutral-300)}.toggle-container.switch-container{overflow:hidden}.toggle-container .badge{width:20px;height:20px;background-color:var(--ta-brand-700);color:var(--ta-brand-50);border-radius:50%;display:flex;justify-content:center;align-items:center}.toggle-container .toggle-element{color:var(--ta-neutral-800);font-size:var(--ta-font-body-md-default-size);line-height:var(--ta-font-body-md-default-line);font-weight:var(--ta-font-body-md-bold-weight);cursor:pointer}.toggle-container .toggle-element .icon{margin:auto;color:var(--ta-brand-700)}.toggle-container .toggle-element.active .icon{color:var(--ta-icon-brand-primary)}.toggle-container.switch{border-radius:var(--ta-space-xs)}.toggle-container.switch .toggle-element{background:var(--ta-surface-secondary)}.toggle-container.switch .toggle-element.disabled{opacity:.5}.toggle-container.switch .toggle-element.active{background:var(--ta-brand-700);color:var(--ta-neutral-50)}.toggle-container.tab .toggle-element.disabled{opacity:.5}.toggle-container.tab .toggle-element.active{color:var(--ta-text-brand-primary);border-bottom:2px solid var(--ta-border-brand)}.label{font-size:var(--ta-font-body-md-default-size);line-height:var(--ta-font-body-md-default-line);font-weight:var(--ta-font-body-md-default-weight)}\n"], dependencies: [{ kind: "directive", type: NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "ngmodule", type: RouterModule }, { kind: "directive", type: i1.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "info", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "directive", type: i1.RouterLinkActive, selector: "[routerLinkActive]", inputs: ["routerLinkActiveOptions", "ariaCurrentWhenActive", "routerLinkActive"], outputs: ["isActiveChange"], exportAs: ["routerLinkActive"] }, { kind: "ngmodule", type: TranslateModule }, { kind: "pipe", type: i2.TranslatePipe, name: "translate" }, { kind: "component", type: FontIconComponent, selector: "ta-font-icon", inputs: ["name", "type"] }, { kind: "component", type: LocalIconComponent, selector: "ta-local-icon", inputs: ["type", "size", "rotation"] }, { kind: "component", type: SwiperLightComponent, selector: "ta-swiper-light", inputs: ["items", "template", "swiperClasses", "containerClasses", "forced"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: ToggleNavigationComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ta-toggle-navigation', standalone: true, imports: [
                        NgIf,
                        NgClass,
                        NgTemplateOutlet,
                        RouterModule,
                        TranslateModule,
                        FontIconComponent,
                        LocalIconComponent,
                        SwiperLightComponent,
                    ], template: "<div class=\"toggle-container\" [ngClass]=\"this.containerCss\" [class.switch-container]=\"this.container === 'switch'\">\n  <ta-swiper-light\n    [items]=\"this.menu.elements\"\n    [template]=\"template\"\n    [forced]=\"true\"\n    swiperClasses=\"g-space-lg pt-space-md\"\n  ></ta-swiper-light>\n</div>\n\n<ng-template #template let-element=\"element\">\n  @if (element.callback || element.disabled) {\n    <div\n      (click)=\"this.callback(element)\"\n      class=\"toggle-element\"\n      [class.active]=\"this.isActive(element)\"\n      [class.disabled]=\"element.disabled\"\n    >\n      <ng-template\n        [ngTemplateOutlet]=\"Item\"\n        [ngTemplateOutletContext]=\"{\n          item: element,\n        }\"\n      >\n      </ng-template>\n    </div>\n  } @else {\n    <div\n      class=\"toggle-element\"\n      routerLinkActive=\"active\"\n      [routerLinkActiveOptions]=\"{ exact: element.exact }\"\n      [routerLink]=\"[this.getLink(element)]\"\n      [queryParamsHandling]=\"element.queryParamsHandling\"\n      [replaceUrl]=\"element.replaceUrl\"\n      [ngClass]=\"{ disabled: element.disabled }\"\n    >\n      <ng-template\n        [ngTemplateOutlet]=\"Item\"\n        [ngTemplateOutletContext]=\"{\n          item: element,\n        }\"\n      >\n      </ng-template>\n    </div>\n  }\n</ng-template>\n\n<ng-template #Item let-item=\"item\" [typedTemplate]=\"this.typeItem\">\n  <div class=\"label flex-row align-center mb-space-xs\">\n    @if (this.hasFontIcon(item) || this.hasIconImage(item)) {\n      <div class=\"icon\">\n        @if (this.hasFontIcon(item)) {\n          <span class=\"icon-material\">\n            <ta-font-icon [name]=\"this.getFontIcon(item)\"></ta-font-icon>\n          </span>\n        } @else if (this.hasIconImage(item)) {\n          <span class=\"icon-image\">\n            <ta-local-icon [type]=\"this.getIcon(item)\" size=\"xs\"></ta-local-icon>\n          </span>\n        }\n      </div>\n    }\n    @if (item.label) {\n      <div class=\"text-truncate\">\n        {{ item.label | translate }}\n      </div>\n    }\n    @if (item.options?.notificationBadge !== null) {\n      <div class=\"badge ml-space-xs\">\n        {{ item.options?.notificationBadge?.label }}\n      </div>\n    }\n    @if (item.translationData?.length) {\n      <div>({{ item.translationData?.length }})</div>\n    }\n  </div>\n</ng-template>\n", styles: [".toggle-container{border-bottom:1px solid var(--ta-neutral-300)}.toggle-container.switch-container{overflow:hidden}.toggle-container .badge{width:20px;height:20px;background-color:var(--ta-brand-700);color:var(--ta-brand-50);border-radius:50%;display:flex;justify-content:center;align-items:center}.toggle-container .toggle-element{color:var(--ta-neutral-800);font-size:var(--ta-font-body-md-default-size);line-height:var(--ta-font-body-md-default-line);font-weight:var(--ta-font-body-md-bold-weight);cursor:pointer}.toggle-container .toggle-element .icon{margin:auto;color:var(--ta-brand-700)}.toggle-container .toggle-element.active .icon{color:var(--ta-icon-brand-primary)}.toggle-container.switch{border-radius:var(--ta-space-xs)}.toggle-container.switch .toggle-element{background:var(--ta-surface-secondary)}.toggle-container.switch .toggle-element.disabled{opacity:.5}.toggle-container.switch .toggle-element.active{background:var(--ta-brand-700);color:var(--ta-neutral-50)}.toggle-container.tab .toggle-element.disabled{opacity:.5}.toggle-container.tab .toggle-element.active{color:var(--ta-text-brand-primary);border-bottom:2px solid var(--ta-border-brand)}.label{font-size:var(--ta-font-body-md-default-size);line-height:var(--ta-font-body-md-default-line);font-weight:var(--ta-font-body-md-default-weight)}\n"] }]
        }], ctorParameters: () => [], propDecorators: { menu: [{
                type: Input
            }], container: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9nZ2xlLW5hdmlnYXRpb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9jb21wb25lbnRzL3RvZ2dsZS1uYXZpZ2F0aW9uL3RvZ2dsZS1uYXZpZ2F0aW9uLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy90b2dnbGUtbmF2aWdhdGlvbi90b2dnbGUtbmF2aWdhdGlvbi5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ2xFLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3pELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUUvQyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFFdEQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLGtCQUFrQixFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ2xFLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUU5QyxPQUFPLEVBQUUsV0FBVyxFQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFLN0YsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7Ozs7QUFFOUQ7O0dBRUc7QUFpQkgsTUFBTSxPQUFPLHlCQUF5QjtJQVdwQztRQUpPLGNBQVMsR0FBVyxFQUFFLENBQUM7UUFFdkIsaUJBQVksR0FBWSxLQUFLLENBQUM7UUFHbkMsaUJBQWlCLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDbEMsQ0FBQztJQUVELElBQUksWUFBWTtRQUNkLE9BQU8sSUFBSSxDQUFDLFNBQVMsSUFBSSxFQUFFLENBQUM7SUFDOUIsQ0FBQztJQUVELFFBQVE7UUFDTixJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUNsRixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQztRQUMzQixDQUFDO1FBRUQsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3JFLElBQUksVUFBVSxFQUFFLENBQUM7WUFDZixJQUFJLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzVCLENBQUM7SUFDSCxDQUFDO0lBRU0sV0FBVyxDQUFDLElBQXNDO1FBQ3ZELE9BQU8sV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUFFTSxZQUFZLENBQUMsSUFBc0M7UUFDeEQsT0FBTyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDNUIsQ0FBQztJQUVNLE9BQU8sQ0FBQyxJQUFzQztRQUNuRCxPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN2QixDQUFDO0lBRU0sV0FBVyxDQUFDLElBQXNDO1FBQ3ZELE9BQU8sV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUFFTSxPQUFPLENBQUMsSUFBc0M7UUFDbkQsSUFBSSxJQUFJLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssRUFBRTtZQUFFLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQztRQUVwRCxPQUFPLEVBQUUsQ0FBQyxDQUFDLCtDQUErQztJQUM1RCxDQUFDO0lBRU0sUUFBUSxDQUFDLElBQWM7UUFDNUIsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDbEIsT0FBTztRQUNULENBQUM7UUFDRCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUM7UUFDMUIsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDbEIsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2xCLENBQUM7SUFDSCxDQUFDO0lBRU0sUUFBUSxDQUFDLElBQWM7UUFDNUIsT0FBTyxJQUFJLENBQUMsR0FBRyxLQUFLLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDckMsQ0FBQzsrR0FoRVUseUJBQXlCO21HQUF6Qix5QkFBeUIsa0lDbkN0Qyw4MEVBNEVBLGkyQ0RsREksT0FBTyxvRkFDUCxnQkFBZ0IsbUpBQ2hCLFlBQVksZ2ZBQ1osZUFBZSw0RkFDZixpQkFBaUIsbUZBQ2pCLGtCQUFrQixnR0FDbEIsb0JBQW9COzs0RkFHWCx5QkFBeUI7a0JBaEJyQyxTQUFTOytCQUNFLHNCQUFzQixjQUdwQixJQUFJLFdBQ1A7d0JBQ1AsSUFBSTt3QkFDSixPQUFPO3dCQUNQLGdCQUFnQjt3QkFDaEIsWUFBWTt3QkFDWixlQUFlO3dCQUNmLGlCQUFpQjt3QkFDakIsa0JBQWtCO3dCQUNsQixvQkFBb0I7cUJBQ3JCO3dEQUlELElBQUk7c0JBREgsS0FBSztnQkFJTixTQUFTO3NCQURSLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZ0NsYXNzLCBOZ0lmLCBOZ1RlbXBsYXRlT3V0bGV0IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUm91dGVyTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcblxuaW1wb3J0IHsgVHJhbnNsYXRlTW9kdWxlIH0gZnJvbSAnQG5neC10cmFuc2xhdGUvY29yZSc7XG5cbmltcG9ydCB7IEZvbnRJY29uQ29tcG9uZW50LCBMb2NhbEljb25Db21wb25lbnQgfSBmcm9tICdAdGEvaWNvbnMnO1xuaW1wb3J0IHsgU3dpcGVyTGlnaHRDb21wb25lbnQgfSBmcm9tICdAdGEvdWknO1xuXG5pbXBvcnQgeyBnZXRGb250SWNvbiwgZ2V0SWNvbiwgaGFzRm9udEljb24sIGhhc0ljb25JbWFnZSB9IGZyb20gJy4uLy4uL2hlbHBlcnMvaWNvbi1tYW5hZ2VyJztcbmltcG9ydCB7IE1lbnVBY3Rpb24gfSBmcm9tICcuLi8uLi9tb2RlbHMvbWVudS9pdGVtL2FjdGlvbic7XG5pbXBvcnQgeyBNZW51QmFzZSB9IGZyb20gJy4uLy4uL21vZGVscy9tZW51L2l0ZW0vYmFzZSc7XG5pbXBvcnQgeyBNZW51SWNvbiB9IGZyb20gJy4uLy4uL21vZGVscy9tZW51L2l0ZW0vaWNvbic7XG5pbXBvcnQgeyBNZW51IH0gZnJvbSAnLi4vLi4vbW9kZWxzL21lbnUvbWVudSc7XG5pbXBvcnQgeyBUYVRyYW5zbGF0aW9uTWVudSB9IGZyb20gJy4uLy4uL3RyYW5zbGF0aW9uLnNlcnZpY2UnO1xuXG4vKlxuICoqIEBkZXByZWNhdGVkXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RhLXRvZ2dsZS1uYXZpZ2F0aW9uJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3RvZ2dsZS1uYXZpZ2F0aW9uLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vdG9nZ2xlLW5hdmlnYXRpb24uY29tcG9uZW50LnNjc3MnXSxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW1xuICAgIE5nSWYsXG4gICAgTmdDbGFzcyxcbiAgICBOZ1RlbXBsYXRlT3V0bGV0LFxuICAgIFJvdXRlck1vZHVsZSxcbiAgICBUcmFuc2xhdGVNb2R1bGUsXG4gICAgRm9udEljb25Db21wb25lbnQsXG4gICAgTG9jYWxJY29uQ29tcG9uZW50LFxuICAgIFN3aXBlckxpZ2h0Q29tcG9uZW50LFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBUb2dnbGVOYXZpZ2F0aW9uQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KClcbiAgbWVudSE6IE1lbnU7XG5cbiAgQElucHV0KClcbiAgY29udGFpbmVyITogJ3RhYicgfCAnc3dpdGNoJztcblxuICBwdWJsaWMgYWN0aXZlS2V5OiBzdHJpbmcgPSAnJztcbiAgcHVibGljIHJlYWRvbmx5IHR5cGVJdGVtITogeyBpdGVtOiBNZW51QmFzZSB8IE1lbnVBY3Rpb24gfCBNZW51SWNvbiB9O1xuICBwdWJsaWMgbm90aWZFbmFibGVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgVGFUcmFuc2xhdGlvbk1lbnUuZ2V0SW5zdGFuY2UoKTtcbiAgfVxuXG4gIGdldCBjb250YWluZXJDc3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udGFpbmVyID8/ICcnO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgaWYgKHRoaXMubWVudS5lbGVtZW50cy5maW5kKGVsZW1lbnQgPT4gZWxlbWVudC5vcHRpb25zPy5ub3RpZmljYXRpb25CYWRnZT8ubGFiZWwpKSB7XG4gICAgICB0aGlzLm5vdGlmRW5hYmxlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgY29uc3QgYWN0aXZlSXRlbSA9IHRoaXMubWVudS5lbGVtZW50cy5maW5kKGl0ZW0gPT4gaXRlbS5kZWZhdWx0T3Blbik7XG4gICAgaWYgKGFjdGl2ZUl0ZW0pIHtcbiAgICAgIHRoaXMuY2FsbGJhY2soYWN0aXZlSXRlbSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGhhc0ZvbnRJY29uKGl0ZW06IE1lbnVJY29uIHwgTWVudUFjdGlvbiB8IE1lbnVCYXNlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGhhc0ZvbnRJY29uKGl0ZW0pO1xuICB9XG5cbiAgcHVibGljIGhhc0ljb25JbWFnZShpdGVtOiBNZW51SWNvbiB8IE1lbnVBY3Rpb24gfCBNZW51QmFzZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBoYXNJY29uSW1hZ2UoaXRlbSk7XG4gIH1cblxuICBwdWJsaWMgZ2V0SWNvbihpdGVtOiBNZW51SWNvbiB8IE1lbnVBY3Rpb24gfCBNZW51QmFzZSkge1xuICAgIHJldHVybiBnZXRJY29uKGl0ZW0pO1xuICB9XG5cbiAgcHVibGljIGdldEZvbnRJY29uKGl0ZW06IE1lbnVJY29uIHwgTWVudUFjdGlvbiB8IE1lbnVCYXNlKSB7XG4gICAgcmV0dXJuIGdldEZvbnRJY29uKGl0ZW0pO1xuICB9XG5cbiAgcHVibGljIGdldExpbmsoaXRlbTogTWVudUljb24gfCBNZW51QWN0aW9uIHwgTWVudUJhc2UpIHtcbiAgICBpZiAoaXRlbS5saW5rICYmIGl0ZW0ubGluayAhPT0gJycpIHJldHVybiBpdGVtLmxpbms7XG5cbiAgICByZXR1cm4gJyc7IC8vIFRPRE8gdGhpcy5fbmF2aWdhdGlvblNlcnZpY2UuY3VycmVudFBhZ2VVcmw7XG4gIH1cblxuICBwdWJsaWMgY2FsbGJhY2soaXRlbTogTWVudUJhc2UpIHtcbiAgICBpZiAoaXRlbS5kaXNhYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmFjdGl2ZUtleSA9IGl0ZW0ua2V5O1xuICAgIGlmIChpdGVtLmNhbGxiYWNrKSB7XG4gICAgICBpdGVtLmNhbGxiYWNrKCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGlzQWN0aXZlKGl0ZW06IE1lbnVCYXNlKSB7XG4gICAgcmV0dXJuIGl0ZW0ua2V5ID09PSB0aGlzLmFjdGl2ZUtleTtcbiAgfVxufVxuIiwiPGRpdiBjbGFzcz1cInRvZ2dsZS1jb250YWluZXJcIiBbbmdDbGFzc109XCJ0aGlzLmNvbnRhaW5lckNzc1wiIFtjbGFzcy5zd2l0Y2gtY29udGFpbmVyXT1cInRoaXMuY29udGFpbmVyID09PSAnc3dpdGNoJ1wiPlxuICA8dGEtc3dpcGVyLWxpZ2h0XG4gICAgW2l0ZW1zXT1cInRoaXMubWVudS5lbGVtZW50c1wiXG4gICAgW3RlbXBsYXRlXT1cInRlbXBsYXRlXCJcbiAgICBbZm9yY2VkXT1cInRydWVcIlxuICAgIHN3aXBlckNsYXNzZXM9XCJnLXNwYWNlLWxnIHB0LXNwYWNlLW1kXCJcbiAgPjwvdGEtc3dpcGVyLWxpZ2h0PlxuPC9kaXY+XG5cbjxuZy10ZW1wbGF0ZSAjdGVtcGxhdGUgbGV0LWVsZW1lbnQ9XCJlbGVtZW50XCI+XG4gIEBpZiAoZWxlbWVudC5jYWxsYmFjayB8fCBlbGVtZW50LmRpc2FibGVkKSB7XG4gICAgPGRpdlxuICAgICAgKGNsaWNrKT1cInRoaXMuY2FsbGJhY2soZWxlbWVudClcIlxuICAgICAgY2xhc3M9XCJ0b2dnbGUtZWxlbWVudFwiXG4gICAgICBbY2xhc3MuYWN0aXZlXT1cInRoaXMuaXNBY3RpdmUoZWxlbWVudClcIlxuICAgICAgW2NsYXNzLmRpc2FibGVkXT1cImVsZW1lbnQuZGlzYWJsZWRcIlxuICAgID5cbiAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICBbbmdUZW1wbGF0ZU91dGxldF09XCJJdGVtXCJcbiAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cIntcbiAgICAgICAgICBpdGVtOiBlbGVtZW50LFxuICAgICAgICB9XCJcbiAgICAgID5cbiAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgPC9kaXY+XG4gIH0gQGVsc2Uge1xuICAgIDxkaXZcbiAgICAgIGNsYXNzPVwidG9nZ2xlLWVsZW1lbnRcIlxuICAgICAgcm91dGVyTGlua0FjdGl2ZT1cImFjdGl2ZVwiXG4gICAgICBbcm91dGVyTGlua0FjdGl2ZU9wdGlvbnNdPVwieyBleGFjdDogZWxlbWVudC5leGFjdCB9XCJcbiAgICAgIFtyb3V0ZXJMaW5rXT1cIlt0aGlzLmdldExpbmsoZWxlbWVudCldXCJcbiAgICAgIFtxdWVyeVBhcmFtc0hhbmRsaW5nXT1cImVsZW1lbnQucXVlcnlQYXJhbXNIYW5kbGluZ1wiXG4gICAgICBbcmVwbGFjZVVybF09XCJlbGVtZW50LnJlcGxhY2VVcmxcIlxuICAgICAgW25nQ2xhc3NdPVwieyBkaXNhYmxlZDogZWxlbWVudC5kaXNhYmxlZCB9XCJcbiAgICA+XG4gICAgICA8bmctdGVtcGxhdGVcbiAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwiSXRlbVwiXG4gICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7XG4gICAgICAgICAgaXRlbTogZWxlbWVudCxcbiAgICAgICAgfVwiXG4gICAgICA+XG4gICAgICA8L25nLXRlbXBsYXRlPlxuICAgIDwvZGl2PlxuICB9XG48L25nLXRlbXBsYXRlPlxuXG48bmctdGVtcGxhdGUgI0l0ZW0gbGV0LWl0ZW09XCJpdGVtXCIgW3R5cGVkVGVtcGxhdGVdPVwidGhpcy50eXBlSXRlbVwiPlxuICA8ZGl2IGNsYXNzPVwibGFiZWwgZmxleC1yb3cgYWxpZ24tY2VudGVyIG1iLXNwYWNlLXhzXCI+XG4gICAgQGlmICh0aGlzLmhhc0ZvbnRJY29uKGl0ZW0pIHx8IHRoaXMuaGFzSWNvbkltYWdlKGl0ZW0pKSB7XG4gICAgICA8ZGl2IGNsYXNzPVwiaWNvblwiPlxuICAgICAgICBAaWYgKHRoaXMuaGFzRm9udEljb24oaXRlbSkpIHtcbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImljb24tbWF0ZXJpYWxcIj5cbiAgICAgICAgICAgIDx0YS1mb250LWljb24gW25hbWVdPVwidGhpcy5nZXRGb250SWNvbihpdGVtKVwiPjwvdGEtZm9udC1pY29uPlxuICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgfSBAZWxzZSBpZiAodGhpcy5oYXNJY29uSW1hZ2UoaXRlbSkpIHtcbiAgICAgICAgICA8c3BhbiBjbGFzcz1cImljb24taW1hZ2VcIj5cbiAgICAgICAgICAgIDx0YS1sb2NhbC1pY29uIFt0eXBlXT1cInRoaXMuZ2V0SWNvbihpdGVtKVwiIHNpemU9XCJ4c1wiPjwvdGEtbG9jYWwtaWNvbj5cbiAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIH1cbiAgICAgIDwvZGl2PlxuICAgIH1cbiAgICBAaWYgKGl0ZW0ubGFiZWwpIHtcbiAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0LXRydW5jYXRlXCI+XG4gICAgICAgIHt7IGl0ZW0ubGFiZWwgfCB0cmFuc2xhdGUgfX1cbiAgICAgIDwvZGl2PlxuICAgIH1cbiAgICBAaWYgKGl0ZW0ub3B0aW9ucz8ubm90aWZpY2F0aW9uQmFkZ2UgIT09IG51bGwpIHtcbiAgICAgIDxkaXYgY2xhc3M9XCJiYWRnZSBtbC1zcGFjZS14c1wiPlxuICAgICAgICB7eyBpdGVtLm9wdGlvbnM/Lm5vdGlmaWNhdGlvbkJhZGdlPy5sYWJlbCB9fVxuICAgICAgPC9kaXY+XG4gICAgfVxuICAgIEBpZiAoaXRlbS50cmFuc2xhdGlvbkRhdGE/Lmxlbmd0aCkge1xuICAgICAgPGRpdj4oe3sgaXRlbS50cmFuc2xhdGlvbkRhdGE/Lmxlbmd0aCB9fSk8L2Rpdj5cbiAgICB9XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cbiJdfQ==