import { AsyncPipe, NgTemplateOutlet } from "@angular/common";
import { Component, ViewChild } from "@angular/core";
import { ReactiveFormsModule } from "@angular/forms";
import { TranslateModule } from "@ngx-translate/core";
import { BehaviorSubject, combineLatest, concatMap, debounceTime, filter, map, of, startWith, take, tap, } from "rxjs";
import { InputCheckBox, InputTextBox, } from "@ta/form-model";
import { FontIconComponent } from "@ta/icons";
import { ButtonComponent, EmptyComponent, LabelComponent, LayoutSideComponent, LayoutSideContentComponent, LayoutSideCtaComponent, LinkComponent, LoaderComponent, TextComponent, } from "@ta/ui";
import { TaOverlayPanelComponent } from "@ta/ui";
import { StopPropagationDirective, isNonNullable } from "@ta/utils";
import { getUniqueArray, toArray } from "@ta/utils";
import { TaAbstractInputComponent } from "../../abstract.component";
import { InputLayoutComponent } from "../../input-layout/input-layout.component";
import { CheckboxComponent } from "../checkbox/checkbox.component";
import { SearchFieldComponent } from "../search-field/search-field.component";
import * as i0 from "@angular/core";
import * as i1 from "@ngx-translate/core";
import * as i2 from "@angular/forms";
export class InputChoicesComponent extends TaAbstractInputComponent {
    constructor() {
        super();
        this.inputSearch = new InputTextBox();
        this.inputNullable = new InputCheckBox({
            label: "form.input.choices.nullable.label",
        });
        this.filteredOptions$ = null;
        this.bOptions$ = new BehaviorSubject([]);
        this.searchFocus = new BehaviorSubject(undefined);
        this.refresh = () => {
            (this.input.advancedSearch$ ? this.input.advancedSearch$() : of())
                .pipe(take(1))
                .subscribe({
                next: (data) => {
                    this.bOptions$.next(data);
                },
            });
        };
        this.select = (option) => {
            const values = this.input.value ?? [];
            if (values.includes(option.id)) {
                this.input.value = values.filter((val) => val !== option.id);
                return;
            }
            if (!this.input.multiple) {
                this.input.value = [option.id];
                this.close();
                return;
            }
            this.input.value = [...values, option.id];
        };
        this.isSelected = (option) => {
            const values = toArray(this.input.value);
            return values.includes(option.id);
        };
    }
    ngOnInit() {
        super.ngOnInit();
        if (!this.input.advancedSearch$) {
            this.requestState.asked();
            this._registerSubscription(this.input.options$.subscribe({
                next: (data) => {
                    this.bOptions$.next(data);
                    this.requestState.completed();
                },
            }));
            this.filteredOptions$ = combineLatest([
                this.inputSearch.changeValue$.pipe(startWith(""), filter(isNonNullable)),
                this.bOptions$,
            ]).pipe(map((data) => ({
                search: data[0],
                list: data[1],
            })), map(({ search, list }) => list.filter((item) => item.name.toLocaleLowerCase().includes(search.toLocaleLowerCase()))));
        }
        else {
            this.filteredOptions$ = this.bOptions$;
            this.refresh();
            this._registerSubscription(this.inputSearch.changeValue$
                .pipe(debounceTime(500), filter(isNonNullable), tap(() => this.requestState.asked()), concatMap((search) => this.input.advancedSearch$
                ? this.input.advancedSearch$(search)
                : of()))
                .subscribe({
                next: (data) => {
                    const prevData = this.bOptions$.getValue();
                    this.bOptions$.next(getUniqueArray([
                        ...prevData.filter((item) => this.input.value?.includes(item.id)),
                        ...data,
                    ]));
                    this.requestState.completed();
                },
            }));
        }
    }
    ngAfterViewInit() {
        super.ngAfterViewInit();
        this.searchFocus.next();
    }
    getName$(id) {
        return this.bOptions$.pipe(map((values) => values.find((value) => value.id === id)?.name ?? null), map((name) => name ?? id));
    }
    selectNullable(select) {
        if (!select) {
            this.input.value = [];
            return;
        }
        this.input.value = [""];
    }
    clear() {
        this.input.formControl?.setValue([]);
        this.close();
    }
    close() {
        this.focusedElement.nativeElement.click();
        this.overlayPanelRef.close();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: InputChoicesComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.14", type: InputChoicesComponent, isStandalone: true, selector: "ta-input-choices", viewQueries: [{ propertyName: "overlayPanelRef", first: true, predicate: TaOverlayPanelComponent, descendants: true }], usesInheritance: true, ngImport: i0, template: "@if (this.input.onlyTemplate !== true) {\n<ta-overlay-panel [panelConfig]=\"{ matchTriggerWidth: false }\">\n  <ng-template #panelTrigger>\n    <ta-input-layout [input]=\"this.input\">\n      <div class=\"form-control\" #focusedElement>\n        <div class=\"input-group d-flex full-width\">\n          <input\n            type=\"hidden\"\n            [formControl]=\"$any(this.input.formControl)\"\n            [value]=\"this.input.value\"\n          />\n\n          <div class=\"flex-start g-space-xs\">\n            @for (value of this.input.value; track value) {\n            <ta-label size=\"sm\" class=\"d-flex\">\n              {{ (getName$(value) | async) ?? \"\" | translate }}\n            </ta-label>\n            }\n          </div>\n          @if (this.input.message) {\n          <div class=\"message\">\n            <small class=\"form-text text-muted\">\n              <span>{{ this.input.message }}</span>\n            </small>\n          </div>\n          }\n        </div>\n      </div>\n    </ta-input-layout>\n  </ng-template>\n  <ng-template #panelContent>\n    <ng-template [ngTemplateOutlet]=\"choicesTemplate\"></ng-template>\n  </ng-template>\n</ta-overlay-panel>\n} @else {\n<div class=\"only-template\">\n  <ng-template [ngTemplateOutlet]=\"choicesTemplate\"></ng-template>\n</div>\n}\n\n<ng-template #choicesTemplate>\n  <div appStopPropagation class=\"flex-column g-space-sm\">\n    @if (!this.input.choiceTemplate) { @if (this.input.withSearch) {\n    <ta-search-field\n      [isOpen]=\"true\"\n      [input]=\"this.inputSearch\"\n      [onFocus]=\"this.searchFocus\"\n      [standalone]=\"true\"\n      class=\"m-space-sm\"\n    ></ta-search-field>\n    }\n\n    <ta-layout-side\n      class=\"d-flex full-width choices-wrapper\"\n      style=\"min-height: 300px; max-height: 400px\"\n    >\n      <ta-layout-side-content>\n        <ta-loader [isLoading]=\"this.requestState.isLoading()\">\n          <ta-empty [isEmpty]=\"(this.filteredOptions$ | async)?.length === 0\">\n            @if (this.input.showNullableFields) {\n            <div class=\"p-space-sm\">\n              <ta-input-checkbox\n                [input]=\"this.inputNullable\"\n                [standalone]=\"true\"\n                (valueChanged)=\"this.selectNullable($event)\"\n              ></ta-input-checkbox>\n            </div>\n            } @for (option of this.filteredOptions$ | async; track option) {\n            <div\n              class=\"flex-row pointer m-space-sm p-space-sm\"\n              [class.is-selected]=\"this.isSelected(option)\"\n              (click)=\"this.select(option)\"\n            >\n              <ta-text>{{ option.name }}</ta-text>\n            </div>\n            }\n          </ta-empty>\n        </ta-loader>\n      </ta-layout-side-content>\n      <ta-layout-side-cta>\n        <div class=\"align-center space-between\">\n          <div class=\"pr-space-md\">\n            <div class=\"align-center g-space-xs link\">\n              <ta-font-icon name=\"close-tool\" type=\"sm\"></ta-font-icon>\n              <ta-link class=\"c-pointer\" (action)=\"this.clear()\">\n                {{ \"core.filter.clear\" | translate }}\n              </ta-link>\n            </div>\n          </div>\n          <div>\n            @if (this.input.onlyTemplate !== true) {\n            <ta-button (action)=\"this.close()\">\n              <div class=\"align-center m-space-xs\">\n                <ta-font-icon name=\"check-line\"></ta-font-icon>\n                {{ \"form.validate\" | translate }}\n              </div>\n            </ta-button>\n            }\n          </div>\n        </div>\n      </ta-layout-side-cta>\n    </ta-layout-side>\n    } @else if (this.input.choiceTemplate && this.filteredOptions$) { @if\n    (this.input.withSearch) {\n    <ta-search-field\n      [isOpen]=\"true\"\n      [input]=\"this.inputSearch\"\n      [onFocus]=\"this.searchFocus\"\n      class=\"m-space-sm\"\n      [standalone]=\"true\"\n    ></ta-search-field>\n    }\n    <ta-layout-side\n      class=\"d-flex full-width\"\n      style=\"min-height: 300px; max-height: 400px\"\n    >\n      <ta-layout-side-content>\n        <ta-loader [isLoading]=\"this.requestState.isLoading()\">\n          @if (this.input.choiceTemplate.one) {\n          <ta-empty [isEmpty]=\"(this.filteredOptions$ | async)?.length === 0\">\n            @for (option of this.filteredOptions$ | async; track option) {\n            <div\n              class=\"flex-row pointer m-space-sm p-space-sm\"\n              [class.is-selected]=\"this.isSelected(option)\"\n              (click)=\"this.select(option)\"\n            >\n              <ng-template\n                [ngTemplateOutlet]=\"this.input.choiceTemplate.one\"\n                [ngTemplateOutletContext]=\"{ item: option.data }\"\n              ></ng-template>\n            </div>\n            }\n          </ta-empty>\n          } @else if (this.input.choiceTemplate.list) {\n          <ng-template\n            [ngTemplateOutlet]=\"this.input.choiceTemplate.list\"\n            [ngTemplateOutletContext]=\"{\n                  data: {\n                    items: this.filteredOptions$ | async,\n                    isselected: this.isSelected,\n                    select: this.select,\n                    search: this.inputSearch.value,\n                    refresh: this.refresh,\n                  },\n                }\"\n          ></ng-template>\n          }\n        </ta-loader>\n      </ta-layout-side-content>\n      <ta-layout-side-cta>\n        <div class=\"align-center space-between\">\n          <div class=\"pr-space-md\">\n            <div class=\"align-center g-space-xs link\">\n              <ta-font-icon name=\"close-tool\" type=\"sm\"></ta-font-icon>\n              <ta-link class=\"c-pointer\" (action)=\"this.clear()\">\n                {{ \"core.filter.clear\" | translate }}\n              </ta-link>\n            </div>\n          </div>\n          <div>\n            @if (this.input.onlyTemplate !== true) {\n            <ta-button (action)=\"this.close()\">\n              <div class=\"align-center m-space-xs\">\n                <ta-font-icon name=\"check-line\"></ta-font-icon>\n                {{ \"form.validate\" | translate }}\n              </div>\n            </ta-button>\n            }\n          </div>\n        </div>\n      </ta-layout-side-cta>\n    </ta-layout-side>\n    }\n  </div>\n</ng-template>\n", styles: [".textbox-container{width:100%}.input-group{position:relative}.input-group .action{position:absolute;right:8px;top:16px;bottom:0}.is-selected{border:1px solid var(--ta-border-secondary);border-radius:var(--ta-radius-full)}.menu-panel{background-color:var(--ta-neutral-white);border-radius:var(--ta-radius-rounded);border:1px solid;border-color:var(--ta-neutral-300);overflow:hidden}.choices-wrapper{overflow:visible;max-height:none}.only-template{background:var(--ta-neutral-white);border-radius:var(--ta-radius-rounded)}\n"], dependencies: [{ kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "component", type: FontIconComponent, selector: "ta-font-icon", inputs: ["name", "type"] }, { kind: "directive", type: StopPropagationDirective, selector: "[appStopPropagation]", inputs: ["stopPropagationActivation"] }, { kind: "ngmodule", type: TranslateModule }, { kind: "pipe", type: i1.TranslatePipe, name: "translate" }, { kind: "component", type: ButtonComponent, selector: "ta-button", inputs: ["state", "type", "size", "icon", "options", "stopPropagationActivation"], outputs: ["action"] }, { kind: "component", type: LinkComponent, selector: "ta-link", inputs: ["state", "underline", "bold", "size", "icon"], outputs: ["action"] }, { kind: "component", type: TaOverlayPanelComponent, selector: "ta-overlay-panel", inputs: ["panelConfig", "position"], outputs: ["closed"] }, { kind: "component", type: EmptyComponent, selector: "ta-empty", inputs: ["isEmpty", "isLight", "showMessage", "text", "type", "icon", "iconSize"] }, { kind: "component", type: LoaderComponent, selector: "ta-loader", inputs: ["isLoading", "skeleton", "size", "text"] }, { kind: "component", type: LayoutSideCtaComponent, selector: "ta-layout-side-cta", inputs: ["background"] }, { kind: "component", type: LayoutSideContentComponent, selector: "ta-layout-side-content" }, { kind: "component", type: LayoutSideComponent, selector: "ta-layout-side" }, { kind: "component", type: SearchFieldComponent, selector: "ta-search-field", inputs: ["isOpen", "placeholder", "space", "type"], outputs: ["valueCompleted"] }, { kind: "component", type: LabelComponent, selector: "ta-label", inputs: ["size", "type"] }, { kind: "component", type: TextComponent, selector: "ta-text", inputs: ["size", "isBold", "color"] }, { kind: "component", type: CheckboxComponent, selector: "ta-input-checkbox" }, { kind: "ngmodule", type: ReactiveFormsModule }, { kind: "directive", type: i2.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i2.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i2.FormControlDirective, selector: "[formControl]", inputs: ["formControl", "disabled", "ngModel"], outputs: ["ngModelChange"], exportAs: ["ngForm"] }, { kind: "component", type: InputLayoutComponent, selector: "ta-input-layout", inputs: ["input", "width", "height"] }, { kind: "directive", type: NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: InputChoicesComponent, decorators: [{
            type: Component,
            args: [{ selector: "ta-input-choices", standalone: true, imports: [
                        AsyncPipe,
                        FontIconComponent,
                        StopPropagationDirective,
                        TranslateModule,
                        ButtonComponent,
                        LinkComponent,
                        TaOverlayPanelComponent,
                        EmptyComponent,
                        LoaderComponent,
                        LayoutSideCtaComponent,
                        LayoutSideContentComponent,
                        LayoutSideComponent,
                        SearchFieldComponent,
                        LabelComponent,
                        TextComponent,
                        CheckboxComponent,
                        ReactiveFormsModule,
                        InputLayoutComponent,
                        NgTemplateOutlet,
                    ], template: "@if (this.input.onlyTemplate !== true) {\n<ta-overlay-panel [panelConfig]=\"{ matchTriggerWidth: false }\">\n  <ng-template #panelTrigger>\n    <ta-input-layout [input]=\"this.input\">\n      <div class=\"form-control\" #focusedElement>\n        <div class=\"input-group d-flex full-width\">\n          <input\n            type=\"hidden\"\n            [formControl]=\"$any(this.input.formControl)\"\n            [value]=\"this.input.value\"\n          />\n\n          <div class=\"flex-start g-space-xs\">\n            @for (value of this.input.value; track value) {\n            <ta-label size=\"sm\" class=\"d-flex\">\n              {{ (getName$(value) | async) ?? \"\" | translate }}\n            </ta-label>\n            }\n          </div>\n          @if (this.input.message) {\n          <div class=\"message\">\n            <small class=\"form-text text-muted\">\n              <span>{{ this.input.message }}</span>\n            </small>\n          </div>\n          }\n        </div>\n      </div>\n    </ta-input-layout>\n  </ng-template>\n  <ng-template #panelContent>\n    <ng-template [ngTemplateOutlet]=\"choicesTemplate\"></ng-template>\n  </ng-template>\n</ta-overlay-panel>\n} @else {\n<div class=\"only-template\">\n  <ng-template [ngTemplateOutlet]=\"choicesTemplate\"></ng-template>\n</div>\n}\n\n<ng-template #choicesTemplate>\n  <div appStopPropagation class=\"flex-column g-space-sm\">\n    @if (!this.input.choiceTemplate) { @if (this.input.withSearch) {\n    <ta-search-field\n      [isOpen]=\"true\"\n      [input]=\"this.inputSearch\"\n      [onFocus]=\"this.searchFocus\"\n      [standalone]=\"true\"\n      class=\"m-space-sm\"\n    ></ta-search-field>\n    }\n\n    <ta-layout-side\n      class=\"d-flex full-width choices-wrapper\"\n      style=\"min-height: 300px; max-height: 400px\"\n    >\n      <ta-layout-side-content>\n        <ta-loader [isLoading]=\"this.requestState.isLoading()\">\n          <ta-empty [isEmpty]=\"(this.filteredOptions$ | async)?.length === 0\">\n            @if (this.input.showNullableFields) {\n            <div class=\"p-space-sm\">\n              <ta-input-checkbox\n                [input]=\"this.inputNullable\"\n                [standalone]=\"true\"\n                (valueChanged)=\"this.selectNullable($event)\"\n              ></ta-input-checkbox>\n            </div>\n            } @for (option of this.filteredOptions$ | async; track option) {\n            <div\n              class=\"flex-row pointer m-space-sm p-space-sm\"\n              [class.is-selected]=\"this.isSelected(option)\"\n              (click)=\"this.select(option)\"\n            >\n              <ta-text>{{ option.name }}</ta-text>\n            </div>\n            }\n          </ta-empty>\n        </ta-loader>\n      </ta-layout-side-content>\n      <ta-layout-side-cta>\n        <div class=\"align-center space-between\">\n          <div class=\"pr-space-md\">\n            <div class=\"align-center g-space-xs link\">\n              <ta-font-icon name=\"close-tool\" type=\"sm\"></ta-font-icon>\n              <ta-link class=\"c-pointer\" (action)=\"this.clear()\">\n                {{ \"core.filter.clear\" | translate }}\n              </ta-link>\n            </div>\n          </div>\n          <div>\n            @if (this.input.onlyTemplate !== true) {\n            <ta-button (action)=\"this.close()\">\n              <div class=\"align-center m-space-xs\">\n                <ta-font-icon name=\"check-line\"></ta-font-icon>\n                {{ \"form.validate\" | translate }}\n              </div>\n            </ta-button>\n            }\n          </div>\n        </div>\n      </ta-layout-side-cta>\n    </ta-layout-side>\n    } @else if (this.input.choiceTemplate && this.filteredOptions$) { @if\n    (this.input.withSearch) {\n    <ta-search-field\n      [isOpen]=\"true\"\n      [input]=\"this.inputSearch\"\n      [onFocus]=\"this.searchFocus\"\n      class=\"m-space-sm\"\n      [standalone]=\"true\"\n    ></ta-search-field>\n    }\n    <ta-layout-side\n      class=\"d-flex full-width\"\n      style=\"min-height: 300px; max-height: 400px\"\n    >\n      <ta-layout-side-content>\n        <ta-loader [isLoading]=\"this.requestState.isLoading()\">\n          @if (this.input.choiceTemplate.one) {\n          <ta-empty [isEmpty]=\"(this.filteredOptions$ | async)?.length === 0\">\n            @for (option of this.filteredOptions$ | async; track option) {\n            <div\n              class=\"flex-row pointer m-space-sm p-space-sm\"\n              [class.is-selected]=\"this.isSelected(option)\"\n              (click)=\"this.select(option)\"\n            >\n              <ng-template\n                [ngTemplateOutlet]=\"this.input.choiceTemplate.one\"\n                [ngTemplateOutletContext]=\"{ item: option.data }\"\n              ></ng-template>\n            </div>\n            }\n          </ta-empty>\n          } @else if (this.input.choiceTemplate.list) {\n          <ng-template\n            [ngTemplateOutlet]=\"this.input.choiceTemplate.list\"\n            [ngTemplateOutletContext]=\"{\n                  data: {\n                    items: this.filteredOptions$ | async,\n                    isselected: this.isSelected,\n                    select: this.select,\n                    search: this.inputSearch.value,\n                    refresh: this.refresh,\n                  },\n                }\"\n          ></ng-template>\n          }\n        </ta-loader>\n      </ta-layout-side-content>\n      <ta-layout-side-cta>\n        <div class=\"align-center space-between\">\n          <div class=\"pr-space-md\">\n            <div class=\"align-center g-space-xs link\">\n              <ta-font-icon name=\"close-tool\" type=\"sm\"></ta-font-icon>\n              <ta-link class=\"c-pointer\" (action)=\"this.clear()\">\n                {{ \"core.filter.clear\" | translate }}\n              </ta-link>\n            </div>\n          </div>\n          <div>\n            @if (this.input.onlyTemplate !== true) {\n            <ta-button (action)=\"this.close()\">\n              <div class=\"align-center m-space-xs\">\n                <ta-font-icon name=\"check-line\"></ta-font-icon>\n                {{ \"form.validate\" | translate }}\n              </div>\n            </ta-button>\n            }\n          </div>\n        </div>\n      </ta-layout-side-cta>\n    </ta-layout-side>\n    }\n  </div>\n</ng-template>\n", styles: [".textbox-container{width:100%}.input-group{position:relative}.input-group .action{position:absolute;right:8px;top:16px;bottom:0}.is-selected{border:1px solid var(--ta-border-secondary);border-radius:var(--ta-radius-full)}.menu-panel{background-color:var(--ta-neutral-white);border-radius:var(--ta-radius-rounded);border:1px solid;border-color:var(--ta-neutral-300);overflow:hidden}.choices-wrapper{overflow:visible;max-height:none}.only-template{background:var(--ta-neutral-white);border-radius:var(--ta-radius-rounded)}\n"] }]
        }], ctorParameters: () => [], propDecorators: { overlayPanelRef: [{
                type: ViewChild,
                args: [TaOverlayPanelComponent]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hvaWNlcy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvbGliL2NvbXBvbmVudHMvaW5wdXQvY2hvaWNlcy9jaG9pY2VzLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9pbnB1dC9jaG9pY2VzL2Nob2ljZXMuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzlELE9BQU8sRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3JELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRXJELE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN0RCxPQUFPLEVBQ0wsZUFBZSxFQUVmLGFBQWEsRUFDYixTQUFTLEVBQ1QsWUFBWSxFQUNaLE1BQU0sRUFDTixHQUFHLEVBQ0gsRUFBRSxFQUNGLFNBQVMsRUFDVCxJQUFJLEVBQ0osR0FBRyxHQUNKLE1BQU0sTUFBTSxDQUFDO0FBRWQsT0FBTyxFQUNMLGFBQWEsRUFHYixZQUFZLEdBQ2IsTUFBTSxnQkFBZ0IsQ0FBQztBQUN4QixPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDOUMsT0FBTyxFQUNMLGVBQWUsRUFDZixjQUFjLEVBQ2QsY0FBYyxFQUNkLG1CQUFtQixFQUNuQiwwQkFBMEIsRUFDMUIsc0JBQXNCLEVBQ3RCLGFBQWEsRUFDYixlQUFlLEVBQ2YsYUFBYSxHQUNkLE1BQU0sUUFBUSxDQUFDO0FBQ2hCLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLFFBQVEsQ0FBQztBQUNqRCxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsYUFBYSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ3BFLE9BQU8s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QUNmLGVBQWU7d0JBQ2YsYUFBYTt3QkFDYix1QkFBdUI7d0JBQ3ZCLGNBQWM7d0JBQ2QsZUFBZTt3QkFDZixzQkFBc0I7d0JBQ3RCLDBCQUEwQjt3QkFDMUIsbUJBQW1CO3dCQUNuQixvQkFBb0I7d0JBQ3BCLGNBQWM7d0JBQ2QsYUFBYTt3QkFDYixpQkFBaUI7d0JBQ2pCLG1CQUFtQjt3QkFDbkIsb0JBQW9CO3dCQUNwQixnQkFBZ0I7cUJBQ2pCO3dEQUdtQyxlQUFlO3NCQUFsRCxTQUFTO3VCQUFDLHVCQUF1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzeW5jUGlwZSwgTmdUZW1wbGF0ZU91dGxldCB9IGZyb20gXCJAYW5ndWxhci9jb21tb25cIjtcbmltcG9ydCB7IENvbXBvbmVudCwgVmlld0NoaWxkIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IFJlYWN0aXZlRm9ybXNNb2R1bGUgfSBmcm9tIFwiQGFuZ3VsYXIvZm9ybXNcIjtcblxuaW1wb3J0IHsgVHJhbnNsYXRlTW9kdWxlIH0gZnJvbSBcIkBuZ3gtdHJhbnNsYXRlL2NvcmVcIjtcbmltcG9ydCB7XG4gIEJlaGF2aW9yU3ViamVjdCxcbiAgT2JzZXJ2YWJsZSxcbiAgY29tYmluZUxhdGVzdCxcbiAgY29uY2F0TWFwLFxuICBkZWJvdW5jZVRpbWUsXG4gIGZpbHRlcixcbiAgbWFwLFxuICBvZixcbiAgc3RhcnRXaXRoLFxuICB0YWtlLFxuICB0YXAsXG59IGZyb20gXCJyeGpzXCI7XG5cbmltcG9ydCB7XG4gIElucHV0Q2hlY2tCb3gsXG4gIElucHV0Q2hvaWNlcyxcbiAgSW5wdXRDaG9pY2VzT3B0aW9uLFxuICBJbnB1dFRleHRCb3gsXG59IGZyb20gXCJAdGEvZm9ybS1tb2RlbFwiO1xuaW1wb3J0IHsgRm9udEljb25Db21wb25lbnQgfSBmcm9tIFwiQHRhL2ljb25zXCI7XG5pbXBvcnQge1xuICBCdXR0b25Db21wb25lbnQsXG4gIEVtcHR5Q29tcG9uZW50LFxuICBMYWJlbENvbXBvbmVudCxcbiAgTGF5b3V0U2lkZUNvbXBvbmVudCxcbiAgTGF5b3V0U2lkZUNvbnRlbnRDb21wb25lbnQsXG4gIExheW91dFNpZGVDdGFDb21wb25lbnQsXG4gIExpbmtDb21wb25lbnQsXG4gIExvYWRlckNvbXBvbmVudCxcbiAgVGV4dENvbXBvbmVudCxcbn0gZnJvbSBcIkB0YS91aVwiO1xuaW1wb3J0IHsgVGFPdmVybGF5UGFuZWxDb21wb25lbnQgfSBmcm9tIFwiQHRhL3VpXCI7XG5pbXBvcnQgeyBTdG9wUHJvcGFnYXRpb25EaXJlY3RpdmUsIGlzTm9uTnVsbGFibGUgfSBmcm9tIFwiQHRhL3V0aWxzXCI7XG5pbXBvcnQgeyBnZXRVbmlxdWVBcnJheSwgdG9BcnJheSB9IGZyb20gXCJAdGEvdXRpbHNcIjtcblxuaW1wb3J0IHsgVGFBYnN0cmFjdElucHV0Q29tcG9uZW50IH0gZnJvbSBcIi4uLy4uL2Fic3RyYWN0LmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgSW5wdXRMYXlvdXRDb21wb25lbnQgfSBmcm9tIFwiLi4vLi4vaW5wdXQtbGF5b3V0L2lucHV0LWxheW91dC5jb21wb25lbnRcIjtcbmltcG9ydCB7IENoZWNrYm94Q29tcG9uZW50IH0gZnJvbSBcIi4uL2NoZWNrYm94L2NoZWNrYm94LmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgU2VhcmNoRmllbGRDb21wb25lbnQgfSBmcm9tIFwiLi4vc2VhcmNoLWZpZWxkL3NlYXJjaC1maWVsZC5jb21wb25lbnRcIjtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiBcInRhLWlucHV0LWNob2ljZXNcIixcbiAgdGVtcGxhdGVVcmw6IFwiLi9jaG9pY2VzLmNvbXBvbmVudC5odG1sXCIsXG4gIHN0eWxlVXJsczogW1wiLi9jaG9pY2VzLmNvbXBvbmVudC5zY3NzXCJdLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgQXN5bmNQaXBlLFxuICAgIEZvbnRJY29uQ29tcG9uZW50LFxuICAgIFN0b3BQcm9wYWdhdGlvbkRpcmVjdGl2ZSxcbiAgICBUcmFuc2xhdGVNb2R1bGUsXG4gICAgQnV0dG9uQ29tcG9uZW50LFxuICAgIExpbmtDb21wb25lbnQsXG4gICAgVGFPdmVybGF5UGFuZWxDb21wb25lbnQsXG4gICAgRW1wdHlDb21wb25lbnQsXG4gICAgTG9hZGVyQ29tcG9uZW50LFxuICAgIExheW91dFNpZGVDdGFDb21wb25lbnQsXG4gICAgTGF5b3V0U2lkZUNvbnRlbnRDb21wb25lbnQsXG4gICAgTGF5b3V0U2lkZUNvbXBvbmVudCxcbiAgICBTZWFyY2hGaWVsZENvbXBvbmVudCxcbiAgICBMYWJlbENvbXBvbmVudCxcbiAgICBUZXh0Q29tcG9uZW50LFxuICAgIENoZWNrYm94Q29tcG9uZW50LFxuICAgIFJlYWN0aXZlRm9ybXNNb2R1bGUsXG4gICAgSW5wdXRMYXlvdXRDb21wb25lbnQsXG4gICAgTmdUZW1wbGF0ZU91dGxldCxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgSW5wdXRDaG9pY2VzQ29tcG9uZW50IGV4dGVuZHMgVGFBYnN0cmFjdElucHV0Q29tcG9uZW50PElucHV0Q2hvaWNlcz4ge1xuICBAVmlld0NoaWxkKFRhT3ZlcmxheVBhbmVsQ29tcG9uZW50KSBvdmVybGF5UGFuZWxSZWYhOiBUYU92ZXJsYXlQYW5lbENvbXBvbmVudDtcblxuICBwdWJsaWMgaW5wdXRTZWFyY2ggPSBuZXcgSW5wdXRUZXh0Qm94KCk7XG4gIHB1YmxpYyBpbnB1dE51bGxhYmxlID0gbmV3IElucHV0Q2hlY2tCb3goe1xuICAgIGxhYmVsOiBcImZvcm0uaW5wdXQuY2hvaWNlcy5udWxsYWJsZS5sYWJlbFwiLFxuICB9KTtcblxuICBwdWJsaWMgZmlsdGVyZWRPcHRpb25zJDogT2JzZXJ2YWJsZTxcbiAgICB7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgbmFtZTogc3RyaW5nO1xuICAgICAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICAgICAgZGF0YTogYW55O1xuICAgIH1bXVxuICA+IHwgbnVsbCA9IG51bGw7XG5cbiAgcHVibGljIGJPcHRpb25zJCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8SW5wdXRDaG9pY2VzT3B0aW9uW10+KFtdKTtcblxuICByZWFkb25seSBzZWFyY2hGb2N1cyA9IG5ldyBCZWhhdmlvclN1YmplY3Q8dm9pZD4odW5kZWZpbmVkKTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgb3ZlcnJpZGUgbmdPbkluaXQoKSB7XG4gICAgc3VwZXIubmdPbkluaXQoKTtcbiAgICBpZiAoIXRoaXMuaW5wdXQuYWR2YW5jZWRTZWFyY2gkKSB7XG4gICAgICB0aGlzLnJlcXVlc3RTdGF0ZS5hc2tlZCgpO1xuICAgICAgdGhpcy5fcmVnaXN0ZXJTdWJzY3JpcHRpb24oXG4gICAgICAgIHRoaXMuaW5wdXQub3B0aW9ucyQuc3Vic2NyaWJlKHtcbiAgICAgICAgICBuZXh0OiAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5iT3B0aW9ucyQubmV4dChkYXRhKTtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdFN0YXRlLmNvbXBsZXRlZCgpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgICB0aGlzLmZpbHRlcmVkT3B0aW9ucyQgPSBjb21iaW5lTGF0ZXN0KFtcbiAgICAgICAgdGhpcy5pbnB1dFNlYXJjaC5jaGFuZ2VWYWx1ZSQucGlwZShcbiAgICAgICAgICBzdGFydFdpdGgoXCJcIiksXG4gICAgICAgICAgZmlsdGVyKGlzTm9uTnVsbGFibGUpXG4gICAgICAgICksXG4gICAgICAgIHRoaXMuYk9wdGlvbnMkLFxuICAgICAgXSkucGlwZShcbiAgICAgICAgbWFwKChkYXRhKSA9PiAoe1xuICAgICAgICAgIHNlYXJjaDogZGF0YVswXSxcbiAgICAgICAgICBsaXN0OiBkYXRhWzFdLFxuICAgICAgICB9KSksXG4gICAgICAgIG1hcCgoeyBzZWFyY2gsIGxpc3QgfSkgPT5cbiAgICAgICAgICBsaXN0LmZpbHRlcigoaXRlbSkgPT5cbiAgICAgICAgICAgIGl0ZW0ubmFtZS50b0xvY2FsZUxvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaC50b0xvY2FsZUxvd2VyQ2FzZSgpKVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5maWx0ZXJlZE9wdGlvbnMkID0gdGhpcy5iT3B0aW9ucyQ7XG5cbiAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgdGhpcy5fcmVnaXN0ZXJTdWJzY3JpcHRpb24oXG4gICAgICAgIHRoaXMuaW5wdXRTZWFyY2guY2hhbmdlVmFsdWUkXG4gICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICBkZWJvdW5jZVRpbWUoNTAwKSxcbiAgICAgICAgICAgIGZpbHRlcihpc05vbk51bGxhYmxlKSxcbiAgICAgICAgICAgIHRhcCgoKSA9PiB0aGlzLnJlcXVlc3RTdGF0ZS5hc2tlZCgpKSxcbiAgICAgICAgICAgIGNvbmNhdE1hcCgoc2VhcmNoKSA9PlxuICAgICAgICAgICAgICB0aGlzLmlucHV0LmFkdmFuY2VkU2VhcmNoJFxuICAgICAgICAgICAgICAgID8gdGhpcy5pbnB1dC5hZHZhbmNlZFNlYXJjaCQoc2VhcmNoKVxuICAgICAgICAgICAgICAgIDogb2YoKVxuICAgICAgICAgICAgKVxuICAgICAgICAgIClcbiAgICAgICAgICAuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgIG5leHQ6IChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHByZXZEYXRhID0gdGhpcy5iT3B0aW9ucyQuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgdGhpcy5iT3B0aW9ucyQubmV4dChcbiAgICAgICAgICAgICAgICBnZXRVbmlxdWVBcnJheShbXG4gICAgICAgICAgICAgICAgICAuLi5wcmV2RGF0YS5maWx0ZXIoKGl0ZW0pID0+XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQudmFsdWU/LmluY2x1ZGVzKGl0ZW0uaWQpXG4gICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgICAgICAgICBdKVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RTdGF0ZS5jb21wbGV0ZWQoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgb3ZlcnJpZGUgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xuICAgIHN1cGVyLm5nQWZ0ZXJWaWV3SW5pdCgpO1xuXG4gICAgdGhpcy5zZWFyY2hGb2N1cy5uZXh0KCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0TmFtZSQoaWQ6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLmJPcHRpb25zJC5waXBlKFxuICAgICAgbWFwKCh2YWx1ZXMpID0+IHZhbHVlcy5maW5kKCh2YWx1ZSkgPT4gdmFsdWUuaWQgPT09IGlkKT8ubmFtZSA/PyBudWxsKSxcbiAgICAgIG1hcCgobmFtZSkgPT4gbmFtZSA/PyBpZClcbiAgICApO1xuICB9XG5cbiAgcHVibGljIHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgKHRoaXMuaW5wdXQuYWR2YW5jZWRTZWFyY2gkID8gdGhpcy5pbnB1dC5hZHZhbmNlZFNlYXJjaCQoKSA6IG9mKCkpXG4gICAgICAucGlwZSh0YWtlKDEpKVxuICAgICAgLnN1YnNjcmliZSh7XG4gICAgICAgIG5leHQ6IChkYXRhKSA9PiB7XG4gICAgICAgICAgdGhpcy5iT3B0aW9ucyQubmV4dChkYXRhKTtcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICB9O1xuXG4gIHB1YmxpYyBzZWxlY3ROdWxsYWJsZShzZWxlY3Q6IGJvb2xlYW4pIHtcbiAgICBpZiAoIXNlbGVjdCkge1xuICAgICAgdGhpcy5pbnB1dC52YWx1ZSA9IFtdO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmlucHV0LnZhbHVlID0gW1wiXCJdO1xuICB9XG4gIHB1YmxpYyBzZWxlY3QgPSAob3B0aW9uOiB7IGlkOiBzdHJpbmcgfSkgPT4ge1xuICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMuaW5wdXQudmFsdWUgPz8gW107XG5cbiAgICBpZiAodmFsdWVzLmluY2x1ZGVzKG9wdGlvbi5pZCkpIHtcbiAgICAgIHRoaXMuaW5wdXQudmFsdWUgPSB2YWx1ZXMuZmlsdGVyKCh2YWw6IHN0cmluZykgPT4gdmFsICE9PSBvcHRpb24uaWQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuaW5wdXQubXVsdGlwbGUpIHtcbiAgICAgIHRoaXMuaW5wdXQudmFsdWUgPSBbb3B0aW9uLmlkXTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pbnB1dC52YWx1ZSA9IFsuLi52YWx1ZXMsIG9wdGlvbi5pZF07XG4gIH07XG4gIHB1YmxpYyBpc1NlbGVjdGVkID0gKG9wdGlvbjogeyBpZDogc3RyaW5nIH0pID0+IHtcbiAgICBjb25zdCB2YWx1ZXMgPSB0b0FycmF5KHRoaXMuaW5wdXQudmFsdWUpO1xuXG4gICAgcmV0dXJuIHZhbHVlcy5pbmNsdWRlcyhvcHRpb24uaWQpO1xuICB9O1xuXG4gIHB1YmxpYyBjbGVhcigpIHtcbiAgICB0aGlzLmlucHV0LmZvcm1Db250cm9sPy5zZXRWYWx1ZShbXSk7XG4gICAgdGhpcy5jbG9zZSgpO1xuICB9XG4gIHB1YmxpYyBjbG9zZSgpIHtcbiAgICB0aGlzLmZvY3VzZWRFbGVtZW50Lm5hdGl2ZUVsZW1lbnQuY2xpY2soKTtcbiAgICB0aGlzLm92ZXJsYXlQYW5lbFJlZi5jbG9zZSgpO1xuICB9XG59XG4iLCJAaWYgKHRoaXMuaW5wdXQub25seVRlbXBsYXRlICE9PSB0cnVlKSB7XG48dGEtb3ZlcmxheS1wYW5lbCBbcGFuZWxDb25maWddPVwieyBtYXRjaFRyaWdnZXJXaWR0aDogZmFsc2UgfVwiPlxuICA8bmctdGVtcGxhdGUgI3BhbmVsVHJpZ2dlcj5cbiAgICA8dGEtaW5wdXQtbGF5b3V0IFtpbnB1dF09XCJ0aGlzLmlucHV0XCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1jb250cm9sXCIgI2ZvY3VzZWRFbGVtZW50PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXAgZC1mbGV4IGZ1bGwtd2lkdGhcIj5cbiAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgIHR5cGU9XCJoaWRkZW5cIlxuICAgICAgICAgICAgW2Zvcm1Db250cm9sXT1cIiRhbnkodGhpcy5pbnB1dC5mb3JtQ29udHJvbClcIlxuICAgICAgICAgICAgW3ZhbHVlXT1cInRoaXMuaW5wdXQudmFsdWVcIlxuICAgICAgICAgIC8+XG5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleC1zdGFydCBnLXNwYWNlLXhzXCI+XG4gICAgICAgICAgICBAZm9yICh2YWx1ZSBvZiB0aGlzLmlucHV0LnZhbHVlOyB0cmFjayB2YWx1ZSkge1xuICAgICAgICAgICAgPHRhLWxhYmVsIHNpemU9XCJzbVwiIGNsYXNzPVwiZC1mbGV4XCI+XG4gICAgICAgICAgICAgIHt7IChnZXROYW1lJCh2YWx1ZSkgfCBhc3luYykgPz8gXCJcIiB8IHRyYW5zbGF0ZSB9fVxuICAgICAgICAgICAgPC90YS1sYWJlbD5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICBAaWYgKHRoaXMuaW5wdXQubWVzc2FnZSkge1xuICAgICAgICAgIDxkaXYgY2xhc3M9XCJtZXNzYWdlXCI+XG4gICAgICAgICAgICA8c21hbGwgY2xhc3M9XCJmb3JtLXRleHQgdGV4dC1tdXRlZFwiPlxuICAgICAgICAgICAgICA8c3Bhbj57eyB0aGlzLmlucHV0Lm1lc3NhZ2UgfX08L3NwYW4+XG4gICAgICAgICAgICA8L3NtYWxsPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIH1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L3RhLWlucHV0LWxheW91dD5cbiAgPC9uZy10ZW1wbGF0ZT5cbiAgPG5nLXRlbXBsYXRlICNwYW5lbENvbnRlbnQ+XG4gICAgPG5nLXRlbXBsYXRlIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImNob2ljZXNUZW1wbGF0ZVwiPjwvbmctdGVtcGxhdGU+XG4gIDwvbmctdGVtcGxhdGU+XG48L3RhLW92ZXJsYXktcGFuZWw+XG59IEBlbHNlIHtcbjxkaXYgY2xhc3M9XCJvbmx5LXRlbXBsYXRlXCI+XG4gIDxuZy10ZW1wbGF0ZSBbbmdUZW1wbGF0ZU91dGxldF09XCJjaG9pY2VzVGVtcGxhdGVcIj48L25nLXRlbXBsYXRlPlxuPC9kaXY+XG59XG5cbjxuZy10ZW1wbGF0ZSAjY2hvaWNlc1RlbXBsYXRlPlxuICA8ZGl2IGFwcFN0b3BQcm9wYWdhdGlvbiBjbGFzcz1cImZsZXgtY29sdW1uIGctc3BhY2Utc21cIj5cbiAgICBAaWYgKCF0aGlzLmlucHV0LmNob2ljZVRlbXBsYXRlKSB7IEBpZiAodGhpcy5pbnB1dC53aXRoU2VhcmNoKSB7XG4gICAgPHRhLXNlYXJjaC1maWVsZFxuICAgICAgW2lzT3Blbl09XCJ0cnVlXCJcbiAgICAgIFtpbnB1dF09XCJ0aGlzLmlucHV0U2VhcmNoXCJcbiAgICAgIFtvbkZvY3VzXT1cInRoaXMuc2VhcmNoRm9jdXNcIlxuICAgICAgW3N0YW5kYWxvbmVdPVwidHJ1ZVwiXG4gICAgICBjbGFzcz1cIm0tc3BhY2Utc21cIlxuICAgID48L3RhLXNlYXJjaC1maWVsZD5cbiAgICB9XG5cbiAgICA8dGEtbGF5b3V0LXNpZGVcbiAgICAgIGNsYXNzPVwiZC1mbGV4IGZ1bGwtd2lkdGggY2hvaWNlcy13cmFwcGVyXCJcbiAgICAgIHN0eWxlPVwibWluLWhlaWdodDogMzAwcHg7IG1heC1oZWlnaHQ6IDQwMHB4XCJcbiAgICA+XG4gICAgICA8dGEtbGF5b3V0LXNpZGUtY29udGVudD5cbiAgICAgICAgPHRhLWxvYWRlciBbaXNMb2FkaW5nXT1cInRoaXMucmVxdWVzdFN0YXRlLmlzTG9hZGluZygpXCI+XG4gICAgICAgICAgPHRhLWVtcHR5IFtpc0VtcHR5XT1cIih0aGlzLmZpbHRlcmVkT3B0aW9ucyQgfCBhc3luYyk/Lmxlbmd0aCA9PT0gMFwiPlxuICAgICAgICAgICAgQGlmICh0aGlzLmlucHV0LnNob3dOdWxsYWJsZUZpZWxkcykge1xuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInAtc3BhY2Utc21cIj5cbiAgICAgICAgICAgICAgPHRhLWlucHV0LWNoZWNrYm94XG4gICAgICAgICAgICAgICAgW2lucHV0XT1cInRoaXMuaW5wdXROdWxsYWJsZVwiXG4gICAgICAgICAgICAgICAgW3N0YW5kYWxvbmVdPVwidHJ1ZVwiXG4gICAgICAgICAgICAgICAgKHZhbHVlQ2hhbmdlZCk9XCJ0aGlzLnNlbGVjdE51bGxhYmxlKCRldmVudClcIlxuICAgICAgICAgICAgICA+PC90YS1pbnB1dC1jaGVja2JveD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgfSBAZm9yIChvcHRpb24gb2YgdGhpcy5maWx0ZXJlZE9wdGlvbnMkIHwgYXN5bmM7IHRyYWNrIG9wdGlvbikge1xuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICBjbGFzcz1cImZsZXgtcm93IHBvaW50ZXIgbS1zcGFjZS1zbSBwLXNwYWNlLXNtXCJcbiAgICAgICAgICAgICAgW2NsYXNzLmlzLXNlbGVjdGVkXT1cInRoaXMuaXNTZWxlY3RlZChvcHRpb24pXCJcbiAgICAgICAgICAgICAgKGNsaWNrKT1cInRoaXMuc2VsZWN0KG9wdGlvbilcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8dGEtdGV4dD57eyBvcHRpb24ubmFtZSB9fTwvdGEtdGV4dD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgfVxuICAgICAgICAgIDwvdGEtZW1wdHk+XG4gICAgICAgIDwvdGEtbG9hZGVyPlxuICAgICAgPC90YS1sYXlvdXQtc2lkZS1jb250ZW50PlxuICAgICAgPHRhLWxheW91dC1zaWRlLWN0YT5cbiAgICAgICAgPGRpdiBjbGFzcz1cImFsaWduLWNlbnRlciBzcGFjZS1iZXR3ZWVuXCI+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cInByLXNwYWNlLW1kXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYWxpZ24tY2VudGVyIGctc3BhY2UteHMgbGlua1wiPlxuICAgICAgICAgICAgICA8dGEtZm9udC1pY29uIG5hbWU9XCJjbG9zZS10b29sXCIgdHlwZT1cInNtXCI+PC90YS1mb250LWljb24+XG4gICAgICAgICAgICAgIDx0YS1saW5rIGNsYXNzPVwiYy1wb2ludGVyXCIgKGFjdGlvbik9XCJ0aGlzLmNsZWFyKClcIj5cbiAgICAgICAgICAgICAgICB7eyBcImNvcmUuZmlsdGVyLmNsZWFyXCIgfCB0cmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgPC90YS1saW5rPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIEBpZiAodGhpcy5pbnB1dC5vbmx5VGVtcGxhdGUgIT09IHRydWUpIHtcbiAgICAgICAgICAgIDx0YS1idXR0b24gKGFjdGlvbik9XCJ0aGlzLmNsb3NlKClcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFsaWduLWNlbnRlciBtLXNwYWNlLXhzXCI+XG4gICAgICAgICAgICAgICAgPHRhLWZvbnQtaWNvbiBuYW1lPVwiY2hlY2stbGluZVwiPjwvdGEtZm9udC1pY29uPlxuICAgICAgICAgICAgICAgIHt7IFwiZm9ybS52YWxpZGF0ZVwiIHwgdHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC90YS1idXR0b24+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC90YS1sYXlvdXQtc2lkZS1jdGE+XG4gICAgPC90YS1sYXlvdXQtc2lkZT5cbiAgICB9IEBlbHNlIGlmICh0aGlzLmlucHV0LmNob2ljZVRlbXBsYXRlICYmIHRoaXMuZmlsdGVyZWRPcHRpb25zJCkgeyBAaWZcbiAgICAodGhpcy5pbnB1dC53aXRoU2VhcmNoKSB7XG4gICAgPHRhLXNlYXJjaC1maWVsZFxuICAgICAgW2lzT3Blbl09XCJ0cnVlXCJcbiAgICAgIFtpbnB1dF09XCJ0aGlzLmlucHV0U2VhcmNoXCJcbiAgICAgIFtvbkZvY3VzXT1cInRoaXMuc2VhcmNoRm9jdXNcIlxuICAgICAgY2xhc3M9XCJtLXNwYWNlLXNtXCJcbiAgICAgIFtzdGFuZGFsb25lXT1cInRydWVcIlxuICAgID48L3RhLXNlYXJjaC1maWVsZD5cbiAgICB9XG4gICAgPHRhLWxheW91dC1zaWRlXG4gICAgICBjbGFzcz1cImQtZmxleCBmdWxsLXdpZHRoXCJcbiAgICAgIHN0eWxlPVwibWluLWhlaWdodDogMzAwcHg7IG1heC1oZWlnaHQ6IDQwMHB4XCJcbiAgICA+XG4gICAgICA8dGEtbGF5b3V0LXNpZGUtY29udGVudD5cbiAgICAgICAgPHRhLWxvYWRlciBbaXNMb2FkaW5nXT1cInRoaXMucmVxdWVzdFN0YXRlLmlzTG9hZGluZygpXCI+XG4gICAgICAgICAgQGlmICh0aGlzLmlucHV0LmNob2ljZVRlbXBsYXRlLm9uZSkge1xuICAgICAgICAgIDx0YS1lbXB0eSBbaXNFbXB0eV09XCIodGhpcy5maWx0ZXJlZE9wdGlvbnMkIHwgYXN5bmMpPy5sZW5ndGggPT09IDBcIj5cbiAgICAgICAgICAgIEBmb3IgKG9wdGlvbiBvZiB0aGlzLmZpbHRlcmVkT3B0aW9ucyQgfCBhc3luYzsgdHJhY2sgb3B0aW9uKSB7XG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgIGNsYXNzPVwiZmxleC1yb3cgcG9pbnRlciBtLXNwYWNlLXNtIHAtc3BhY2Utc21cIlxuICAgICAgICAgICAgICBbY2xhc3MuaXMtc2VsZWN0ZWRdPVwidGhpcy5pc1NlbGVjdGVkKG9wdGlvbilcIlxuICAgICAgICAgICAgICAoY2xpY2spPVwidGhpcy5zZWxlY3Qob3B0aW9uKVwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cInRoaXMuaW5wdXQuY2hvaWNlVGVtcGxhdGUub25lXCJcbiAgICAgICAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyBpdGVtOiBvcHRpb24uZGF0YSB9XCJcbiAgICAgICAgICAgICAgPjwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICA8L3RhLWVtcHR5PlxuICAgICAgICAgIH0gQGVsc2UgaWYgKHRoaXMuaW5wdXQuY2hvaWNlVGVtcGxhdGUubGlzdCkge1xuICAgICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwidGhpcy5pbnB1dC5jaG9pY2VUZW1wbGF0ZS5saXN0XCJcbiAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zOiB0aGlzLmZpbHRlcmVkT3B0aW9ucyQgfCBhc3luYyxcbiAgICAgICAgICAgICAgICAgICAgaXNzZWxlY3RlZDogdGhpcy5pc1NlbGVjdGVkLFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3Q6IHRoaXMuc2VsZWN0LFxuICAgICAgICAgICAgICAgICAgICBzZWFyY2g6IHRoaXMuaW5wdXRTZWFyY2gudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2g6IHRoaXMucmVmcmVzaCxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfVwiXG4gICAgICAgICAgPjwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgfVxuICAgICAgICA8L3RhLWxvYWRlcj5cbiAgICAgIDwvdGEtbGF5b3V0LXNpZGUtY29udGVudD5cbiAgICAgIDx0YS1sYXlvdXQtc2lkZS1jdGE+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJhbGlnbi1jZW50ZXIgc3BhY2UtYmV0d2VlblwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJwci1zcGFjZS1tZFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFsaWduLWNlbnRlciBnLXNwYWNlLXhzIGxpbmtcIj5cbiAgICAgICAgICAgICAgPHRhLWZvbnQtaWNvbiBuYW1lPVwiY2xvc2UtdG9vbFwiIHR5cGU9XCJzbVwiPjwvdGEtZm9udC1pY29uPlxuICAgICAgICAgICAgICA8dGEtbGluayBjbGFzcz1cImMtcG9pbnRlclwiIChhY3Rpb24pPVwidGhpcy5jbGVhcigpXCI+XG4gICAgICAgICAgICAgICAge3sgXCJjb3JlLmZpbHRlci5jbGVhclwiIHwgdHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgIDwvdGEtbGluaz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICBAaWYgKHRoaXMuaW5wdXQub25seVRlbXBsYXRlICE9PSB0cnVlKSB7XG4gICAgICAgICAgICA8dGEtYnV0dG9uIChhY3Rpb24pPVwidGhpcy5jbG9zZSgpXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbGlnbi1jZW50ZXIgbS1zcGFjZS14c1wiPlxuICAgICAgICAgICAgICAgIDx0YS1mb250LWljb24gbmFtZT1cImNoZWNrLWxpbmVcIj48L3RhLWZvbnQtaWNvbj5cbiAgICAgICAgICAgICAgICB7eyBcImZvcm0udmFsaWRhdGVcIiB8IHRyYW5zbGF0ZSB9fVxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvdGEtYnV0dG9uPlxuICAgICAgICAgICAgfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvdGEtbGF5b3V0LXNpZGUtY3RhPlxuICAgIDwvdGEtbGF5b3V0LXNpZGU+XG4gICAgfVxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG4iXX0=