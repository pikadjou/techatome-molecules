import { AsyncPipe, NgFor, NgIf } from '@angular/common';
import { Component, ViewChild } from '@angular/core';
import { ReactiveFormsModule } from '@angular/forms';
import { TranslateModule } from '@ngx-translate/core';
import { BehaviorSubject, combineLatest, concatMap, debounceTime, map, of, startWith, take, tap, } from 'rxjs';
import { InputCheckBox, InputTextBox } from '@ta/form-model';
import { FontIconComponent } from '@ta/icons';
import { ButtonComponent, EmptyComponent, LabelComponent, LayoutSideComponent, LayoutSideContentComponent, LayoutSideCtaComponent, LinkComponent, LoaderComponent, TextComponent, } from '@ta/ui';
import { TaOverlayPanelComponent } from '@ta/ui';
import { StopPropagationDirective } from '@ta/utils';
import { getUniqueArray, toArray } from '@ta/utils';
import { TaAbstractInputComponent } from '../../abstract.component';
import { InputLayoutComponent } from '../../input-layout/input-layout.component';
import { CheckboxComponent } from '../checkbox/checkbox.component';
import { SearchFieldComponent } from '../search-field/search-field.component';
import * as i0 from "@angular/core";
import * as i1 from "@ngx-translate/core";
import * as i2 from "@angular/forms";
export class InputChoicesComponent extends TaAbstractInputComponent {
    constructor() {
        super();
        this.inputSearch = new InputTextBox();
        this.inputNullable = new InputCheckBox({
            label: 'input.choices.nullable.label',
        });
        this.filteredOptions$ = null;
        this.bOptions$ = new BehaviorSubject([]);
        this.searchFocus = new BehaviorSubject(undefined);
        this.refresh = () => {
            (this.input.advancedSearch$ ? this.input.advancedSearch$() : of()).pipe(take(1)).subscribe({
                next: data => {
                    this.bOptions$.next(data);
                },
            });
        };
        this.select = (option) => {
            const values = this.input.value ?? [];
            if (values.includes(option.id)) {
                this.input.value = values.filter((val) => val !== option.id);
                return;
            }
            if (!this.input.multiple) {
                this.input.value = [option.id];
                this.close();
                return;
            }
            this.input.value = [...values, option.id];
        };
        this.isSelected = (option) => {
            const values = toArray(this.input.value);
            return values.includes(option.id);
        };
    }
    ngOnInit() {
        super.ngOnInit();
        if (!this.input.advancedSearch$) {
            this.requestState.asked();
            this._registerSubscription(this.input.options$.subscribe({
                next: data => {
                    this.bOptions$.next(data);
                    this.requestState.completed();
                },
            }));
            this.filteredOptions$ = combineLatest([this.inputSearch.changeValue$.pipe(startWith('')), this.bOptions$]).pipe(map(data => ({
                search: data[0],
                list: data[1],
            })), map(({ search, list }) => list.filter(item => item.name.toLocaleLowerCase().includes(search.toLocaleLowerCase()))));
        }
        else {
            this.filteredOptions$ = this.bOptions$;
            this.refresh();
            this._registerSubscription(this.inputSearch.changeValue$
                .pipe(debounceTime(500), tap(() => this.requestState.asked()), concatMap(search => (this.input.advancedSearch$ ? this.input.advancedSearch$(search) : of())))
                .subscribe({
                next: data => {
                    const prevData = this.bOptions$.getValue();
                    this.bOptions$.next(getUniqueArray([...prevData.filter(item => this.input.value?.includes(item.id)), ...data]));
                    this.requestState.completed();
                },
            }));
        }
    }
    ngAfterViewInit() {
        super.ngAfterViewInit();
        this.searchFocus.next();
    }
    getName$(id) {
        return this.bOptions$.pipe(map(values => values.find(value => value.id === id)?.name ?? null), map(name => name ?? id));
    }
    selectNullable(select) {
        if (!select) {
            this.input.value = [];
            return;
        }
        this.input.value = [''];
    }
    clear() {
        this.input.formControl?.setValue([]);
        this.close();
    }
    close() {
        this.focusedElement.nativeElement.click();
        this.overlayPanelRef.close();
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: InputChoicesComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.13", type: InputChoicesComponent, isStandalone: true, selector: "ta-input-choices", viewQueries: [{ propertyName: "overlayPanelRef", first: true, predicate: TaOverlayPanelComponent, descendants: true }], usesInheritance: true, ngImport: i0, template: "@if (this.input.onlyTemplate !== true) {\n  <ta-overlay-panel [panelConfig]=\"{ matchTriggerWidth: false }\">\n    <ng-template #panelTrigger>\n      <ta-input-layout [input]=\"this.input\">\n        <div class=\"form-control\" #focusedElement>\n          <div class=\"input-group d-flex full-width\">\n            <input type=\"hidden\" [formControl]=\"$any(this.input.formControl)\" [value]=\"this.input.value\" />\n\n            <div class=\"flex-start g-space-xs\">\n              @for (value of this.input.value; track value) {\n                <ta-label size=\"sm\" class=\"d-flex\">\n                  {{ (getName$(value) | async) ?? '' | translate }}\n                </ta-label>\n              }\n            </div>\n            @if (this.input.message) {\n              <div class=\"message\">\n                <small class=\"form-text text-muted\">\n                  <span>{{ this.input.message }}</span>\n                </small>\n              </div>\n            }\n          </div>\n        </div>\n      </ta-input-layout>\n    </ng-template>\n    <ng-template #panelContent>\n      <ng-template [ngTemplateOutlet]=\"choicesTemplate\"></ng-template>\n    </ng-template>\n  </ta-overlay-panel>\n} @else {\n  <div class=\"only-template\">\n    <ng-template [ngTemplateOutlet]=\"choicesTemplate\"></ng-template>\n  </div>\n}\n\n<ng-template #choicesTemplate>\n  <div appStopPropagation class=\"flex-column g-space-sm\">\n    @if (!this.input.choiceTemplate) {\n      @if (this.input.withSearch) {\n        <ta-search-field\n          [isOpen]=\"true\"\n          [input]=\"this.inputSearch\"\n          [onFocus]=\"this.searchFocus\"\n          [standalone]=\"true\"\n          class=\"m-space-sm\"\n        ></ta-search-field>\n      }\n\n      <ta-layout-side class=\"d-flex full-width choices-wrapper\" style=\"min-height: 300px; max-height: 400px\">\n        <ta-layout-side-content>\n          <ta-loader [isLoading]=\"this.requestState.isLoading()\">\n            <ta-empty [isEmpty]=\"(this.filteredOptions$ | async)?.length === 0\">\n              @if (this.input.showNullableFields) {\n                <div class=\"p-space-sm\">\n                  <ta-input-checkbox\n                    [input]=\"this.inputNullable\"\n                    [standalone]=\"true\"\n                    (valueChanged)=\"this.selectNullable($event)\"\n                  ></ta-input-checkbox>\n                </div>\n              }\n              @for (option of this.filteredOptions$ | async; track option) {\n                <div\n                  class=\"flex-row pointer m-space-sm p-space-sm\"\n                  [class.is-selected]=\"this.isSelected(option)\"\n                  (click)=\"this.select(option)\"\n                >\n                  <ta-text>{{ option.name }}</ta-text>\n                </div>\n              }\n            </ta-empty>\n          </ta-loader>\n        </ta-layout-side-content>\n        <ta-layout-side-cta>\n          <div class=\"align-center space-between\">\n            <div class=\"pr-space-md\">\n              <div class=\"align-center g-space-xs link\">\n                <ta-font-icon name=\"close-tool\" type=\"sm\"></ta-font-icon>\n                <ta-link class=\"c-pointer\" (action)=\"this.clear()\">\n                  {{ 'core.filter.clear' | translate }}\n                </ta-link>\n              </div>\n            </div>\n            <div>\n              @if (this.input.onlyTemplate !== true) {\n                <ta-button (action)=\"this.close()\">\n                  <div class=\"align-center m-space-xs\">\n                    <ta-font-icon name=\"check-line\"></ta-font-icon>\n                    {{ 'form.validate' | translate }}\n                  </div>\n                </ta-button>\n              }\n            </div>\n          </div>\n        </ta-layout-side-cta>\n      </ta-layout-side>\n    } @else if (this.input.choiceTemplate && this.filteredOptions$) {\n      @if (this.input.withSearch) {\n        <ta-search-field\n          [isOpen]=\"true\"\n          [input]=\"this.inputSearch\"\n          [onFocus]=\"this.searchFocus\"\n          class=\"m-space-sm\"\n          [standalone]=\"true\"\n        ></ta-search-field>\n      }\n      <ta-layout-side class=\"d-flex full-width\" style=\"min-height: 300px; max-height: 400px\">\n        <ta-layout-side-content>\n          <ta-loader [isLoading]=\"this.requestState.isLoading()\">\n            @if (this.input.choiceTemplate.one) {\n              <ta-empty [isEmpty]=\"(this.filteredOptions$ | async)?.length === 0\">\n                @for (option of this.filteredOptions$ | async; track option) {\n                  <div\n                    class=\"flex-row pointer m-space-sm p-space-sm\"\n                    [class.is-selected]=\"this.isSelected(option)\"\n                    (click)=\"this.select(option)\"\n                  >\n                    <ng-template\n                      [ngTemplateOutlet]=\"this.input.choiceTemplate.one\"\n                      [ngTemplateOutletContext]=\"{ item: option.data }\"\n                    ></ng-template>\n                  </div>\n                }\n              </ta-empty>\n            } @else if (this.input.choiceTemplate.list) {\n              <ng-template\n                [ngTemplateOutlet]=\"this.input.choiceTemplate.list\"\n                [ngTemplateOutletContext]=\"{\n                  data: {\n                    items: this.filteredOptions$ | async,\n                    isselected: this.isSelected,\n                    select: this.select,\n                    search: this.inputSearch.value,\n                    refresh: this.refresh,\n                  },\n                }\"\n              ></ng-template>\n            }\n          </ta-loader>\n        </ta-layout-side-content>\n        <ta-layout-side-cta>\n          <div class=\"align-center space-between\">\n            <div class=\"pr-space-md\">\n              <div class=\"align-center g-space-xs link\">\n                <ta-font-icon name=\"close-tool\" type=\"sm\"></ta-font-icon>\n                <ta-link class=\"c-pointer\" (action)=\"this.clear()\">\n                  {{ 'core.filter.clear' | translate }}\n                </ta-link>\n              </div>\n            </div>\n            <div>\n              @if (this.input.onlyTemplate !== true) {\n                <ta-button (action)=\"this.close()\">\n                  <div class=\"align-center m-space-xs\">\n                    <ta-font-icon name=\"check-line\"></ta-font-icon>\n                    {{ 'form.validate' | translate }}\n                  </div>\n                </ta-button>\n              }\n            </div>\n          </div>\n        </ta-layout-side-cta>\n      </ta-layout-side>\n    }\n  </div>\n</ng-template>\n", styles: [".textbox-container{width:100%}.input-group{position:relative}.input-group .action{position:absolute;right:8px;top:16px;bottom:0}.is-selected{border:1px solid var(--ta-border-secondary);border-radius:var(--ta-radius-full)}.menu-panel{background-color:var(--ta-neutral-white);border-radius:var(--ta-radius-rounded);border:1px solid;border-color:var(--ta-neutral-300);overflow:hidden}.choices-wrapper{overflow:visible;max-height:none}.only-template{background:var(--ta-neutral-white);border-radius:var(--ta-radius-rounded)}\n"], dependencies: [{ kind: "pipe", type: AsyncPipe, name: "async" }, { kind: "component", type: FontIconComponent, selector: "ta-font-icon", inputs: ["name", "type"] }, { kind: "directive", type: StopPropagationDirective, selector: "[appStopPropagation]", inputs: ["stopPropagationActivation"] }, { kind: "ngmodule", type: TranslateModule }, { kind: "pipe", type: i1.TranslatePipe, name: "translate" }, { kind: "component", type: ButtonComponent, selector: "ta-button", inputs: ["state", "type", "size", "icon", "options", "stopPropagationActivation"], outputs: ["action"] }, { kind: "component", type: LinkComponent, selector: "ta-link", inputs: ["state", "underline", "bold", "size", "icon"], outputs: ["action"] }, { kind: "component", type: TaOverlayPanelComponent, selector: "ta-overlay-panel", inputs: ["panelConfig", "position"], outputs: ["closed"] }, { kind: "component", type: EmptyComponent, selector: "ta-empty", inputs: ["isEmpty", "isLight", "showMessage", "text", "type", "icon", "iconSize"] }, { kind: "component", type: LoaderComponent, selector: "ta-loader", inputs: ["isLoading", "skeleton", "size", "text"] }, { kind: "component", type: LayoutSideCtaComponent, selector: "ta-layout-side-cta", inputs: ["background"] }, { kind: "component", type: LayoutSideContentComponent, selector: "ta-layout-side-content" }, { kind: "component", type: LayoutSideComponent, selector: "ta-layout-side" }, { kind: "component", type: SearchFieldComponent, selector: "ta-search-field", inputs: ["isOpen", "placeholder", "space", "type"], outputs: ["valueCompleted"] }, { kind: "component", type: LabelComponent, selector: "ta-label", inputs: ["size", "type"] }, { kind: "component", type: TextComponent, selector: "ta-text", inputs: ["size", "isBold", "color"] }, { kind: "component", type: CheckboxComponent, selector: "ta-input-checkbox" }, { kind: "ngmodule", type: ReactiveFormsModule }, { kind: "directive", type: i2.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i2.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i2.FormControlDirective, selector: "[formControl]", inputs: ["formControl", "disabled", "ngModel"], outputs: ["ngModelChange"], exportAs: ["ngForm"] }, { kind: "component", type: InputLayoutComponent, selector: "ta-input-layout", inputs: ["input", "width", "height"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: InputChoicesComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ta-input-choices', standalone: true, imports: [
                        NgIf,
                        NgFor,
                        AsyncPipe,
                        FontIconComponent,
                        StopPropagationDirective,
                        TranslateModule,
                        ButtonComponent,
                        LinkComponent,
                        TaOverlayPanelComponent,
                        EmptyComponent,
                        LoaderComponent,
                        LayoutSideCtaComponent,
                        LayoutSideContentComponent,
                        LayoutSideComponent,
                        SearchFieldComponent,
                        LabelComponent,
                        TextComponent,
                        CheckboxComponent,
                        ReactiveFormsModule,
                        InputLayoutComponent,
                    ], template: "@if (this.input.onlyTemplate !== true) {\n  <ta-overlay-panel [panelConfig]=\"{ matchTriggerWidth: false }\">\n    <ng-template #panelTrigger>\n      <ta-input-layout [input]=\"this.input\">\n        <div class=\"form-control\" #focusedElement>\n          <div class=\"input-group d-flex full-width\">\n            <input type=\"hidden\" [formControl]=\"$any(this.input.formControl)\" [value]=\"this.input.value\" />\n\n            <div class=\"flex-start g-space-xs\">\n              @for (value of this.input.value; track value) {\n                <ta-label size=\"sm\" class=\"d-flex\">\n                  {{ (getName$(value) | async) ?? '' | translate }}\n                </ta-label>\n              }\n            </div>\n            @if (this.input.message) {\n              <div class=\"message\">\n                <small class=\"form-text text-muted\">\n                  <span>{{ this.input.message }}</span>\n                </small>\n              </div>\n            }\n          </div>\n        </div>\n      </ta-input-layout>\n    </ng-template>\n    <ng-template #panelContent>\n      <ng-template [ngTemplateOutlet]=\"choicesTemplate\"></ng-template>\n    </ng-template>\n  </ta-overlay-panel>\n} @else {\n  <div class=\"only-template\">\n    <ng-template [ngTemplateOutlet]=\"choicesTemplate\"></ng-template>\n  </div>\n}\n\n<ng-template #choicesTemplate>\n  <div appStopPropagation class=\"flex-column g-space-sm\">\n    @if (!this.input.choiceTemplate) {\n      @if (this.input.withSearch) {\n        <ta-search-field\n          [isOpen]=\"true\"\n          [input]=\"this.inputSearch\"\n          [onFocus]=\"this.searchFocus\"\n          [standalone]=\"true\"\n          class=\"m-space-sm\"\n        ></ta-search-field>\n      }\n\n      <ta-layout-side class=\"d-flex full-width choices-wrapper\" style=\"min-height: 300px; max-height: 400px\">\n        <ta-layout-side-content>\n          <ta-loader [isLoading]=\"this.requestState.isLoading()\">\n            <ta-empty [isEmpty]=\"(this.filteredOptions$ | async)?.length === 0\">\n              @if (this.input.showNullableFields) {\n                <div class=\"p-space-sm\">\n                  <ta-input-checkbox\n                    [input]=\"this.inputNullable\"\n                    [standalone]=\"true\"\n                    (valueChanged)=\"this.selectNullable($event)\"\n                  ></ta-input-checkbox>\n                </div>\n              }\n              @for (option of this.filteredOptions$ | async; track option) {\n                <div\n                  class=\"flex-row pointer m-space-sm p-space-sm\"\n                  [class.is-selected]=\"this.isSelected(option)\"\n                  (click)=\"this.select(option)\"\n                >\n                  <ta-text>{{ option.name }}</ta-text>\n                </div>\n              }\n            </ta-empty>\n          </ta-loader>\n        </ta-layout-side-content>\n        <ta-layout-side-cta>\n          <div class=\"align-center space-between\">\n            <div class=\"pr-space-md\">\n              <div class=\"align-center g-space-xs link\">\n                <ta-font-icon name=\"close-tool\" type=\"sm\"></ta-font-icon>\n                <ta-link class=\"c-pointer\" (action)=\"this.clear()\">\n                  {{ 'core.filter.clear' | translate }}\n                </ta-link>\n              </div>\n            </div>\n            <div>\n              @if (this.input.onlyTemplate !== true) {\n                <ta-button (action)=\"this.close()\">\n                  <div class=\"align-center m-space-xs\">\n                    <ta-font-icon name=\"check-line\"></ta-font-icon>\n                    {{ 'form.validate' | translate }}\n                  </div>\n                </ta-button>\n              }\n            </div>\n          </div>\n        </ta-layout-side-cta>\n      </ta-layout-side>\n    } @else if (this.input.choiceTemplate && this.filteredOptions$) {\n      @if (this.input.withSearch) {\n        <ta-search-field\n          [isOpen]=\"true\"\n          [input]=\"this.inputSearch\"\n          [onFocus]=\"this.searchFocus\"\n          class=\"m-space-sm\"\n          [standalone]=\"true\"\n        ></ta-search-field>\n      }\n      <ta-layout-side class=\"d-flex full-width\" style=\"min-height: 300px; max-height: 400px\">\n        <ta-layout-side-content>\n          <ta-loader [isLoading]=\"this.requestState.isLoading()\">\n            @if (this.input.choiceTemplate.one) {\n              <ta-empty [isEmpty]=\"(this.filteredOptions$ | async)?.length === 0\">\n                @for (option of this.filteredOptions$ | async; track option) {\n                  <div\n                    class=\"flex-row pointer m-space-sm p-space-sm\"\n                    [class.is-selected]=\"this.isSelected(option)\"\n                    (click)=\"this.select(option)\"\n                  >\n                    <ng-template\n                      [ngTemplateOutlet]=\"this.input.choiceTemplate.one\"\n                      [ngTemplateOutletContext]=\"{ item: option.data }\"\n                    ></ng-template>\n                  </div>\n                }\n              </ta-empty>\n            } @else if (this.input.choiceTemplate.list) {\n              <ng-template\n                [ngTemplateOutlet]=\"this.input.choiceTemplate.list\"\n                [ngTemplateOutletContext]=\"{\n                  data: {\n                    items: this.filteredOptions$ | async,\n                    isselected: this.isSelected,\n                    select: this.select,\n                    search: this.inputSearch.value,\n                    refresh: this.refresh,\n                  },\n                }\"\n              ></ng-template>\n            }\n          </ta-loader>\n        </ta-layout-side-content>\n        <ta-layout-side-cta>\n          <div class=\"align-center space-between\">\n            <div class=\"pr-space-md\">\n              <div class=\"align-center g-space-xs link\">\n                <ta-font-icon name=\"close-tool\" type=\"sm\"></ta-font-icon>\n                <ta-link class=\"c-pointer\" (action)=\"this.clear()\">\n                  {{ 'core.filter.clear' | translate }}\n                </ta-link>\n              </div>\n            </div>\n            <div>\n              @if (this.input.onlyTemplate !== true) {\n                <ta-button (action)=\"this.close()\">\n                  <div class=\"align-center m-space-xs\">\n                    <ta-font-icon name=\"check-line\"></ta-font-icon>\n                    {{ 'form.validate' | translate }}\n                  </div>\n                </ta-button>\n              }\n            </div>\n          </div>\n        </ta-layout-side-cta>\n      </ta-layout-side>\n    }\n  </div>\n</ng-template>\n", styles: [".textbox-container{width:100%}.input-group{position:relative}.input-group .action{position:absolute;right:8px;top:16px;bottom:0}.is-selected{border:1px solid var(--ta-border-secondary);border-radius:var(--ta-radius-full)}.menu-panel{background-color:var(--ta-neutral-white);border-radius:var(--ta-radius-rounded);border:1px solid;border-color:var(--ta-neutral-300);overflow:hidden}.choices-wrapper{overflow:visible;max-height:none}.only-template{background:var(--ta-neutral-white);border-radius:var(--ta-radius-rounded)}\n"] }]
        }], ctorParameters: () => [], propDecorators: { overlayPanelRef: [{
                type: ViewChild,
                args: [TaOverlayPanelComponent]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hvaWNlcy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvbGliL2NvbXBvbmVudHMvaW5wdXQvY2hvaWNlcy9jaG9pY2VzLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9pbnB1dC9jaG9pY2VzL2Nob2ljZXMuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekQsT0FBTyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDckQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFckQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sRUFDTCxlQUFlLEVBRWYsYUFBYSxFQUNiLFNBQVMsRUFDVCxZQUFZLEVBQ1osR0FBRyxFQUNILEVBQUUsRUFDRixTQUFTLEVBQ1QsSUFBSSxFQUNKLEdBQUcsR0FDSixNQUFNLE1BQU0sQ0FBQztBQUVkLE9BQU8sRUFBRSxhQUFhLEVBQW9DLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQy9GLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUM5QyxPQUFPLEVBQ0wsZUFBZSxFQUNmLGNBQWMsRUFDZCxjQUFjLEVBQ2QsbUJBQW1CLEVBQ25CLDBCQUEwQixFQUMxQixzQkFBc0IsRUFDdEIsYUFBYSxFQUNiLGVBQWUsRUFDZixhQUFhLEdBQ2QsTUFBTSxRQUFRLENBQUM7QUFDaEIsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sUUFBUSxDQUFDO0FBQ2pELE9BQU8sRUFBRSx3QkFBd0IsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUNyRCxPQUFPLEVBQUUsY0FBYyxF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Qjt3QkFDcEIsY0FBYzt3QkFDZCxhQUFhO3dCQUNiLGlCQUFpQjt3QkFDakIsbUJBQW1CO3dCQUNuQixvQkFBb0I7cUJBQ3JCO3dEQUdtQyxlQUFlO3NCQUFsRCxTQUFTO3VCQUFDLHVCQUF1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzeW5jUGlwZSwgTmdGb3IsIE5nSWYgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFJlYWN0aXZlRm9ybXNNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5cbmltcG9ydCB7IFRyYW5zbGF0ZU1vZHVsZSB9IGZyb20gJ0BuZ3gtdHJhbnNsYXRlL2NvcmUnO1xuaW1wb3J0IHtcbiAgQmVoYXZpb3JTdWJqZWN0LFxuICBPYnNlcnZhYmxlLFxuICBjb21iaW5lTGF0ZXN0LFxuICBjb25jYXRNYXAsXG4gIGRlYm91bmNlVGltZSxcbiAgbWFwLFxuICBvZixcbiAgc3RhcnRXaXRoLFxuICB0YWtlLFxuICB0YXAsXG59IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQgeyBJbnB1dENoZWNrQm94LCBJbnB1dENob2ljZXMsIElucHV0Q2hvaWNlc09wdGlvbiwgSW5wdXRUZXh0Qm94IH0gZnJvbSAnQHRhL2Zvcm0tbW9kZWwnO1xuaW1wb3J0IHsgRm9udEljb25Db21wb25lbnQgfSBmcm9tICdAdGEvaWNvbnMnO1xuaW1wb3J0IHtcbiAgQnV0dG9uQ29tcG9uZW50LFxuICBFbXB0eUNvbXBvbmVudCxcbiAgTGFiZWxDb21wb25lbnQsXG4gIExheW91dFNpZGVDb21wb25lbnQsXG4gIExheW91dFNpZGVDb250ZW50Q29tcG9uZW50LFxuICBMYXlvdXRTaWRlQ3RhQ29tcG9uZW50LFxuICBMaW5rQ29tcG9uZW50LFxuICBMb2FkZXJDb21wb25lbnQsXG4gIFRleHRDb21wb25lbnQsXG59IGZyb20gJ0B0YS91aSc7XG5pbXBvcnQgeyBUYU92ZXJsYXlQYW5lbENvbXBvbmVudCB9IGZyb20gJ0B0YS91aSc7XG5pbXBvcnQgeyBTdG9wUHJvcGFnYXRpb25EaXJlY3RpdmUgfSBmcm9tICdAdGEvdXRpbHMnO1xuaW1wb3J0IHsgZ2V0VW5pcXVlQXJyYXksIHRvQXJyYXkgfSBmcm9tICdAdGEvdXRpbHMnO1xuXG5pbXBvcnQgeyBUYUFic3RyYWN0SW5wdXRDb21wb25lbnQgfSBmcm9tICcuLi8uLi9hYnN0cmFjdC5jb21wb25lbnQnO1xuaW1wb3J0IHsgSW5wdXRMYXlvdXRDb21wb25lbnQgfSBmcm9tICcuLi8uLi9pbnB1dC1sYXlvdXQvaW5wdXQtbGF5b3V0LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBDaGVja2JveENvbXBvbmVudCB9IGZyb20gJy4uL2NoZWNrYm94L2NoZWNrYm94LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBTZWFyY2hGaWVsZENvbXBvbmVudCB9IGZyb20gJy4uL3NlYXJjaC1maWVsZC9zZWFyY2gtZmllbGQuY29tcG9uZW50JztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGEtaW5wdXQtY2hvaWNlcycsXG4gIHRlbXBsYXRlVXJsOiAnLi9jaG9pY2VzLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vY2hvaWNlcy5jb21wb25lbnQuc2NzcyddLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbXG4gICAgTmdJZixcbiAgICBOZ0ZvcixcbiAgICBBc3luY1BpcGUsXG4gICAgRm9udEljb25Db21wb25lbnQsXG4gICAgU3RvcFByb3BhZ2F0aW9uRGlyZWN0aXZlLFxuICAgIFRyYW5zbGF0ZU1vZHVsZSxcbiAgICBCdXR0b25Db21wb25lbnQsXG4gICAgTGlua0NvbXBvbmVudCxcbiAgICBUYU92ZXJsYXlQYW5lbENvbXBvbmVudCxcbiAgICBFbXB0eUNvbXBvbmVudCxcbiAgICBMb2FkZXJDb21wb25lbnQsXG4gICAgTGF5b3V0U2lkZUN0YUNvbXBvbmVudCxcbiAgICBMYXlvdXRTaWRlQ29udGVudENvbXBvbmVudCxcbiAgICBMYXlvdXRTaWRlQ29tcG9uZW50LFxuICAgIFNlYXJjaEZpZWxkQ29tcG9uZW50LFxuICAgIExhYmVsQ29tcG9uZW50LFxuICAgIFRleHRDb21wb25lbnQsXG4gICAgQ2hlY2tib3hDb21wb25lbnQsXG4gICAgUmVhY3RpdmVGb3Jtc01vZHVsZSxcbiAgICBJbnB1dExheW91dENvbXBvbmVudCxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgSW5wdXRDaG9pY2VzQ29tcG9uZW50IGV4dGVuZHMgVGFBYnN0cmFjdElucHV0Q29tcG9uZW50PElucHV0Q2hvaWNlcz4ge1xuICBAVmlld0NoaWxkKFRhT3ZlcmxheVBhbmVsQ29tcG9uZW50KSBvdmVybGF5UGFuZWxSZWYhOiBUYU92ZXJsYXlQYW5lbENvbXBvbmVudDtcblxuICBwdWJsaWMgaW5wdXRTZWFyY2ggPSBuZXcgSW5wdXRUZXh0Qm94KCk7XG4gIHB1YmxpYyBpbnB1dE51bGxhYmxlID0gbmV3IElucHV0Q2hlY2tCb3goe1xuICAgIGxhYmVsOiAnaW5wdXQuY2hvaWNlcy5udWxsYWJsZS5sYWJlbCcsXG4gIH0pO1xuXG4gIHB1YmxpYyBmaWx0ZXJlZE9wdGlvbnMkOiBPYnNlcnZhYmxlPFxuICAgIHtcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICBkaXNhYmxlZD86IGJvb2xlYW47XG4gICAgICBkYXRhOiBhbnk7XG4gICAgfVtdXG4gID4gfCBudWxsID0gbnVsbDtcblxuICBwdWJsaWMgYk9wdGlvbnMkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxJbnB1dENob2ljZXNPcHRpb25bXT4oW10pO1xuXG4gIHJlYWRvbmx5IHNlYXJjaEZvY3VzID0gbmV3IEJlaGF2aW9yU3ViamVjdDx2b2lkPih1bmRlZmluZWQpO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBvdmVycmlkZSBuZ09uSW5pdCgpIHtcbiAgICBzdXBlci5uZ09uSW5pdCgpO1xuICAgIGlmICghdGhpcy5pbnB1dC5hZHZhbmNlZFNlYXJjaCQpIHtcbiAgICAgIHRoaXMucmVxdWVzdFN0YXRlLmFza2VkKCk7XG4gICAgICB0aGlzLl9yZWdpc3RlclN1YnNjcmlwdGlvbihcbiAgICAgICAgdGhpcy5pbnB1dC5vcHRpb25zJC5zdWJzY3JpYmUoe1xuICAgICAgICAgIG5leHQ6IGRhdGEgPT4ge1xuICAgICAgICAgICAgdGhpcy5iT3B0aW9ucyQubmV4dChkYXRhKTtcbiAgICAgICAgICAgIHRoaXMucmVxdWVzdFN0YXRlLmNvbXBsZXRlZCgpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgICB0aGlzLmZpbHRlcmVkT3B0aW9ucyQgPSBjb21iaW5lTGF0ZXN0KFt0aGlzLmlucHV0U2VhcmNoLmNoYW5nZVZhbHVlJC5waXBlKHN0YXJ0V2l0aCgnJykpLCB0aGlzLmJPcHRpb25zJF0pLnBpcGUoXG4gICAgICAgIG1hcChkYXRhID0+ICh7XG4gICAgICAgICAgc2VhcmNoOiBkYXRhWzBdLFxuICAgICAgICAgIGxpc3Q6IGRhdGFbMV0sXG4gICAgICAgIH0pKSxcbiAgICAgICAgbWFwKCh7IHNlYXJjaCwgbGlzdCB9KSA9PlxuICAgICAgICAgIGxpc3QuZmlsdGVyKGl0ZW0gPT4gaXRlbS5uYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoLnRvTG9jYWxlTG93ZXJDYXNlKCkpKVxuICAgICAgICApXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmZpbHRlcmVkT3B0aW9ucyQgPSB0aGlzLmJPcHRpb25zJDtcblxuICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICB0aGlzLl9yZWdpc3RlclN1YnNjcmlwdGlvbihcbiAgICAgICAgdGhpcy5pbnB1dFNlYXJjaC5jaGFuZ2VWYWx1ZSRcbiAgICAgICAgICAucGlwZShcbiAgICAgICAgICAgIGRlYm91bmNlVGltZSg1MDApLFxuICAgICAgICAgICAgdGFwKCgpID0+IHRoaXMucmVxdWVzdFN0YXRlLmFza2VkKCkpLFxuICAgICAgICAgICAgY29uY2F0TWFwKHNlYXJjaCA9PiAodGhpcy5pbnB1dC5hZHZhbmNlZFNlYXJjaCQgPyB0aGlzLmlucHV0LmFkdmFuY2VkU2VhcmNoJChzZWFyY2gpIDogb2YoKSkpXG4gICAgICAgICAgKVxuICAgICAgICAgIC5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgbmV4dDogZGF0YSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHByZXZEYXRhID0gdGhpcy5iT3B0aW9ucyQuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgdGhpcy5iT3B0aW9ucyQubmV4dChcbiAgICAgICAgICAgICAgICBnZXRVbmlxdWVBcnJheShbLi4ucHJldkRhdGEuZmlsdGVyKGl0ZW0gPT4gdGhpcy5pbnB1dC52YWx1ZT8uaW5jbHVkZXMoaXRlbS5pZCkpLCAuLi5kYXRhXSlcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0U3RhdGUuY29tcGxldGVkKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIG92ZXJyaWRlIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICBzdXBlci5uZ0FmdGVyVmlld0luaXQoKTtcblxuICAgIHRoaXMuc2VhcmNoRm9jdXMubmV4dCgpO1xuICB9XG5cbiAgcHVibGljIGdldE5hbWUkKGlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gdGhpcy5iT3B0aW9ucyQucGlwZShcbiAgICAgIG1hcCh2YWx1ZXMgPT4gdmFsdWVzLmZpbmQodmFsdWUgPT4gdmFsdWUuaWQgPT09IGlkKT8ubmFtZSA/PyBudWxsKSxcbiAgICAgIG1hcChuYW1lID0+IG5hbWUgPz8gaWQpXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyByZWZyZXNoID0gKCkgPT4ge1xuICAgICh0aGlzLmlucHV0LmFkdmFuY2VkU2VhcmNoJCA/IHRoaXMuaW5wdXQuYWR2YW5jZWRTZWFyY2gkKCkgOiBvZigpKS5waXBlKHRha2UoMSkpLnN1YnNjcmliZSh7XG4gICAgICBuZXh0OiBkYXRhID0+IHtcbiAgICAgICAgdGhpcy5iT3B0aW9ucyQubmV4dChkYXRhKTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH07XG5cbiAgcHVibGljIHNlbGVjdE51bGxhYmxlKHNlbGVjdDogYm9vbGVhbikge1xuICAgIGlmICghc2VsZWN0KSB7XG4gICAgICB0aGlzLmlucHV0LnZhbHVlID0gW107XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaW5wdXQudmFsdWUgPSBbJyddO1xuICB9XG4gIHB1YmxpYyBzZWxlY3QgPSAob3B0aW9uOiB7IGlkOiBzdHJpbmcgfSkgPT4ge1xuICAgIGNvbnN0IHZhbHVlcyA9IHRoaXMuaW5wdXQudmFsdWUgPz8gW107XG5cbiAgICBpZiAodmFsdWVzLmluY2x1ZGVzKG9wdGlvbi5pZCkpIHtcbiAgICAgIHRoaXMuaW5wdXQudmFsdWUgPSB2YWx1ZXMuZmlsdGVyKCh2YWw6IHN0cmluZykgPT4gdmFsICE9PSBvcHRpb24uaWQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuaW5wdXQubXVsdGlwbGUpIHtcbiAgICAgIHRoaXMuaW5wdXQudmFsdWUgPSBbb3B0aW9uLmlkXTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pbnB1dC52YWx1ZSA9IFsuLi52YWx1ZXMsIG9wdGlvbi5pZF07XG4gIH07XG4gIHB1YmxpYyBpc1NlbGVjdGVkID0gKG9wdGlvbjogeyBpZDogc3RyaW5nIH0pID0+IHtcbiAgICBjb25zdCB2YWx1ZXMgPSB0b0FycmF5KHRoaXMuaW5wdXQudmFsdWUpO1xuXG4gICAgcmV0dXJuIHZhbHVlcy5pbmNsdWRlcyhvcHRpb24uaWQpO1xuICB9O1xuXG4gIHB1YmxpYyBjbGVhcigpIHtcbiAgICB0aGlzLmlucHV0LmZvcm1Db250cm9sPy5zZXRWYWx1ZShbXSk7XG4gICAgdGhpcy5jbG9zZSgpO1xuICB9XG4gIHB1YmxpYyBjbG9zZSgpIHtcbiAgICB0aGlzLmZvY3VzZWRFbGVtZW50Lm5hdGl2ZUVsZW1lbnQuY2xpY2soKTtcbiAgICB0aGlzLm92ZXJsYXlQYW5lbFJlZi5jbG9zZSgpO1xuICB9XG59XG4iLCJAaWYgKHRoaXMuaW5wdXQub25seVRlbXBsYXRlICE9PSB0cnVlKSB7XG4gIDx0YS1vdmVybGF5LXBhbmVsIFtwYW5lbENvbmZpZ109XCJ7IG1hdGNoVHJpZ2dlcldpZHRoOiBmYWxzZSB9XCI+XG4gICAgPG5nLXRlbXBsYXRlICNwYW5lbFRyaWdnZXI+XG4gICAgICA8dGEtaW5wdXQtbGF5b3V0IFtpbnB1dF09XCJ0aGlzLmlucHV0XCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIiAjZm9jdXNlZEVsZW1lbnQ+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwIGQtZmxleCBmdWxsLXdpZHRoXCI+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cImhpZGRlblwiIFtmb3JtQ29udHJvbF09XCIkYW55KHRoaXMuaW5wdXQuZm9ybUNvbnRyb2wpXCIgW3ZhbHVlXT1cInRoaXMuaW5wdXQudmFsdWVcIiAvPlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZmxleC1zdGFydCBnLXNwYWNlLXhzXCI+XG4gICAgICAgICAgICAgIEBmb3IgKHZhbHVlIG9mIHRoaXMuaW5wdXQudmFsdWU7IHRyYWNrIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgPHRhLWxhYmVsIHNpemU9XCJzbVwiIGNsYXNzPVwiZC1mbGV4XCI+XG4gICAgICAgICAgICAgICAgICB7eyAoZ2V0TmFtZSQodmFsdWUpIHwgYXN5bmMpID8/ICcnIHwgdHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgICAgPC90YS1sYWJlbD5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICBAaWYgKHRoaXMuaW5wdXQubWVzc2FnZSkge1xuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVzc2FnZVwiPlxuICAgICAgICAgICAgICAgIDxzbWFsbCBjbGFzcz1cImZvcm0tdGV4dCB0ZXh0LW11dGVkXCI+XG4gICAgICAgICAgICAgICAgICA8c3Bhbj57eyB0aGlzLmlucHV0Lm1lc3NhZ2UgfX08L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9zbWFsbD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC90YS1pbnB1dC1sYXlvdXQ+XG4gICAgPC9uZy10ZW1wbGF0ZT5cbiAgICA8bmctdGVtcGxhdGUgI3BhbmVsQ29udGVudD5cbiAgICAgIDxuZy10ZW1wbGF0ZSBbbmdUZW1wbGF0ZU91dGxldF09XCJjaG9pY2VzVGVtcGxhdGVcIj48L25nLXRlbXBsYXRlPlxuICAgIDwvbmctdGVtcGxhdGU+XG4gIDwvdGEtb3ZlcmxheS1wYW5lbD5cbn0gQGVsc2Uge1xuICA8ZGl2IGNsYXNzPVwib25seS10ZW1wbGF0ZVwiPlxuICAgIDxuZy10ZW1wbGF0ZSBbbmdUZW1wbGF0ZU91dGxldF09XCJjaG9pY2VzVGVtcGxhdGVcIj48L25nLXRlbXBsYXRlPlxuICA8L2Rpdj5cbn1cblxuPG5nLXRlbXBsYXRlICNjaG9pY2VzVGVtcGxhdGU+XG4gIDxkaXYgYXBwU3RvcFByb3BhZ2F0aW9uIGNsYXNzPVwiZmxleC1jb2x1bW4gZy1zcGFjZS1zbVwiPlxuICAgIEBpZiAoIXRoaXMuaW5wdXQuY2hvaWNlVGVtcGxhdGUpIHtcbiAgICAgIEBpZiAodGhpcy5pbnB1dC53aXRoU2VhcmNoKSB7XG4gICAgICAgIDx0YS1zZWFyY2gtZmllbGRcbiAgICAgICAgICBbaXNPcGVuXT1cInRydWVcIlxuICAgICAgICAgIFtpbnB1dF09XCJ0aGlzLmlucHV0U2VhcmNoXCJcbiAgICAgICAgICBbb25Gb2N1c109XCJ0aGlzLnNlYXJjaEZvY3VzXCJcbiAgICAgICAgICBbc3RhbmRhbG9uZV09XCJ0cnVlXCJcbiAgICAgICAgICBjbGFzcz1cIm0tc3BhY2Utc21cIlxuICAgICAgICA+PC90YS1zZWFyY2gtZmllbGQ+XG4gICAgICB9XG5cbiAgICAgIDx0YS1sYXlvdXQtc2lkZSBjbGFzcz1cImQtZmxleCBmdWxsLXdpZHRoIGNob2ljZXMtd3JhcHBlclwiIHN0eWxlPVwibWluLWhlaWdodDogMzAwcHg7IG1heC1oZWlnaHQ6IDQwMHB4XCI+XG4gICAgICAgIDx0YS1sYXlvdXQtc2lkZS1jb250ZW50PlxuICAgICAgICAgIDx0YS1sb2FkZXIgW2lzTG9hZGluZ109XCJ0aGlzLnJlcXVlc3RTdGF0ZS5pc0xvYWRpbmcoKVwiPlxuICAgICAgICAgICAgPHRhLWVtcHR5IFtpc0VtcHR5XT1cIih0aGlzLmZpbHRlcmVkT3B0aW9ucyQgfCBhc3luYyk/Lmxlbmd0aCA9PT0gMFwiPlxuICAgICAgICAgICAgICBAaWYgKHRoaXMuaW5wdXQuc2hvd051bGxhYmxlRmllbGRzKSB7XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInAtc3BhY2Utc21cIj5cbiAgICAgICAgICAgICAgICAgIDx0YS1pbnB1dC1jaGVja2JveFxuICAgICAgICAgICAgICAgICAgICBbaW5wdXRdPVwidGhpcy5pbnB1dE51bGxhYmxlXCJcbiAgICAgICAgICAgICAgICAgICAgW3N0YW5kYWxvbmVdPVwidHJ1ZVwiXG4gICAgICAgICAgICAgICAgICAgICh2YWx1ZUNoYW5nZWQpPVwidGhpcy5zZWxlY3ROdWxsYWJsZSgkZXZlbnQpXCJcbiAgICAgICAgICAgICAgICAgID48L3RhLWlucHV0LWNoZWNrYm94PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIEBmb3IgKG9wdGlvbiBvZiB0aGlzLmZpbHRlcmVkT3B0aW9ucyQgfCBhc3luYzsgdHJhY2sgb3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgY2xhc3M9XCJmbGV4LXJvdyBwb2ludGVyIG0tc3BhY2Utc20gcC1zcGFjZS1zbVwiXG4gICAgICAgICAgICAgICAgICBbY2xhc3MuaXMtc2VsZWN0ZWRdPVwidGhpcy5pc1NlbGVjdGVkKG9wdGlvbilcIlxuICAgICAgICAgICAgICAgICAgKGNsaWNrKT1cInRoaXMuc2VsZWN0KG9wdGlvbilcIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIDx0YS10ZXh0Pnt7IG9wdGlvbi5uYW1lIH19PC90YS10ZXh0PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8L3RhLWVtcHR5PlxuICAgICAgICAgIDwvdGEtbG9hZGVyPlxuICAgICAgICA8L3RhLWxheW91dC1zaWRlLWNvbnRlbnQ+XG4gICAgICAgIDx0YS1sYXlvdXQtc2lkZS1jdGE+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImFsaWduLWNlbnRlciBzcGFjZS1iZXR3ZWVuXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicHItc3BhY2UtbWRcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFsaWduLWNlbnRlciBnLXNwYWNlLXhzIGxpbmtcIj5cbiAgICAgICAgICAgICAgICA8dGEtZm9udC1pY29uIG5hbWU9XCJjbG9zZS10b29sXCIgdHlwZT1cInNtXCI+PC90YS1mb250LWljb24+XG4gICAgICAgICAgICAgICAgPHRhLWxpbmsgY2xhc3M9XCJjLXBvaW50ZXJcIiAoYWN0aW9uKT1cInRoaXMuY2xlYXIoKVwiPlxuICAgICAgICAgICAgICAgICAge3sgJ2NvcmUuZmlsdGVyLmNsZWFyJyB8IHRyYW5zbGF0ZSB9fVxuICAgICAgICAgICAgICAgIDwvdGEtbGluaz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIEBpZiAodGhpcy5pbnB1dC5vbmx5VGVtcGxhdGUgIT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICA8dGEtYnV0dG9uIChhY3Rpb24pPVwidGhpcy5jbG9zZSgpXCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiYWxpZ24tY2VudGVyIG0tc3BhY2UteHNcIj5cbiAgICAgICAgICAgICAgICAgICAgPHRhLWZvbnQtaWNvbiBuYW1lPVwiY2hlY2stbGluZVwiPjwvdGEtZm9udC1pY29uPlxuICAgICAgICAgICAgICAgICAgICB7eyAnZm9ybS52YWxpZGF0ZScgfCB0cmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvdGEtYnV0dG9uPlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC90YS1sYXlvdXQtc2lkZS1jdGE+XG4gICAgICA8L3RhLWxheW91dC1zaWRlPlxuICAgIH0gQGVsc2UgaWYgKHRoaXMuaW5wdXQuY2hvaWNlVGVtcGxhdGUgJiYgdGhpcy5maWx0ZXJlZE9wdGlvbnMkKSB7XG4gICAgICBAaWYgKHRoaXMuaW5wdXQud2l0aFNlYXJjaCkge1xuICAgICAgICA8dGEtc2VhcmNoLWZpZWxkXG4gICAgICAgICAgW2lzT3Blbl09XCJ0cnVlXCJcbiAgICAgICAgICBbaW5wdXRdPVwidGhpcy5pbnB1dFNlYXJjaFwiXG4gICAgICAgICAgW29uRm9jdXNdPVwidGhpcy5zZWFyY2hGb2N1c1wiXG4gICAgICAgICAgY2xhc3M9XCJtLXNwYWNlLXNtXCJcbiAgICAgICAgICBbc3RhbmRhbG9uZV09XCJ0cnVlXCJcbiAgICAgICAgPjwvdGEtc2VhcmNoLWZpZWxkPlxuICAgICAgfVxuICAgICAgPHRhLWxheW91dC1zaWRlIGNsYXNzPVwiZC1mbGV4IGZ1bGwtd2lkdGhcIiBzdHlsZT1cIm1pbi1oZWlnaHQ6IDMwMHB4OyBtYXgtaGVpZ2h0OiA0MDBweFwiPlxuICAgICAgICA8dGEtbGF5b3V0LXNpZGUtY29udGVudD5cbiAgICAgICAgICA8dGEtbG9hZGVyIFtpc0xvYWRpbmddPVwidGhpcy5yZXF1ZXN0U3RhdGUuaXNMb2FkaW5nKClcIj5cbiAgICAgICAgICAgIEBpZiAodGhpcy5pbnB1dC5jaG9pY2VUZW1wbGF0ZS5vbmUpIHtcbiAgICAgICAgICAgICAgPHRhLWVtcHR5IFtpc0VtcHR5XT1cIih0aGlzLmZpbHRlcmVkT3B0aW9ucyQgfCBhc3luYyk/Lmxlbmd0aCA9PT0gMFwiPlxuICAgICAgICAgICAgICAgIEBmb3IgKG9wdGlvbiBvZiB0aGlzLmZpbHRlcmVkT3B0aW9ucyQgfCBhc3luYzsgdHJhY2sgb3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiZmxleC1yb3cgcG9pbnRlciBtLXNwYWNlLXNtIHAtc3BhY2Utc21cIlxuICAgICAgICAgICAgICAgICAgICBbY2xhc3MuaXMtc2VsZWN0ZWRdPVwidGhpcy5pc1NlbGVjdGVkKG9wdGlvbilcIlxuICAgICAgICAgICAgICAgICAgICAoY2xpY2spPVwidGhpcy5zZWxlY3Qob3B0aW9uKVwiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0XT1cInRoaXMuaW5wdXQuY2hvaWNlVGVtcGxhdGUub25lXCJcbiAgICAgICAgICAgICAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyBpdGVtOiBvcHRpb24uZGF0YSB9XCJcbiAgICAgICAgICAgICAgICAgICAgPjwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDwvdGEtZW1wdHk+XG4gICAgICAgICAgICB9IEBlbHNlIGlmICh0aGlzLmlucHV0LmNob2ljZVRlbXBsYXRlLmxpc3QpIHtcbiAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlXG4gICAgICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwidGhpcy5pbnB1dC5jaG9pY2VUZW1wbGF0ZS5saXN0XCJcbiAgICAgICAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwie1xuICAgICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBpdGVtczogdGhpcy5maWx0ZXJlZE9wdGlvbnMkIHwgYXN5bmMsXG4gICAgICAgICAgICAgICAgICAgIGlzc2VsZWN0ZWQ6IHRoaXMuaXNTZWxlY3RlZCxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB0aGlzLnNlbGVjdCxcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoOiB0aGlzLmlucHV0U2VhcmNoLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICByZWZyZXNoOiB0aGlzLnJlZnJlc2gsXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH1cIlxuICAgICAgICAgICAgICA+PC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICA8L3RhLWxvYWRlcj5cbiAgICAgICAgPC90YS1sYXlvdXQtc2lkZS1jb250ZW50PlxuICAgICAgICA8dGEtbGF5b3V0LXNpZGUtY3RhPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbGlnbi1jZW50ZXIgc3BhY2UtYmV0d2VlblwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInByLXNwYWNlLW1kXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJhbGlnbi1jZW50ZXIgZy1zcGFjZS14cyBsaW5rXCI+XG4gICAgICAgICAgICAgICAgPHRhLWZvbnQtaWNvbiBuYW1lPVwiY2xvc2UtdG9vbFwiIHR5cGU9XCJzbVwiPjwvdGEtZm9udC1pY29uPlxuICAgICAgICAgICAgICAgIDx0YS1saW5rIGNsYXNzPVwiYy1wb2ludGVyXCIgKGFjdGlvbik9XCJ0aGlzLmNsZWFyKClcIj5cbiAgICAgICAgICAgICAgICAgIHt7ICdjb3JlLmZpbHRlci5jbGVhcicgfCB0cmFuc2xhdGUgfX1cbiAgICAgICAgICAgICAgICA8L3RhLWxpbms+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICBAaWYgKHRoaXMuaW5wdXQub25seVRlbXBsYXRlICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgPHRhLWJ1dHRvbiAoYWN0aW9uKT1cInRoaXMuY2xvc2UoKVwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImFsaWduLWNlbnRlciBtLXNwYWNlLXhzXCI+XG4gICAgICAgICAgICAgICAgICAgIDx0YS1mb250LWljb24gbmFtZT1cImNoZWNrLWxpbmVcIj48L3RhLWZvbnQtaWNvbj5cbiAgICAgICAgICAgICAgICAgICAge3sgJ2Zvcm0udmFsaWRhdGUnIHwgdHJhbnNsYXRlIH19XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L3RhLWJ1dHRvbj5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvdGEtbGF5b3V0LXNpZGUtY3RhPlxuICAgICAgPC90YS1sYXlvdXQtc2lkZT5cbiAgICB9XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cbiJdfQ==