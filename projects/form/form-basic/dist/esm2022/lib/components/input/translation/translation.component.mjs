import { NgIf, NgFor, NgClass, NgTemplateOutlet } from "@angular/common";
import { FontIconComponent } from "@ta/icons";
import { Component, input } from "@angular/core";
import { MatMenuModule } from "@angular/material/menu";
import { Menu, MenuBase, ToggleNavigationComponent } from "@ta/menu";
import { TranslatePipe } from "@ta/translation";
import { TitleComponent, LinkComponent, ButtonComponent } from "@ta/ui";
import { TaBaseComponent, Culture, extractEnum } from "@ta/utils";
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/menu";
export class InputTranslationComponent extends TaBaseComponent {
    // Getter for backward compatibility
    get input() {
        return this.inputModel();
    }
    constructor() {
        super();
        this.inputModel = input.required({ alias: 'input' });
        this.inputsTemplate = input.required();
        this.cultureList = extractEnum(Culture, true);
        this.cultureMenu = null;
        this.currentCulture = Culture[Culture.FR_BE];
    }
    ngOnInit() {
        this._registerSubscription(this.input.listChanged$.subscribe({
            next: () => this._renderMenu(),
        }));
        this._renderMenu();
    }
    changeSelection(culture) {
        this.currentCulture = culture;
    }
    add(culture) {
        this.input.add(culture);
        this.changeSelection(culture);
    }
    remove(culture) {
        this.input.remove(culture);
    }
    hasKey(culture) {
        return this.getKeys().includes(culture);
    }
    getKeys() {
        return Object.keys(this.input.inputsGroup);
    }
    getInputs(culture) {
        return this.input.inputsGroup[culture];
    }
    trackByFn(_, key) {
        return key;
    }
    trackInputByFn(_, input) {
        return input.key;
    }
    _renderMenu() {
        this.cultureMenu = new Menu({
            elements: this.getKeys().map((cul) => new MenuBase({
                key: cul,
                label: cul,
                order: 1,
                defaultOpen: this.currentCulture === cul,
                callback: () => this.changeSelection(cul),
            })),
            direction: "horizontal",
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: InputTranslationComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.14", type: InputTranslationComponent, isStandalone: true, selector: "ta-input-translation", inputs: { inputModel: { classPropertyName: "inputModel", publicName: "input", isSignal: true, isRequired: true, transformFunction: null }, inputsTemplate: { classPropertyName: "inputsTemplate", publicName: "inputsTemplate", isSignal: true, isRequired: true, transformFunction: null } }, usesInheritance: true, ngImport: i0, template: "<div class=\"translation-container\">\n  @if (this.input.label) {\n  <ta-title [level]=\"3\" [isBold]=\"true\">{{\n    this.input.label | translate\n  }}</ta-title>\n  }\n  <div class=\"flex-row align-center g-space-md\">\n    @if (this.cultureMenu) {\n    <ta-toggle-navigation\n      [menu]=\"this.cultureMenu\"\n      container=\"tab\"\n    ></ta-toggle-navigation>\n    }\n    <ta-button\n      size=\"small\"\n      [matMenuTriggerFor]=\"menu\"\n      [stopPropagationActivation]=\"false\"\n      >+</ta-button\n    >\n  </div>\n\n  <div class=\"pt-space-md\">\n    @for (input of this.getInputs(this.currentCulture); track input) { @if\n    (input) {\n    <div [ngClass]=\"input.class\">\n      <ng-container\n        [ngTemplateOutlet]=\"this.inputsTemplate()\"\n        [ngTemplateOutletContext]=\"{\n              input: input,\n            }\"\n      >\n      </ng-container>\n    </div>\n    } }\n  </div>\n</div>\n\n<mat-menu #menu=\"matMenu\">\n  @for (culture of this.cultureList; track culture) {\n  <div>\n    <div class=\"flex-row g-space-sm p-space-sm\">\n      @if (this.hasKey(culture.name)) {\n      <ta-font-icon name=\"check-line\" class=\"checked\"></ta-font-icon>\n      <ta-link (action)=\"this.remove(culture.name)\">{{ culture.name }}</ta-link>\n      } @else {\n      <ta-font-icon name=\"check-line\"> </ta-font-icon>\n      <ta-link (action)=\"this.add(culture.name)\">{{ culture.name }}</ta-link>\n      }\n    </div>\n  </div>\n  }\n</mat-menu>\n", styles: [".checked{color:var(--ta-semantic-token-success)}.translation-container{padding:var(--ta-space-md);border-radius:var(--ta-radius-rounded);border:1px solid var(--ta-border-secondary)}\n"], dependencies: [{ kind: "directive", type: NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: FontIconComponent, selector: "ta-font-icon", inputs: ["name", "type"] }, { kind: "ngmodule", type: MatMenuModule }, { kind: "component", type: i1.MatMenu, selector: "mat-menu", inputs: ["backdropClass", "aria-label", "aria-labelledby", "aria-describedby", "xPosition", "yPosition", "overlapTrigger", "hasBackdrop", "class", "classList"], outputs: ["closed", "close"], exportAs: ["matMenu"] }, { kind: "directive", type: i1.MatMenuTrigger, selector: "[mat-menu-trigger-for], [matMenuTriggerFor]", inputs: ["mat-menu-trigger-for", "matMenuTriggerFor", "matMenuTriggerData", "matMenuTriggerRestoreFocus"], outputs: ["menuOpened", "onMenuOpen", "menuClosed", "onMenuClose"], exportAs: ["matMenuTrigger"] }, { kind: "component", type: ToggleNavigationComponent, selector: "ta-toggle-navigation", inputs: ["menu", "container"] }, { kind: "component", type: TitleComponent, selector: "ta-title", inputs: ["level", "isTheme", "isBold", "icon"] }, { kind: "component", type: LinkComponent, selector: "ta-link", inputs: ["state", "underline", "bold", "size", "icon"], outputs: ["action"] }, { kind: "component", type: ButtonComponent, selector: "ta-button", inputs: ["state", "type", "size", "icon", "options", "stopPropagationActivation"], outputs: ["action"] }, { kind: "pipe", type: TranslatePipe, name: "translate" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: InputTranslationComponent, decorators: [{
            type: Component,
            args: [{ selector: "ta-input-translation", standalone: true, imports: [
                        NgIf,
                        NgFor,
                        NgClass,
                        NgTemplateOutlet,
                        FontIconComponent,
                        MatMenuModule,
                        ToggleNavigationComponent,
                        TitleComponent,
                        LinkComponent,
                        ButtonComponent,
                        TranslatePipe,
                    ], template: "<div class=\"translation-container\">\n  @if (this.input.label) {\n  <ta-title [level]=\"3\" [isBold]=\"true\">{{\n    this.input.label | translate\n  }}</ta-title>\n  }\n  <div class=\"flex-row align-center g-space-md\">\n    @if (this.cultureMenu) {\n    <ta-toggle-navigation\n      [menu]=\"this.cultureMenu\"\n      container=\"tab\"\n    ></ta-toggle-navigation>\n    }\n    <ta-button\n      size=\"small\"\n      [matMenuTriggerFor]=\"menu\"\n      [stopPropagationActivation]=\"false\"\n      >+</ta-button\n    >\n  </div>\n\n  <div class=\"pt-space-md\">\n    @for (input of this.getInputs(this.currentCulture); track input) { @if\n    (input) {\n    <div [ngClass]=\"input.class\">\n      <ng-container\n        [ngTemplateOutlet]=\"this.inputsTemplate()\"\n        [ngTemplateOutletContext]=\"{\n              input: input,\n            }\"\n      >\n      </ng-container>\n    </div>\n    } }\n  </div>\n</div>\n\n<mat-menu #menu=\"matMenu\">\n  @for (culture of this.cultureList; track culture) {\n  <div>\n    <div class=\"flex-row g-space-sm p-space-sm\">\n      @if (this.hasKey(culture.name)) {\n      <ta-font-icon name=\"check-line\" class=\"checked\"></ta-font-icon>\n      <ta-link (action)=\"this.remove(culture.name)\">{{ culture.name }}</ta-link>\n      } @else {\n      <ta-font-icon name=\"check-line\"> </ta-font-icon>\n      <ta-link (action)=\"this.add(culture.name)\">{{ culture.name }}</ta-link>\n      }\n    </div>\n  </div>\n  }\n</mat-menu>\n", styles: [".checked{color:var(--ta-semantic-token-success)}.translation-container{padding:var(--ta-space-md);border-radius:var(--ta-radius-rounded);border:1px solid var(--ta-border-secondary)}\n"] }]
        }], ctorParameters: () => [] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNsYXRpb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9jb21wb25lbnRzL2lucHV0L3RyYW5zbGF0aW9uL3RyYW5zbGF0aW9uLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9pbnB1dC90cmFuc2xhdGlvbi90cmFuc2xhdGlvbi5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUN6RSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDOUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQXVCLE1BQU0sZUFBZSxDQUFDO0FBQ3RFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUd2RCxPQUFPLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSx5QkFBeUIsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUNyRSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDaEQsT0FBTyxFQUFFLGNBQWMsRUFBRSxhQUFhLEVBQUUsZUFBZSxFQUFFLE1BQU0sUUFBUSxDQUFDO0FBQ3hFLE9BQU8sRUFBRSxlQUFlLEVBQUUsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLFdBQVcsQ0FBQzs7O0FBcUJsRSxNQUFNLE9BQU8seUJBQ1gsU0FBUSxlQUFlO0lBTXZCLG9DQUFvQztJQUNwQyxJQUFJLEtBQUs7UUFDUCxPQUFPLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztJQUMzQixDQUFDO0lBT0Q7UUFDRSxLQUFLLEVBQUUsQ0FBQztRQWRWLGVBQVUsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFtQixFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUs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dCB7IE5nSWYsIE5nRm9yLCBOZ0NsYXNzLCBOZ1RlbXBsYXRlT3V0bGV0IH0gZnJvbSBcIkBhbmd1bGFyL2NvbW1vblwiO1xuaW1wb3J0IHsgRm9udEljb25Db21wb25lbnQgfSBmcm9tIFwiQHRhL2ljb25zXCI7XG5pbXBvcnQgeyBDb21wb25lbnQsIGlucHV0LCBPbkluaXQsIFRlbXBsYXRlUmVmIH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbmltcG9ydCB7IE1hdE1lbnVNb2R1bGUgfSBmcm9tIFwiQGFuZ3VsYXIvbWF0ZXJpYWwvbWVudVwiO1xuXG5pbXBvcnQgeyBJbnB1dEJhc2UsIElucHV0VHJhbnNsYXRpb24gfSBmcm9tIFwiQHRhL2Zvcm0tbW9kZWxcIjtcbmltcG9ydCB7IE1lbnUsIE1lbnVCYXNlLCBUb2dnbGVOYXZpZ2F0aW9uQ29tcG9uZW50IH0gZnJvbSBcIkB0YS9tZW51XCI7XG5pbXBvcnQgeyBUcmFuc2xhdGVQaXBlIH0gZnJvbSBcIkB0YS90cmFuc2xhdGlvblwiO1xuaW1wb3J0IHsgVGl0bGVDb21wb25lbnQsIExpbmtDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJAdGEvdWlcIjtcbmltcG9ydCB7IFRhQmFzZUNvbXBvbmVudCwgQ3VsdHVyZSwgZXh0cmFjdEVudW0gfSBmcm9tIFwiQHRhL3V0aWxzXCI7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogXCJ0YS1pbnB1dC10cmFuc2xhdGlvblwiLFxuICB0ZW1wbGF0ZVVybDogXCIuL3RyYW5zbGF0aW9uLmNvbXBvbmVudC5odG1sXCIsXG4gIHN0eWxlVXJsczogW1wiLi90cmFuc2xhdGlvbi5jb21wb25lbnQuc2Nzc1wiXSxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW1xuICAgIE5nSWYsXG4gICAgTmdGb3IsXG4gICAgTmdDbGFzcyxcbiAgICBOZ1RlbXBsYXRlT3V0bGV0LFxuICAgIEZvbnRJY29uQ29tcG9uZW50LFxuICAgIE1hdE1lbnVNb2R1bGUsXG4gICAgVG9nZ2xlTmF2aWdhdGlvbkNvbXBvbmVudCxcbiAgICBUaXRsZUNvbXBvbmVudCxcbiAgICBMaW5rQ29tcG9uZW50LFxuICAgIEJ1dHRvbkNvbXBvbmVudCxcbiAgICBUcmFuc2xhdGVQaXBlLFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBJbnB1dFRyYW5zbGF0aW9uQ29tcG9uZW50XG4gIGV4dGVuZHMgVGFCYXNlQ29tcG9uZW50XG4gIGltcGxlbWVudHMgT25Jbml0XG57XG4gIGlucHV0TW9kZWwgPSBpbnB1dC5yZXF1aXJlZDxJbnB1dFRyYW5zbGF0aW9uPih7IGFsaWFzOiAnaW5wdXQnIH0pO1xuICBpbnB1dHNUZW1wbGF0ZSA9IGlucHV0LnJlcXVpcmVkPFRlbXBsYXRlUmVmPGFueT4+KCk7XG5cbiAgLy8gR2V0dGVyIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XG4gIGdldCBpbnB1dCgpOiBJbnB1dFRyYW5zbGF0aW9uIHtcbiAgICByZXR1cm4gdGhpcy5pbnB1dE1vZGVsKCk7XG4gIH1cblxuICBwdWJsaWMgY3VsdHVyZUxpc3QgPSBleHRyYWN0RW51bShDdWx0dXJlLCB0cnVlKTtcbiAgcHVibGljIGN1bHR1cmVNZW51OiBNZW51IHwgbnVsbCA9IG51bGw7XG5cbiAgcHVibGljIGN1cnJlbnRDdWx0dXJlOiBzdHJpbmcgPSBDdWx0dXJlW0N1bHR1cmUuRlJfQkVdO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLl9yZWdpc3RlclN1YnNjcmlwdGlvbihcbiAgICAgIHRoaXMuaW5wdXQubGlzdENoYW5nZWQkLnN1YnNjcmliZSh7XG4gICAgICAgIG5leHQ6ICgpID0+IHRoaXMuX3JlbmRlck1lbnUoKSxcbiAgICAgIH0pXG4gICAgKTtcbiAgICB0aGlzLl9yZW5kZXJNZW51KCk7XG4gIH1cblxuICBwdWJsaWMgY2hhbmdlU2VsZWN0aW9uKGN1bHR1cmU6IHN0cmluZykge1xuICAgIHRoaXMuY3VycmVudEN1bHR1cmUgPSBjdWx0dXJlO1xuICB9XG5cbiAgcHVibGljIGFkZChjdWx0dXJlOiBzdHJpbmcpIHtcbiAgICB0aGlzLmlucHV0LmFkZChjdWx0dXJlKTtcbiAgICB0aGlzLmNoYW5nZVNlbGVjdGlvbihjdWx0dXJlKTtcbiAgfVxuXG4gIHB1YmxpYyByZW1vdmUoY3VsdHVyZTogc3RyaW5nKSB7XG4gICAgdGhpcy5pbnB1dC5yZW1vdmUoY3VsdHVyZSk7XG4gIH1cblxuICBwdWJsaWMgaGFzS2V5KGN1bHR1cmU6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLmdldEtleXMoKS5pbmNsdWRlcyhjdWx0dXJlKTtcbiAgfVxuICBwdWJsaWMgZ2V0S2V5cygpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5pbnB1dC5pbnB1dHNHcm91cCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0SW5wdXRzKGN1bHR1cmU6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLmlucHV0LmlucHV0c0dyb3VwW2N1bHR1cmVdO1xuICB9XG5cbiAgcHVibGljIHRyYWNrQnlGbihfOiBudW1iZXIsIGtleTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGtleTtcbiAgfVxuXG4gIHB1YmxpYyB0cmFja0lucHV0QnlGbihfOiBudW1iZXIsIGlucHV0OiBJbnB1dEJhc2U8YW55Pikge1xuICAgIHJldHVybiBpbnB1dC5rZXk7XG4gIH1cblxuICBwcml2YXRlIF9yZW5kZXJNZW51KCkge1xuICAgIHRoaXMuY3VsdHVyZU1lbnUgPSBuZXcgTWVudSh7XG4gICAgICBlbGVtZW50czogdGhpcy5nZXRLZXlzKCkubWFwKFxuICAgICAgICAoY3VsKSA9PlxuICAgICAgICAgIG5ldyBNZW51QmFzZSh7XG4gICAgICAgICAgICBrZXk6IGN1bCxcbiAgICAgICAgICAgIGxhYmVsOiBjdWwsXG4gICAgICAgICAgICBvcmRlcjogMSxcbiAgICAgICAgICAgIGRlZmF1bHRPcGVuOiB0aGlzLmN1cnJlbnRDdWx0dXJlID09PSBjdWwsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5jaGFuZ2VTZWxlY3Rpb24oY3VsKSxcbiAgICAgICAgICB9KVxuICAgICAgKSxcbiAgICAgIGRpcmVjdGlvbjogXCJob3Jpem9udGFsXCIsXG4gICAgfSk7XG4gIH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJ0cmFuc2xhdGlvbi1jb250YWluZXJcIj5cbiAgQGlmICh0aGlzLmlucHV0LmxhYmVsKSB7XG4gIDx0YS10aXRsZSBbbGV2ZWxdPVwiM1wiIFtpc0JvbGRdPVwidHJ1ZVwiPnt7XG4gICAgdGhpcy5pbnB1dC5sYWJlbCB8IHRyYW5zbGF0ZVxuICB9fTwvdGEtdGl0bGU+XG4gIH1cbiAgPGRpdiBjbGFzcz1cImZsZXgtcm93IGFsaWduLWNlbnRlciBnLXNwYWNlLW1kXCI+XG4gICAgQGlmICh0aGlzLmN1bHR1cmVNZW51KSB7XG4gICAgPHRhLXRvZ2dsZS1uYXZpZ2F0aW9uXG4gICAgICBbbWVudV09XCJ0aGlzLmN1bHR1cmVNZW51XCJcbiAgICAgIGNvbnRhaW5lcj1cInRhYlwiXG4gICAgPjwvdGEtdG9nZ2xlLW5hdmlnYXRpb24+XG4gICAgfVxuICAgIDx0YS1idXR0b25cbiAgICAgIHNpemU9XCJzbWFsbFwiXG4gICAgICBbbWF0TWVudVRyaWdnZXJGb3JdPVwibWVudVwiXG4gICAgICBbc3RvcFByb3BhZ2F0aW9uQWN0aXZhdGlvbl09XCJmYWxzZVwiXG4gICAgICA+KzwvdGEtYnV0dG9uXG4gICAgPlxuICA8L2Rpdj5cblxuICA8ZGl2IGNsYXNzPVwicHQtc3BhY2UtbWRcIj5cbiAgICBAZm9yIChpbnB1dCBvZiB0aGlzLmdldElucHV0cyh0aGlzLmN1cnJlbnRDdWx0dXJlKTsgdHJhY2sgaW5wdXQpIHsgQGlmXG4gICAgKGlucHV0KSB7XG4gICAgPGRpdiBbbmdDbGFzc109XCJpbnB1dC5jbGFzc1wiPlxuICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICBbbmdUZW1wbGF0ZU91dGxldF09XCJ0aGlzLmlucHV0c1RlbXBsYXRlKClcIlxuICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwie1xuICAgICAgICAgICAgICBpbnB1dDogaW5wdXQsXG4gICAgICAgICAgICB9XCJcbiAgICAgID5cbiAgICAgIDwvbmctY29udGFpbmVyPlxuICAgIDwvZGl2PlxuICAgIH0gfVxuICA8L2Rpdj5cbjwvZGl2PlxuXG48bWF0LW1lbnUgI21lbnU9XCJtYXRNZW51XCI+XG4gIEBmb3IgKGN1bHR1cmUgb2YgdGhpcy5jdWx0dXJlTGlzdDsgdHJhY2sgY3VsdHVyZSkge1xuICA8ZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJmbGV4LXJvdyBnLXNwYWNlLXNtIHAtc3BhY2Utc21cIj5cbiAgICAgIEBpZiAodGhpcy5oYXNLZXkoY3VsdHVyZS5uYW1lKSkge1xuICAgICAgPHRhLWZvbnQtaWNvbiBuYW1lPVwiY2hlY2stbGluZVwiIGNsYXNzPVwiY2hlY2tlZFwiPjwvdGEtZm9udC1pY29uPlxuICAgICAgPHRhLWxpbmsgKGFjdGlvbik9XCJ0aGlzLnJlbW92ZShjdWx0dXJlLm5hbWUpXCI+e3sgY3VsdHVyZS5uYW1lIH19PC90YS1saW5rPlxuICAgICAgfSBAZWxzZSB7XG4gICAgICA8dGEtZm9udC1pY29uIG5hbWU9XCJjaGVjay1saW5lXCI+IDwvdGEtZm9udC1pY29uPlxuICAgICAgPHRhLWxpbmsgKGFjdGlvbik9XCJ0aGlzLmFkZChjdWx0dXJlLm5hbWUpXCI+e3sgY3VsdHVyZS5uYW1lIH19PC90YS1saW5rPlxuICAgICAgfVxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbiAgfVxuPC9tYXQtbWVudT5cbiJdfQ==