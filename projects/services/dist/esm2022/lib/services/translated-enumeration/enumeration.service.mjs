import { Injectable } from "@angular/core";
import { filter, map, tap } from "rxjs/operators";
import { BehaviorSubject } from "rxjs";
import { Request, TaBaseService } from "@ta/server";
import { sortByTranslatedValue } from "./translated-enumeration-helpers";
import * as i0 from "@angular/core";
const apiRoutes = {
    GetWontDoReasons: {
        type: "GET",
        url: "{ApiUrl}/wontdoreason",
    },
    GetWorkerJustifications: {
        type: "GET",
        url: "{ApiUrl}/workerjustifications",
    },
    GetIncidentTypes: {
        type: "GET",
        url: "{ApiUrl}/incidenttypes",
    },
    GetAbandonReasons: {
        type: "GET",
        url: "{ApiUrl}/abandonreasons",
    },
    GetFileTypes: {
        type: "GET",
        url: "{ApiUrl}/FileTypes",
    },
};
export class TaEnumerationService extends TaBaseService {
    constructor() {
        super(apiRoutes);
        this.getAbandonReasons$ = new BehaviorSubject([]);
        this.wontDoReasons$ = new BehaviorSubject([]);
        this.incidentTypes$ = new BehaviorSubject([]);
        this.workerJustifications$ = new BehaviorSubject([]);
        this._getFileTypes$ = new BehaviorSubject({});
        this.getFileTypes = (id) => (fileTypeId) => {
            return this._getFileTypes$
                .getValue()[id].find((document) => document.id === fileTypeId);
        };
        this.getFileTypes$ = (id) => this._getFileTypes$.pipe(map((data) => data[id]), filter((myData) => !!myData), map((fileTypes) => sortByTranslatedValue(fileTypes)));
    }
    fetchWontDoReasons$() {
        return this._serverService
            .request(new Request({ type: "GetWontDoReasons", content: {}, cacheTime: 60 }))
            .pipe(filter((data) => !!data), tap((data) => {
            this.wontDoReasons$.next(data);
        }));
    }
    fetchWorkerJustifications$() {
        return this._serverService
            .request(new Request({
            type: "GetWorkerJustifications",
            content: {},
            cacheTime: 60,
        }))
            .pipe(filter((data) => !!data), tap((data) => {
            this.workerJustifications$.next(data);
        }));
    }
    fetchIncidentTypes$() {
        return this._serverService
            .request(new Request({ type: "GetIncidentTypes", content: {}, cacheTime: 60 }))
            .pipe(filter((data) => !!data), tap((data) => {
            this.incidentTypes$.next(data);
        }));
    }
    fetchAbandonReasons() {
        return this._serverService
            .request(new Request({ type: "GetAbandonReasons", cacheTime: -1 }))
            .pipe(filter((myData) => !!myData), map((reasons) => sortByTranslatedValue(reasons)), tap((reasons) => this.getAbandonReasons$.next(reasons)));
    }
    fetchFileTypes() {
        return this._serverService
            .request(new Request({ type: "GetFileTypes", cacheTime: -1 }))
            .pipe(filter((myData) => !!myData), map((fileTypes) => sortByTranslatedValue(fileTypes)));
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: TaEnumerationService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: TaEnumerationService, providedIn: "root" }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.14", ngImport: i0, type: TaEnumerationService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: "root",
                }]
        }], ctorParameters: () => [] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW51bWVyYXRpb24uc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvc2VydmljZXMvdHJhbnNsYXRlZC1lbnVtZXJhdGlvbi9lbnVtZXJhdGlvbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFM0MsT0FBTyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFbEQsT0FBTyxFQUFFLGVBQWUsRUFBYyxNQUFNLE1BQU0sQ0FBQztBQUVuRCxPQUFPLEVBQWtCLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFHcEUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sa0NBQWtDLENBQUM7O0FBRXpFLE1BQU0sU0FBUyxHQUFtQjtJQUNoQyxnQkFBZ0IsRUFBRTtRQUNoQixJQUFJLEVBQUUsS0FBSztRQUNYLEdBQUcsRUFBRSx1QkFBdUI7S0FDN0I7SUFDRCx1QkFBdUIsRUFBRTtRQUN2QixJQUFJLEVBQUUsS0FBSztRQUNYLEdBQUcsRUFBRSwrQkFBK0I7S0FDckM7SUFDRCxnQkFBZ0IsRUFBRTtRQUNoQixJQUFJLEVBQUUsS0FBSztRQUNYLEdBQUcsRUFBRSx3QkFBd0I7S0FDOUI7SUFDRCxpQkFBaUIsRUFBRTtRQUNqQixJQUFJLEVBQUUsS0FBSztRQUNYLEdBQUcsRUFBRSx5QkFBeUI7S0FDL0I7SUFDRCxZQUFZLEVBQUU7UUFDWixJQUFJLEVBQUUsS0FBSztRQUNYLEdBQUcsRUFBRSxvQkFBb0I7S0FDMUI7Q0FDRixDQUFDO0FBS0YsTUFBTSxPQUFPLG9CQUFxQixTQUFRLGFBQWE7SUFZckQ7UUFDRSxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7UUFaWix1QkFBa0IsR0FBRyxJQUFJLGVBQWUsQ0FBMEIsRUFBRSxDQUFDLENBQUM7UUFDdEUs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QVMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQzFEO2FBQ0EsSUFBSSxDQUNILE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUM1QixHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLHFCQUFxQixDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQ2hELEdBQUcsQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUN4RCxDQUFDO0lBQ04sQ0FBQztJQWVNLGNBQWM7UUFDbkIsT0FBTyxJQUFJLENBQUMsY0FBYzthQUN2QixPQUFPLENBQ04sSUFBSSxPQUFPLENBQUMsRUFBRSxJQUFJLEVBQUUsY0FBYyxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQ3JEO2FBQ0EsSUFBSSxDQUNILE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUM1QixHQUFHLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLHFCQUFxQixDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQ3JELENBQUM7SUFDTixDQUFDOytHQTVGVSxvQkFBb0I7bUhBQXBCLG9CQUFvQixjQUZuQixNQUFNOzs0RkFFUCxvQkFBb0I7a0JBSGhDLFVBQVU7bUJBQUM7b0JBQ1YsVUFBVSxFQUFFLE1BQU07aUJBQ25CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5cbmltcG9ydCB7IGZpbHRlciwgbWFwLCB0YXAgfSBmcm9tIFwicnhqcy9vcGVyYXRvcnNcIjtcblxuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBPYnNlcnZhYmxlIH0gZnJvbSBcInJ4anNcIjtcblxuaW1wb3J0IHsgTWFwcGluZ0FwaVR5cGUsIFJlcXVlc3QsIFRhQmFzZVNlcnZpY2UgfSBmcm9tIFwiQHRhL3NlcnZlclwiO1xuXG5pbXBvcnQgeyBUcmFuc2xhdGVkRW51bWVyYXRpb24gfSBmcm9tIFwiLi4vY29tbW9uL2R0by90cmFuc2xhdGVkLWVudW1lcmF0aW9uXCI7XG5pbXBvcnQgeyBzb3J0QnlUcmFuc2xhdGVkVmFsdWUgfSBmcm9tIFwiLi90cmFuc2xhdGVkLWVudW1lcmF0aW9uLWhlbHBlcnNcIjtcblxuY29uc3QgYXBpUm91dGVzOiBNYXBwaW5nQXBpVHlwZSA9IHtcbiAgR2V0V29udERvUmVhc29uczoge1xuICAgIHR5cGU6IFwiR0VUXCIsXG4gICAgdXJsOiBcIntBcGlVcmx9L3dvbnRkb3JlYXNvblwiLFxuICB9LFxuICBHZXRXb3JrZXJKdXN0aWZpY2F0aW9uczoge1xuICAgIHR5cGU6IFwiR0VUXCIsXG4gICAgdXJsOiBcIntBcGlVcmx9L3dvcmtlcmp1c3RpZmljYXRpb25zXCIsXG4gIH0sXG4gIEdldEluY2lkZW50VHlwZXM6IHtcbiAgICB0eXBlOiBcIkdFVFwiLFxuICAgIHVybDogXCJ7QXBpVXJsfS9pbmNpZGVudHR5cGVzXCIsXG4gIH0sXG4gIEdldEFiYW5kb25SZWFzb25zOiB7XG4gICAgdHlwZTogXCJHRVRcIixcbiAgICB1cmw6IFwie0FwaVVybH0vYWJhbmRvbnJlYXNvbnNcIixcbiAgfSxcbiAgR2V0RmlsZVR5cGVzOiB7XG4gICAgdHlwZTogXCJHRVRcIixcbiAgICB1cmw6IFwie0FwaVVybH0vRmlsZVR5cGVzXCIsXG4gIH0sXG59O1xuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46IFwicm9vdFwiLFxufSlcbmV4cG9ydCBjbGFzcyBUYUVudW1lcmF0aW9uU2VydmljZSBleHRlbmRzIFRhQmFzZVNlcnZpY2Uge1xuICBwdWJsaWMgZ2V0QWJhbmRvblJlYXNvbnMkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxUcmFuc2xhdGVkRW51bWVyYXRpb25bXT4oW10pO1xuICBwdWJsaWMgd29udERvUmVhc29ucyQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PFRyYW5zbGF0ZWRFbnVtZXJhdGlvbltdPihbXSk7XG4gIHB1YmxpYyBpbmNpZGVudFR5cGVzJCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8VHJhbnNsYXRlZEVudW1lcmF0aW9uW10+KFtdKTtcbiAgcHVibGljIHdvcmtlckp1c3RpZmljYXRpb25zJCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8VHJhbnNsYXRlZEVudW1lcmF0aW9uW10+KFxuICAgIFtdXG4gICk7XG5cbiAgcHJpdmF0ZSBfZ2V0RmlsZVR5cGVzJCA9IG5ldyBCZWhhdmlvclN1YmplY3Q8e1xuICAgIFtpbmRleDogc3RyaW5nXTogVHJhbnNsYXRlZEVudW1lcmF0aW9uW107XG4gIH0+KHt9KTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihhcGlSb3V0ZXMpO1xuICB9XG5cbiAgcHVibGljIGZldGNoV29udERvUmVhc29ucyQoKTogT2JzZXJ2YWJsZTxUcmFuc2xhdGVkRW51bWVyYXRpb25bXT4ge1xuICAgIHJldHVybiB0aGlzLl9zZXJ2ZXJTZXJ2aWNlXG4gICAgICAucmVxdWVzdDxUcmFuc2xhdGVkRW51bWVyYXRpb25bXT4oXG4gICAgICAgIG5ldyBSZXF1ZXN0KHsgdHlwZTogXCJHZXRXb250RG9SZWFzb25zXCIsIGNvbnRlbnQ6IHt9LCBjYWNoZVRpbWU6IDYwIH0pXG4gICAgICApXG4gICAgICAucGlwZShcbiAgICAgICAgZmlsdGVyKChkYXRhKSA9PiAhIWRhdGEpLFxuICAgICAgICB0YXAoKGRhdGEpID0+IHtcbiAgICAgICAgICB0aGlzLndvbnREb1JlYXNvbnMkLm5leHQoZGF0YSk7XG4gICAgICAgIH0pXG4gICAgICApO1xuICB9XG5cbiAgcHVibGljIGZldGNoV29ya2VySnVzdGlmaWNhdGlvbnMkKCk6IE9ic2VydmFibGU8VHJhbnNsYXRlZEVudW1lcmF0aW9uW10+IHtcbiAgICByZXR1cm4gdGhpcy5fc2VydmVyU2VydmljZVxuICAgICAgLnJlcXVlc3Q8VHJhbnNsYXRlZEVudW1lcmF0aW9uW10+KFxuICAgICAgICBuZXcgUmVxdWVzdCh7XG4gICAgICAgICAgdHlwZTogXCJHZXRXb3JrZXJKdXN0aWZpY2F0aW9uc1wiLFxuICAgICAgICAgIGNvbnRlbnQ6IHt9LFxuICAgICAgICAgIGNhY2hlVGltZTogNjAsXG4gICAgICAgIH0pXG4gICAgICApXG4gICAgICAucGlwZShcbiAgICAgICAgZmlsdGVyKChkYXRhKSA9PiAhIWRhdGEpLFxuICAgICAgICB0YXAoKGRhdGEpID0+IHtcbiAgICAgICAgICB0aGlzLndvcmtlckp1c3RpZmljYXRpb25zJC5uZXh0KGRhdGEpO1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBmZXRjaEluY2lkZW50VHlwZXMkKCk6IE9ic2VydmFibGU8VHJhbnNsYXRlZEVudW1lcmF0aW9uW10+IHtcbiAgICByZXR1cm4gdGhpcy5fc2VydmVyU2VydmljZVxuICAgICAgLnJlcXVlc3Q8VHJhbnNsYXRlZEVudW1lcmF0aW9uW10+KFxuICAgICAgICBuZXcgUmVxdWVzdCh7IHR5cGU6IFwiR2V0SW5jaWRlbnRUeXBlc1wiLCBjb250ZW50OiB7fSwgY2FjaGVUaW1lOiA2MCB9KVxuICAgICAgKVxuICAgICAgLnBpcGUoXG4gICAgICAgIGZpbHRlcigoZGF0YSkgPT4gISFkYXRhKSxcbiAgICAgICAgdGFwKChkYXRhKSA9PiB7XG4gICAgICAgICAgdGhpcy5pbmNpZGVudFR5cGVzJC5uZXh0KGRhdGEpO1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgfVxuICBwdWJsaWMgZmV0Y2hBYmFuZG9uUmVhc29ucygpOiBPYnNlcnZhYmxlPFRyYW5zbGF0ZWRFbnVtZXJhdGlvbltdPiB7XG4gICAgcmV0dXJuIHRoaXMuX3NlcnZlclNlcnZpY2VcbiAgICAgIC5yZXF1ZXN0PFRyYW5zbGF0ZWRFbnVtZXJhdGlvbltdPihcbiAgICAgICAgbmV3IFJlcXVlc3QoeyB0eXBlOiBcIkdldEFiYW5kb25SZWFzb25zXCIsIGNhY2hlVGltZTogLTEgfSlcbiAgICAgIClcbiAgICAgIC5waXBlKFxuICAgICAgICBmaWx0ZXIoKG15RGF0YSkgPT4gISFteURhdGEpLFxuICAgICAgICBtYXAoKHJlYXNvbnMpID0+IHNvcnRCeVRyYW5zbGF0ZWRWYWx1ZShyZWFzb25zKSksXG4gICAgICAgIHRhcCgocmVhc29ucykgPT4gdGhpcy5nZXRBYmFuZG9uUmVhc29ucyQubmV4dChyZWFzb25zKSlcbiAgICAgICk7XG4gIH1cblxuICBwdWJsaWMgZ2V0RmlsZVR5cGVzID0gKGlkOiBudW1iZXIpID0+IChmaWxlVHlwZUlkOiBudW1iZXIpID0+IHtcbiAgICByZXR1cm4gdGhpcy5fZ2V0RmlsZVR5cGVzJFxuICAgICAgLmdldFZhbHVlKClcbiAgICAgIFtpZF0uZmluZCgoZG9jdW1lbnQpID0+IGRvY3VtZW50LmlkID09PSBmaWxlVHlwZUlkKTtcbiAgfTtcblxuICBwdWJsaWMgZ2V0RmlsZVR5cGVzJCA9IChpZDogbnVtYmVyKTogT2JzZXJ2YWJsZTxUcmFuc2xhdGVkRW51bWVyYXRpb25bXT4gPT5cbiAgICB0aGlzLl9nZXRGaWxlVHlwZXMkLnBpcGUoXG4gICAgICBtYXAoKGRhdGEpID0+IGRhdGFbaWRdKSxcbiAgICAgIGZpbHRlcigobXlEYXRhKSA9PiAhIW15RGF0YSksXG4gICAgICBtYXAoKGZpbGVUeXBlcykgPT4gc29ydEJ5VHJhbnNsYXRlZFZhbHVlKGZpbGVUeXBlcykpXG4gICAgKTtcblxuICBwdWJsaWMgZmV0Y2hGaWxlVHlwZXMoKTogT2JzZXJ2YWJsZTxUcmFuc2xhdGVkRW51bWVyYXRpb25bXT4ge1xuICAgIHJldHVybiB0aGlzLl9zZXJ2ZXJTZXJ2aWNlXG4gICAgICAucmVxdWVzdDxUcmFuc2xhdGVkRW51bWVyYXRpb25bXT4oXG4gICAgICAgIG5ldyBSZXF1ZXN0KHsgdHlwZTogXCJHZXRGaWxlVHlwZXNcIiwgY2FjaGVUaW1lOiAtMSB9KVxuICAgICAgKVxuICAgICAgLnBpcGUoXG4gICAgICAgIGZpbHRlcigobXlEYXRhKSA9PiAhIW15RGF0YSksXG4gICAgICAgIG1hcCgoZmlsZVR5cGVzKSA9PiBzb3J0QnlUcmFuc2xhdGVkVmFsdWUoZmlsZVR5cGVzKSlcbiAgICAgICk7XG4gIH1cbn1cbiJdfQ==