<div
  class="message-container"
  [class.box]="this.communication.type !== this.CommunicationType.System"
  [class.is-mine]="this.communication.isMine"
  [class.intern]="this.communication.type === this.CommunicationType.Intern"
  [class.system]="this.communication.type === this.CommunicationType.System"
  [class.error]="this.communication.status === CommunicationStatus.Failed"
>
  <div class="participant-container space-between" *ngIf="this.communication.type !== this.CommunicationType.System">
    <ta-communication-participant
      [participant]="this.communication.from"
      [conversationParticipants]="this.conversationParticipants"
    ></ta-communication-participant>
    <div class="flex-start g-space-sm">
      <div *ngIf="this.communication.type === this.CommunicationType.Mail">
        <ta-font-icon
          type="sm"
          name="arrow-go-back-line"
          (click)="this.askReply.emit({ communication: this.communication, isForward: false })"
        ></ta-font-icon>
      </div>
      <div *ngIf="this.communication.type === this.CommunicationType.Mail">
        <ta-font-icon
          type="sm"
          name="arrow-go-forward-line"
          (click)="this.askReply.emit({ communication: this.communication, isForward: true })"
        ></ta-font-icon>
      </div>
    </div>
  </div>
  <div class="message-wrapper mb-space-xs">
    @switch (this.communication.type) {
      @case (this.CommunicationType.Mail) {
        <ta-communication-message-mail
          [communication]="this.communication"
          [conversationParticipants]="this.conversationParticipants"
          [taskId]="this.taskId"
        ></ta-communication-message-mail>
      }
      @case (this.CommunicationType.Chat) {
        <ta-communication-message-chat
          [communication]="this.communication"
          [conversationParticipants]="this.conversationParticipants"
        ></ta-communication-message-chat>
      }
      @case (this.CommunicationType.Intern) {
        <ta-communication-message-chat
          [communication]="this.communication"
          [conversationParticipants]="this.conversationParticipants"
        ></ta-communication-message-chat>
      }
      @case (this.CommunicationType.System) {
        <ta-communication-message-system
          [communication]="this.communication"
          [conversationParticipants]="this.conversationParticipants"
        ></ta-communication-message-system>
      }
    }
    <div
      class="documents-container pt-space-md"
      *ngIf="this.communication.documentsIds && this.communication.documentsIds.length > 0"
    >
      <ta-documents-list [documentsIds]="this.communication.documentsIds"></ta-documents-list>
    </div>
  </div>
  <div class="time">
    <ta-text size="sm" color="secondary">
      <div class="align-center">
        <ta-communication-status
          *ngIf="this.communication.status !== CommunicationStatus.Sent"
          [value]="this.communication.status"
          (click)="this.open()"
        ></ta-communication-status>
        <ta-time-ago
          *ngIf="this.communication.status === CommunicationStatus.Sent"
          [date]="this.communication.createdTime"
          [withHours]="true"
        ></ta-time-ago>
        @if (
          this.communication.createdByFullName &&
          (this.communication.type === this.CommunicationType.Intern ||
            this.communication.type === this.CommunicationType.System)
        ) {
          <div class="ml-space-xs">
            {{ 'communication.message.from' | translate }} {{ this.communication.createdByFullName }}
          </div>
        }
      </div>
    </ta-text>
  </div>
</div>
