@use 'ta/utils/mixins/common';
@use 'ta/utils/mixins/flex';

:host {
  display: block;
  width: 100%;
}
.loader {
  @include flex.flex-column();
  @include flex.align-center();
  gap: common.get-var(space, sm);

  .content {
    @include flex.flex-column();
    @include flex.align-center();
    gap: common.get-var(space, md);
  }

  .spinner {
    color: common.get-var(brand, 600);

    &.sm {
      height: 48px;
      width: 60px;
    }

    &.md {
      height: 72px;
      width: 90px;
    }

    &.lg {
      height: 96px;
      width: 120px;
    }

    .svg {
      height: 100%;
      width: 100%;
      overflow: visible;

      // Durée totale de l'animation
      $total-duration: 4s;

      // Murs extérieurs - se dessinent en premier
      .walls-outer .wall {
        stroke-dasharray: 100;
        stroke-dashoffset: 100;
        animation: draw-wall $total-duration ease-in-out infinite;
      }

      .wall-1 {
        animation-delay: 0s !important;
      }
      .wall-2 {
        animation-delay: 0.15s !important;
      }
      .wall-3 {
        animation-delay: 0.3s !important;
      }
      .wall-4 {
        animation-delay: 0.45s !important;
      }

      // Murs intérieurs - après les murs extérieurs
      .walls-inner .wall {
        stroke-dasharray: 50;
        stroke-dashoffset: 50;
        animation: draw-wall-inner $total-duration ease-in-out infinite;
      }

      .wall-5 {
        animation-delay: 0.6s !important;
      }
      .wall-6 {
        animation-delay: 0.7s !important;
      }
      .wall-7 {
        animation-delay: 0.8s !important;
      }
      .wall-8 {
        animation-delay: 0.9s !important;
      }

      // Portes
      .doors .door {
        stroke-dasharray: 30;
        stroke-dashoffset: 30;
        animation: draw-door $total-duration ease-out infinite;
        animation-delay: 1s;
      }

      // Meubles - apparaissent après les murs
      .furniture .furniture-item {
        opacity: 0;
        animation: fade-in-furniture $total-duration ease-out infinite;
      }

      // Délais progressifs pour les meubles
      .item-1 {
        animation-delay: 1.2s !important;
      }
      .item-2 {
        animation-delay: 1.35s !important;
      }
      .item-3 {
        animation-delay: 1.5s !important;
      }
      .item-4 {
        animation-delay: 1.65s !important;
      }
      .item-5 {
        animation-delay: 1.8s !important;
      }
      .item-6 {
        animation-delay: 1.95s !important;
      }
      .item-7 {
        animation-delay: 2.1s !important;
      }
      .item-8 {
        animation-delay: 2.25s !important;
      }
      .item-9 {
        animation-delay: 2.4s !important;
      }
      .item-10 {
        animation-delay: 2.55s !important;
      }
      .item-11 {
        animation-delay: 2.7s !important;
      }
      .item-12 {
        animation-delay: 2.85s !important;
      }

      // Fenêtres
      .windows .window {
        stroke-dasharray: 20;
        stroke-dashoffset: 20;
        animation: draw-window $total-duration ease-out infinite;
        animation-delay: 1.1s;
      }
    }
  }

  .text {
    font-size: common.get-var(font, body, md, default, size);
    color: common.get-var(text, secondary);
    animation: pulse 2s ease-in-out infinite;
    margin: 0;
    text-align: center;
  }

  // Animation des murs extérieurs
  @keyframes draw-wall {
    0%,
    5% {
      stroke-dashoffset: 100;
    }
    20% {
      stroke-dashoffset: 0;
    }
    85% {
      stroke-dashoffset: 0;
    }
    100% {
      stroke-dashoffset: 100;
    }
  }

  // Animation des murs intérieurs
  @keyframes draw-wall-inner {
    0%,
    15% {
      stroke-dashoffset: 50;
    }
    35% {
      stroke-dashoffset: 0;
    }
    85% {
      stroke-dashoffset: 0;
    }
    100% {
      stroke-dashoffset: 50;
    }
  }

  // Animation des portes
  @keyframes draw-door {
    0%,
    25% {
      stroke-dashoffset: 30;
    }
    45% {
      stroke-dashoffset: 0;
    }
    85% {
      stroke-dashoffset: 0;
    }
    100% {
      stroke-dashoffset: 30;
    }
  }

  // Animation des fenêtres
  @keyframes draw-window {
    0%,
    25% {
      stroke-dashoffset: 20;
    }
    45% {
      stroke-dashoffset: 0;
    }
    85% {
      stroke-dashoffset: 0;
    }
    100% {
      stroke-dashoffset: 20;
    }
  }

  // Animation d'apparition des meubles
  @keyframes fade-in-furniture {
    0%,
    30% {
      opacity: 0;
      transform: scale(0.8);
    }
    50% {
      opacity: var(--target-opacity, 0.3);
      transform: scale(1);
    }
    85% {
      opacity: var(--target-opacity, 0.3);
      transform: scale(1);
    }
    100% {
      opacity: 0;
      transform: scale(0.8);
    }
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.6;
    }
  }
}
