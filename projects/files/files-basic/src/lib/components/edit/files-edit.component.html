<div class="edit" #containerRef>
  <div #tuiRef [style.height]="this.getHeight()" [style.width]="this.getWidth()" class="m-a image-container"></div>

  <ta-loader [isLoading]="this.requestState.isLoading()">
    <div class="control">
      <div class="panel" *ngIf="this.showPanel()">
        <ng-container *ngIf="this.selection === 'line'">
          <ng-template [ngTemplateOutlet]="Range"></ng-template>
          <ng-template [ngTemplateOutlet]="Colors"></ng-template>
        </ng-container>
        <ng-container *ngIf="this.selection === 'shape'">
          <div class="row g-0 shape-selection">
            <div class="col" (click)="this.changeShapeSelection('rect')">
              <div class="item" [ngClass]="{ selected: this.shapeSelection === 'rect' }">
                <ta-material-icon type="sm">check_box_outline_blank</ta-material-icon>
              </div>
            </div>
            <div class="col" (click)="this.changeShapeSelection('triangle')">
              <div class="item" [ngClass]="{ selected: this.shapeSelection === 'triangle' }">
                <ta-material-icon type="sm">change_history</ta-material-icon>
              </div>
            </div>
            <div class="col" (click)="this.changeShapeSelection('circle')">
              <div class="item" [ngClass]="{ selected: this.shapeSelection === 'circle' }">
                <ta-material-icon type="sm">circle</ta-material-icon>
              </div>
            </div>
            <div class="col" (click)="this.changeShapeSelection('line')">
              <div class="item" [ngClass]="{ selected: this.shapeSelection === 'line' }">
                <ta-material-icon type="sm">straighten</ta-material-icon>
              </div>
            </div>
          </div>
          <ng-template [ngTemplateOutlet]="Range"></ng-template>
          <ng-template [ngTemplateOutlet]="Colors"></ng-template>
        </ng-container>
        <ng-container *ngIf="this.selection === 'text'">
          <ng-template [ngTemplateOutlet]="Range"></ng-template>
          <ng-template [ngTemplateOutlet]="Colors"></ng-template>
        </ng-container>
      </div>

      <div class="selection row g-0">
        <div class="col" (click)="this.changeSelection('')">
          <div class="item" [ngClass]="{ selected: this.selection === '' }">
            <ta-material-icon type="sm">pan_tool</ta-material-icon>
          </div>
        </div>
        <div class="col" (click)="this.changeSelection('line')">
          <div class="item" [ngClass]="{ selected: this.selection === 'line' }">
            <ta-material-icon type="sm">draw</ta-material-icon>
          </div>
        </div>
        <div class="col" (click)="this.changeSelection('shape')">
          <div class="item" [ngClass]="{ selected: this.selection === 'shape' }">
            <ta-material-icon type="sm">interests</ta-material-icon>
          </div>
        </div>
        <div class="col" (click)="this.changeSelection('text')">
          <div class="item" [ngClass]="{ selected: this.selection === 'text' }">
            <ta-material-icon type="sm">text_fields</ta-material-icon>
          </div>
        </div>
        <div class="col" (click)="this.clear()">
          <div class="item" [ngClass]="{ disabled: !this.objectActivated }">
            <ta-material-icon type="sm">delete</ta-material-icon>
          </div>
        </div>
        <span class="separator"></span>
        <div class="col" (click)="this.undo()">
          <div class="item">
            <ta-material-icon type="sm">undo</ta-material-icon>
          </div>
        </div>
        <div class="col" (click)="this.redo()">
          <div class="item">
            <ta-material-icon type="sm">redo</ta-material-icon>
          </div>
        </div>
        <span class="separator"></span>
        <div class="col" (click)="this.validation()">
          <div class="item color-success">
            <ta-font-icon name="check-line"></ta-font-icon>
          </div>
        </div>
      </div>
    </div>
  </ta-loader>
</div>

<ng-template #Colors>
  <div class="colors">
    <div class="row g-0">
      <div class="col" *ngFor="let color of this.colorList" (click)="this.changeColor(color)">
        <div class="color" [style.background-color]="color" [ngClass]="{ 'is-light': this.isLight(color) }">
          <ta-material-icon [type]="'sm'" *ngIf="this.colorHexa === color">done</ta-material-icon>
        </div>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #Range>
  <div class="range">
    <!-- <ta-input-slider [input]="this.slider"></ta-input-slider> -->
  </div>
</ng-template>
